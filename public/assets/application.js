var Prototype={Version:"1.6.1",Browser:function(){var a=navigator.userAgent,b=Object.prototype.toString.call(window.opera)=="[object Opera]";return{IE:!!window.attachEvent&&!b,Opera:b,WebKit:a.indexOf("AppleWebKit/")>-1,Gecko:a.indexOf("Gecko")>-1&&a.indexOf("KHTML")===-1,MobileSafari:/Apple.*Mobile.*Safari/.test(a)}}(),BrowserFeatures:{XPath:!!document.evaluate,SelectorsAPI:!!document.querySelector,ElementExtensions:function(){var a=window.Element||window.HTMLElement;return!!(a&&a.prototype)}(),
SpecificElementExtensions:function(){if(typeof window.HTMLDivElement!=="undefined")return true;var a=document.createElement("div"),b=document.createElement("form"),c=false;if(a.__proto__&&a.__proto__!==b.__proto__)c=true;return c}()},ScriptFragment:"<script[^>]*>([\\S\\s]*?)<\/script>",JSONFilter:/^\/\*-secure-([\s\S]*)\*\/\s*$/,emptyFunction:function(){},K:function(a){return a}};if(Prototype.Browser.MobileSafari)Prototype.BrowserFeatures.SpecificElementExtensions=false;
var Abstract={},Try={these:function(){for(var a,b=0,c=arguments.length;b<c;b++){var d=arguments[b];try{a=d();break}catch(e){}}return a}},Class=function(){function a(){}return{create:function(){function b(){this.initialize.apply(this,arguments)}var c=null,d=$A(arguments);if(Object.isFunction(d[0]))c=d.shift();Object.extend(b,Class.Methods);b.superclass=c;b.subclasses=[];if(c){a.prototype=c.prototype;b.prototype=new a;c.subclasses.push(b)}for(c=0;c<d.length;c++)b.addMethods(d[c]);if(!b.prototype.initialize)b.prototype.initialize=
Prototype.emptyFunction;return b.prototype.constructor=b},Methods:{addMethods:function(b){var c=this.superclass&&this.superclass.prototype,d=Object.keys(b);if(!Object.keys({toString:true}).length){b.toString!=Object.prototype.toString&&d.push("toString");b.valueOf!=Object.prototype.valueOf&&d.push("valueOf")}for(var e=0,f=d.length;e<f;e++){var g=d[e],h=b[g];if(c&&Object.isFunction(h)&&h.argumentNames().first()=="$super"){var i=h;h=function(j){return function(){return c[j].apply(this,arguments)}}(g).wrap(i);
h.valueOf=i.valueOf.bind(i);h.toString=i.toString.bind(i)}this.prototype[g]=h}return this}}}}();
(function(){function a(f,g){for(var h in g)f[h]=g[h];return f}function b(f){switch(typeof f){case "undefined":case "function":case "unknown":return;case "boolean":return f.toString()}if(f===null)return"null";if(f.toJSON)return f.toJSON();if(!c(f)){var g=[],h;for(h in f){var i=b(f[h]);d(i)||g.push(h.toJSON()+": "+i)}return"{"+g.join(", ")+"}"}}function c(f){return!!(f&&f.nodeType==1)}function d(f){return typeof f==="undefined"}var e=Object.prototype.toString;a(Object,{extend:a,inspect:function(f){try{if(d(f))return"undefined";
if(f===null)return"null";return f.inspect?f.inspect():String(f)}catch(g){if(g instanceof RangeError)return"...";throw g;}},toJSON:b,toQueryString:function(f){return $H(f).toQueryString()},toHTML:function(f){return f&&f.toHTML?f.toHTML():String.interpret(f)},keys:function(f){var g=[],h;for(h in f)g.push(h);return g},values:function(f){var g=[],h;for(h in f)g.push(f[h]);return g},clone:function(f){return a({},f)},isElement:c,isArray:function(f){return e.call(f)=="[object Array]"},isHash:function(f){return f instanceof
Hash},isFunction:function(f){return typeof f==="function"},isString:function(f){return e.call(f)=="[object String]"},isNumber:function(f){return e.call(f)=="[object Number]"},isUndefined:d})})();
Object.extend(Function.prototype,function(){function a(d,e){for(var f=d.length,g=e.length;g--;)d[f+g]=e[g];return d}function b(d,e){d=c.call(d,0);return a(d,e)}var c=Array.prototype.slice;return{argumentNames:function(){var d=this.toString().match(/^[\s\(]*function[^(]*\(([^)]*)\)/)[1].replace(/\/\/.*?[\r\n]|\/\*(?:.|[\r\n])*?\*\//g,"").replace(/\s+/g,"").split(",");return d.length==1&&!d[0]?[]:d},bind:function(d){if(arguments.length<2&&Object.isUndefined(arguments[0]))return this;var e=this,f=c.call(arguments,
1);return function(){var g=b(f,arguments);return e.apply(d,g)}},bindAsEventListener:function(d){var e=this,f=c.call(arguments,1);return function(g){g=a([g||window.event],f);return e.apply(d,g)}},curry:function(){if(!arguments.length)return this;var d=this,e=c.call(arguments,0);return function(){var f=b(e,arguments);return d.apply(this,f)}},delay:function(d){var e=this,f=c.call(arguments,1);d*=1E3;return window.setTimeout(function(){return e.apply(e,f)},d)},defer:function(){return this.delay.apply(this,
a([0.01],arguments))},wrap:function(d){var e=this;return function(){var f=a([e.bind(this)],arguments);return d.apply(this,f)}},methodize:function(){if(this._methodized)return this._methodized;var d=this;return this._methodized=function(){var e=a([this],arguments);return d.apply(null,e)}}}}());
Date.prototype.toJSON=function(){return'"'+this.getUTCFullYear()+"-"+(this.getUTCMonth()+1).toPaddedString(2)+"-"+this.getUTCDate().toPaddedString(2)+"T"+this.getUTCHours().toPaddedString(2)+":"+this.getUTCMinutes().toPaddedString(2)+":"+this.getUTCSeconds().toPaddedString(2)+'Z"'};RegExp.prototype.match=RegExp.prototype.test;RegExp.escape=function(a){return String(a).replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")};
var PeriodicalExecuter=Class.create({initialize:function(a,b){this.callback=a;this.frequency=b;this.currentlyExecuting=false;this.registerCallback()},registerCallback:function(){this.timer=setInterval(this.onTimerEvent.bind(this),this.frequency*1E3)},execute:function(){this.callback(this)},stop:function(){if(this.timer){clearInterval(this.timer);this.timer=null}},onTimerEvent:function(){if(!this.currentlyExecuting)try{this.currentlyExecuting=true;this.execute();this.currentlyExecuting=false}catch(a){this.currentlyExecuting=
false;throw a;}}});Object.extend(String,{interpret:function(a){return a==null?"":String(a)},specialChar:{"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r","\\":"\\\\"}});
Object.extend(String.prototype,function(){function a(d){if(Object.isFunction(d))return d;var e=new Template(d);return function(f){return e.evaluate(f)}}function b(){return this.replace(/^\s+/,"").replace(/\s+$/,"")}function c(d){var e=this.strip().match(/([^?#]*)(#.*)?$/);if(!e)return{};return e[1].split(d||"&").inject({},function(f,g){if((g=g.split("="))[0]){var h=decodeURIComponent(g.shift()),i=g.length>1?g.join("="):g[0];if(i!=undefined)i=decodeURIComponent(i);if(h in f){Object.isArray(f[h])||
(f[h]=[f[h]]);f[h].push(i)}else f[h]=i}return f})}return{gsub:function(d,e){var f="",g=this,h;e=a(e);if(Object.isString(d))d=RegExp.escape(d);if(!(d.length||d.source)){e=e("");return e+g.split("").join(e)+e}for(;g.length>0;)if(h=g.match(d)){f+=g.slice(0,h.index);f+=String.interpret(e(h));g=g.slice(h.index+h[0].length)}else{f+=g;g=""}return f},sub:function(d,e,f){e=a(e);f=Object.isUndefined(f)?1:f;return this.gsub(d,function(g){if(--f<0)return g[0];return e(g)})},scan:function(d,e){this.gsub(d,e);
return String(this)},truncate:function(d,e){d=d||30;e=Object.isUndefined(e)?"...":e;return this.length>d?this.slice(0,d-e.length)+e:String(this)},strip:String.prototype.trim?String.prototype.trim:b,stripTags:function(){return this.replace(/<\w+(\s+("[^"]*"|'[^']*'|[^>])+)?>|<\/\w+>/gi,"")},stripScripts:function(){return this.replace(RegExp(Prototype.ScriptFragment,"img"),"")},extractScripts:function(){var d=RegExp(Prototype.ScriptFragment,"im");return(this.match(RegExp(Prototype.ScriptFragment,"img"))||
[]).map(function(e){return(e.match(d)||["",""])[1]})},evalScripts:function(){return this.extractScripts().map(function(d){return eval(d)})},escapeHTML:function(){return this.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},unescapeHTML:function(){return this.stripTags().replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")},toQueryParams:c,parseQuery:c,toArray:function(){return this.split("")},succ:function(){return this.slice(0,this.length-1)+String.fromCharCode(this.charCodeAt(this.length-
1)+1)},times:function(d){return d<1?"":Array(d+1).join(this)},camelize:function(){var d=this.split("-"),e=d.length;if(e==1)return d[0];for(var f=this.charAt(0)=="-"?d[0].charAt(0).toUpperCase()+d[0].substring(1):d[0],g=1;g<e;g++)f+=d[g].charAt(0).toUpperCase()+d[g].substring(1);return f},capitalize:function(){return this.charAt(0).toUpperCase()+this.substring(1).toLowerCase()},underscore:function(){return this.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,
"$1_$2").replace(/-/g,"_").toLowerCase()},dasherize:function(){return this.replace(/_/g,"-")},inspect:function(d){var e=this.replace(/[\x00-\x1f\\]/g,function(f){if(f in String.specialChar)return String.specialChar[f];return"\\u00"+f.charCodeAt().toPaddedString(2,16)});if(d)return'"'+e.replace(/"/g,'\\"')+'"';return"'"+e.replace(/'/g,"\\'")+"'"},toJSON:function(){return this.inspect(true)},unfilterJSON:function(d){return this.replace(d||Prototype.JSONFilter,"$1")},isJSON:function(){var d=this;if(d.blank())return false;
d=this.replace(/\\./g,"@").replace(/"[^"\\\n\r]*"/g,"");return/^[,:{}\[\]0-9.\-+Eaeflnr-u \n\r\t]*$/.test(d)},evalJSON:function(d){var e=this.unfilterJSON();try{if(!d||e.isJSON())return eval("("+e+")")}catch(f){}throw new SyntaxError("Badly formed JSON string: "+this.inspect());},include:function(d){return this.indexOf(d)>-1},startsWith:function(d){return this.indexOf(d)===0},endsWith:function(d){var e=this.length-d.length;return e>=0&&this.lastIndexOf(d)===e},empty:function(){return this==""},blank:function(){return/^\s*$/.test(this)},
interpolate:function(d,e){return(new Template(this,e)).evaluate(d)}}}());
var Template=Class.create({initialize:function(a,b){this.template=a.toString();this.pattern=b||Template.Pattern},evaluate:function(a){if(a&&Object.isFunction(a.toTemplateReplacements))a=a.toTemplateReplacements();return this.template.gsub(this.pattern,function(b){if(a==null)return b[1]+"";var c=b[1]||"";if(c=="\\")return b[2];var d=a,e=b[3],f=/^([^.[]+|\[((?:.*?[^\\])?)\])(\.|\[|$)/;b=f.exec(e);if(b==null)return c;for(;b!=null;){var g=b[1].startsWith("[")?b[2].replace(/\\\\]/g,"]"):b[1];d=d[g];if(null==
d||""==b[3])break;e=e.substring("["==b[3]?b[1].length:b[0].length);b=f.exec(e)}return c+String.interpret(d)})}});Template.Pattern=/(^|.|\r|\n)(#\{(.*?)\})/;
var $break={},Enumerable=function(){function a(h,i){h=h||Prototype.K;var j=true;this.each(function(m,r){j=j&&!!h.call(i,m,r);if(!j)throw $break;});return j}function b(h,i){h=h||Prototype.K;var j=false;this.each(function(m,r){if(j=!!h.call(i,m,r))throw $break;});return j}function c(h,i){h=h||Prototype.K;var j=[];this.each(function(m,r){j.push(h.call(i,m,r))});return j}function d(h,i){var j;this.each(function(m,r){if(h.call(i,m,r)){j=m;throw $break;}});return j}function e(h,i){var j=[];this.each(function(m,
r){h.call(i,m,r)&&j.push(m)});return j}function f(h){if(Object.isFunction(this.indexOf))if(this.indexOf(h)!=-1)return true;var i=false;this.each(function(j){if(j==h){i=true;throw $break;}});return i}function g(){return this.map()}return{each:function(h,i){var j=0;try{this._each(function(r){h.call(i,r,j++)})}catch(m){if(m!=$break)throw m;}return this},eachSlice:function(h,i,j){var m=-h,r=[],s=this.toArray();if(h<1)return s;for(;(m+=h)<s.length;)r.push(s.slice(m,m+h));return r.collect(i,j)},all:a,every:a,
any:b,some:b,collect:c,map:c,detect:d,findAll:e,select:e,filter:e,grep:function(h,i,j){i=i||Prototype.K;var m=[];if(Object.isString(h))h=RegExp(RegExp.escape(h));this.each(function(r,s){h.match(r)&&m.push(i.call(j,r,s))});return m},include:f,member:f,inGroupsOf:function(h,i){i=Object.isUndefined(i)?null:i;return this.eachSlice(h,function(j){for(;j.length<h;)j.push(i);return j})},inject:function(h,i,j){this.each(function(m,r){h=i.call(j,h,m,r)});return h},invoke:function(h){var i=$A(arguments).slice(1);
return this.map(function(j){return j[h].apply(j,i)})},max:function(h,i){h=h||Prototype.K;var j;this.each(function(m,r){m=h.call(i,m,r);if(j==null||m>=j)j=m});return j},min:function(h,i){h=h||Prototype.K;var j;this.each(function(m,r){m=h.call(i,m,r);if(j==null||m<j)j=m});return j},partition:function(h,i){h=h||Prototype.K;var j=[],m=[];this.each(function(r,s){(h.call(i,r,s)?j:m).push(r)});return[j,m]},pluck:function(h){var i=[];this.each(function(j){i.push(j[h])});return i},reject:function(h,i){var j=
[];this.each(function(m,r){h.call(i,m,r)||j.push(m)});return j},sortBy:function(h,i){return this.map(function(j,m){return{value:j,criteria:h.call(i,j,m)}}).sort(function(j,m){var r=j.criteria,s=m.criteria;return r<s?-1:r>s?1:0}).pluck("value")},toArray:g,entries:g,zip:function(){var h=Prototype.K,i=$A(arguments);if(Object.isFunction(i.last()))h=i.pop();var j=[this].concat(i).map($A);return this.map(function(m,r){return h(j.pluck(r))})},size:function(){return this.toArray().length},inspect:function(){return"#<Enumerable:"+
this.toArray().inspect()+">"},find:d}}();function $A(a){if(!a)return[];if("toArray"in Object(a))return a.toArray();for(var b=a.length||0,c=Array(b);b--;)c[b]=a[b];return c}function $w(a){if(!Object.isString(a))return[];return(a=a.strip())?a.split(/\s+/):[]}Array.from=$A;
(function(){function a(i){for(var j=0,m=this.length;j<m;j++)i(this[j])}function b(){return g.call(this,0)}function c(i,j){j||(j=0);var m=this.length;if(j<0)j=m+j;for(;j<m;j++)if(this[j]===i)return j;return-1}function d(i,j){j=isNaN(j)?this.length:(j<0?this.length+j:j)+1;var m=this.slice(0,j).reverse().indexOf(i);return m<0?m:j-m-1}function e(){for(var i=g.call(this,0),j,m=0,r=arguments.length;m<r;m++){j=arguments[m];if(Object.isArray(j)&&!("callee"in j))for(var s=0,n=j.length;s<n;s++)i.push(j[s]);
else i.push(j)}return i}var f=Array.prototype,g=f.slice,h=f.forEach;h||(h=a);Object.extend(f,Enumerable);if(!f._reverse)f._reverse=f.reverse;Object.extend(f,{_each:h,clear:function(){this.length=0;return this},first:function(){return this[0]},last:function(){return this[this.length-1]},compact:function(){return this.select(function(i){return i!=null})},flatten:function(){return this.inject([],function(i,j){if(Object.isArray(j))return i.concat(j.flatten());i.push(j);return i})},without:function(){var i=
g.call(arguments,0);return this.select(function(j){return!i.include(j)})},reverse:function(i){return(i!==false?this:this.toArray())._reverse()},uniq:function(i){return this.inject([],function(j,m,r){if(0==r||(i?j.last()!=m:!j.include(m)))j.push(m);return j})},intersect:function(i){return this.uniq().findAll(function(j){return i.detect(function(m){return j===m})})},clone:b,toArray:b,size:function(){return this.length},inspect:function(){return"["+this.map(Object.inspect).join(", ")+"]"},toJSON:function(){var i=
[];this.each(function(j){j=Object.toJSON(j);Object.isUndefined(j)||i.push(j)});return"["+i.join(", ")+"]"}});if(function(){return[].concat(arguments)[0][0]!==1}(1,2))f.concat=e;if(!f.indexOf)f.indexOf=c;if(!f.lastIndexOf)f.lastIndexOf=d})();function $H(a){return new Hash(a)}
var Hash=Class.create(Enumerable,function(){function a(){return Object.clone(this._object)}function b(c,d){if(Object.isUndefined(d))return c;return c+"="+encodeURIComponent(String.interpret(d))}return{initialize:function(c){this._object=Object.isHash(c)?c.toObject():Object.clone(c)},_each:function(c){for(var d in this._object){var e=this._object[d],f=[d,e];f.key=d;f.value=e;c(f)}},set:function(c,d){return this._object[c]=d},get:function(c){if(this._object[c]!==Object.prototype[c])return this._object[c]},
unset:function(c){var d=this._object[c];delete this._object[c];return d},toObject:a,toTemplateReplacements:a,keys:function(){return this.pluck("key")},values:function(){return this.pluck("value")},index:function(c){var d=this.detect(function(e){return e.value===c});return d&&d.key},merge:function(c){return this.clone().update(c)},update:function(c){return(new Hash(c)).inject(this,function(d,e){d.set(e.key,e.value);return d})},toQueryString:function(){return this.inject([],function(c,d){var e=encodeURIComponent(d.key),
f=d.value;if(f&&typeof f=="object"){if(Object.isArray(f))return c.concat(f.map(b.curry(e)))}else c.push(b(e,f));return c}).join("&")},inspect:function(){return"#<Hash:{"+this.map(function(c){return c.map(Object.inspect).join(": ")}).join(", ")+"}>"},toJSON:function(){return Object.toJSON(this.toObject())},clone:function(){return new Hash(this)}}}());Hash.from=$H;
Object.extend(Number.prototype,function(){return{toColorPart:function(){return this.toPaddedString(2,16)},succ:function(){return this+1},times:function(a,b){$R(0,this,true).each(a,b);return this},toPaddedString:function(a,b){var c=this.toString(b||10);return"0".times(a-c.length)+c},toJSON:function(){return isFinite(this)?this.toString():"null"},abs:function(){return Math.abs(this)},round:function(){return Math.round(this)},ceil:function(){return Math.ceil(this)},floor:function(){return Math.floor(this)}}}());
function $R(a,b,c){return new ObjectRange(a,b,c)}
var ObjectRange=Class.create(Enumerable,function(){return{initialize:function(a,b,c){this.start=a;this.end=b;this.exclusive=c},_each:function(a){for(var b=this.start;this.include(b);){a(b);b=b.succ()}},include:function(a){if(a<this.start)return false;if(this.exclusive)return a<this.end;return a<=this.end}}}()),Ajax={getTransport:function(){return Try.these(function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")})||
false},activeRequestCount:0};Ajax.Responders={responders:[],_each:function(a){this.responders._each(a)},register:function(a){this.include(a)||this.responders.push(a)},unregister:function(a){this.responders=this.responders.without(a)},dispatch:function(a,b,c,d){this.each(function(e){if(Object.isFunction(e[a]))try{e[a].apply(e,[b,c,d])}catch(f){}})}};Object.extend(Ajax.Responders,Enumerable);Ajax.Responders.register({onCreate:function(){Ajax.activeRequestCount++},onComplete:function(){Ajax.activeRequestCount--}});
Ajax.Base=Class.create({initialize:function(a){this.options={method:"post",asynchronous:true,contentType:"application/x-www-form-urlencoded",encoding:"UTF-8",parameters:"",evalJSON:true,evalJS:true};Object.extend(this.options,a||{});this.options.method=this.options.method.toLowerCase();if(Object.isString(this.options.parameters))this.options.parameters=this.options.parameters.toQueryParams();else if(Object.isHash(this.options.parameters))this.options.parameters=this.options.parameters.toObject()}});
Ajax.Request=Class.create(Ajax.Base,{_complete:false,initialize:function($super,b,c){$super(c);this.transport=Ajax.getTransport();this.request(b)},request:function(a){this.url=a;this.method=this.options.method;a=Object.clone(this.options.parameters);if(!["get","post"].include(this.method)){a._method=this.method;this.method="post"}this.parameters=a;if(a=Object.toQueryString(a))if(this.method=="get")this.url+=(this.url.include("?")?"&":"?")+a;else if(/Konqueror|Safari|KHTML/.test(navigator.userAgent))a+=
"&_=";try{var b=new Ajax.Response(this);this.options.onCreate&&this.options.onCreate(b);Ajax.Responders.dispatch("onCreate",this,b);this.transport.open(this.method.toUpperCase(),this.url,this.options.asynchronous);this.options.asynchronous&&this.respondToReadyState.bind(this).defer(1);this.transport.onreadystatechange=this.onStateChange.bind(this);this.setRequestHeaders();this.body=this.method=="post"?this.options.postBody||a:null;this.transport.send(this.body);!this.options.asynchronous&&this.transport.overrideMimeType&&
this.onStateChange()}catch(c){this.dispatchException(c)}},onStateChange:function(){var a=this.transport.readyState;a>1&&!(a==4&&this._complete)&&this.respondToReadyState(this.transport.readyState)},setRequestHeaders:function(){var a={"X-Requested-With":"XMLHttpRequest","X-Prototype-Version":Prototype.Version,Accept:"text/javascript, text/html, application/xml, text/xml, */*"};if(this.method=="post"){a["Content-type"]=this.options.contentType+(this.options.encoding?"; charset="+this.options.encoding:
"");if(this.transport.overrideMimeType&&(navigator.userAgent.match(/Gecko\/(\d{4})/)||[0,2005])[1]<2005)a.Connection="close"}if(typeof this.options.requestHeaders=="object"){var b=this.options.requestHeaders;if(Object.isFunction(b.push))for(var c=0,d=b.length;c<d;c+=2)a[b[c]]=b[c+1];else $H(b).each(function(f){a[f.key]=f.value})}for(var e in a)this.transport.setRequestHeader(e,a[e])},success:function(){var a=this.getStatus();return!a||a>=200&&a<300},getStatus:function(){try{return this.transport.status||
0}catch(a){return 0}},respondToReadyState:function(a){a=Ajax.Request.Events[a];var b=new Ajax.Response(this);if(a=="Complete"){try{this._complete=true;(this.options["on"+b.status]||this.options["on"+(this.success()?"Success":"Failure")]||Prototype.emptyFunction)(b,b.headerJSON)}catch(c){this.dispatchException(c)}var d=b.getHeader("Content-type");if(this.options.evalJS=="force"||this.options.evalJS&&this.isSameOrigin()&&d&&d.match(/^\s*(text|application)\/(x-)?(java|ecma)script(;.*)?\s*$/i))this.evalResponse()}try{(this.options["on"+
a]||Prototype.emptyFunction)(b,b.headerJSON);Ajax.Responders.dispatch("on"+a,this,b,b.headerJSON)}catch(e){this.dispatchException(e)}if(a=="Complete")this.transport.onreadystatechange=Prototype.emptyFunction},isSameOrigin:function(){var a=this.url.match(/^\s*https?:\/\/[^\/]*/);return!a||a[0]=="#{protocol}//#{domain}#{port}".interpolate({protocol:location.protocol,domain:document.domain,port:location.port?":"+location.port:""})},getHeader:function(a){try{return this.transport.getResponseHeader(a)||
null}catch(b){return null}},evalResponse:function(){try{return eval((this.transport.responseText||"").unfilterJSON())}catch(a){this.dispatchException(a)}},dispatchException:function(a){(this.options.onException||Prototype.emptyFunction)(this,a);Ajax.Responders.dispatch("onException",this,a)}});Ajax.Request.Events=["Uninitialized","Loading","Loaded","Interactive","Complete"];
Ajax.Response=Class.create({initialize:function(a){this.request=a;a=this.transport=a.transport;var b=this.readyState=a.readyState;if(b>2&&!Prototype.Browser.IE||b==4){this.status=this.getStatus();this.statusText=this.getStatusText();this.responseText=String.interpret(a.responseText);this.headerJSON=this._getHeaderJSON()}if(b==4){a=a.responseXML;this.responseXML=Object.isUndefined(a)?null:a;this.responseJSON=this._getResponseJSON()}},status:0,statusText:"",getStatus:Ajax.Request.prototype.getStatus,
getStatusText:function(){try{return this.transport.statusText||""}catch(a){return""}},getHeader:Ajax.Request.prototype.getHeader,getAllHeaders:function(){try{return this.getAllResponseHeaders()}catch(a){return null}},getResponseHeader:function(a){return this.transport.getResponseHeader(a)},getAllResponseHeaders:function(){return this.transport.getAllResponseHeaders()},_getHeaderJSON:function(){var a=this.getHeader("X-JSON");if(!a)return null;a=decodeURIComponent(escape(a));try{return a.evalJSON(this.request.options.sanitizeJSON||
!this.request.isSameOrigin())}catch(b){this.request.dispatchException(b)}},_getResponseJSON:function(){var a=this.request.options;if(!a.evalJSON||a.evalJSON!="force"&&!(this.getHeader("Content-type")||"").include("application/json")||this.responseText.blank())return null;try{return this.responseText.evalJSON(a.sanitizeJSON||!this.request.isSameOrigin())}catch(b){this.request.dispatchException(b)}}});
Ajax.Updater=Class.create(Ajax.Request,{initialize:function($super,b,c,d){this.container={success:b.success||b,failure:b.failure||(b.success?null:b)};d=Object.clone(d);var e=d.onComplete;d.onComplete=function(f,g){this.updateContent(f.responseText);Object.isFunction(e)&&e(f,g)}.bind(this);$super(c,d)},updateContent:function(a){var b=this.container[this.success()?"success":"failure"],c=this.options;c.evalScripts||(a=a.stripScripts());if(b=$(b))if(c.insertion)if(Object.isString(c.insertion)){var d=
{};d[c.insertion]=a;b.insert(d)}else c.insertion(b,a);else b.update(a)}});
Ajax.PeriodicalUpdater=Class.create(Ajax.Base,{initialize:function($super,b,c,d){$super(d);this.onComplete=this.options.onComplete;this.frequency=this.options.frequency||2;this.decay=this.options.decay||1;this.updater={};this.container=b;this.url=c;this.start()},start:function(){this.options.onComplete=this.updateComplete.bind(this);this.onTimerEvent()},stop:function(){this.updater.options.onComplete=undefined;clearTimeout(this.timer);(this.onComplete||Prototype.emptyFunction).apply(this,arguments)},
updateComplete:function(a){if(this.options.decay){this.decay=a.responseText==this.lastText?this.decay*this.options.decay:1;this.lastText=a.responseText}this.timer=this.onTimerEvent.bind(this).delay(this.decay*this.frequency)},onTimerEvent:function(){this.updater=new Ajax.Updater(this.container,this.url,this.options)}});
function $(a){if(arguments.length>1){for(var b=0,c=[],d=arguments.length;b<d;b++)c.push($(arguments[b]));return c}if(Object.isString(a))a=document.getElementById(a);return Element.extend(a)}if(Prototype.BrowserFeatures.XPath)document._getElementsByXPath=function(a,b){for(var c=[],d=document.evaluate(a,$(b)||document,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null),e=0,f=d.snapshotLength;e<f;e++)c.push(Element.extend(d.snapshotItem(e)));return c};window.Node||(Node={});
Node.ELEMENT_NODE||Object.extend(Node,{ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12});
(function(a){var b=function(){var d=document.createElement("form"),e=document.createElement("input"),f=document.documentElement;e.setAttribute("name","test");d.appendChild(e);f.appendChild(d);e=d.elements?typeof d.elements.test=="undefined":null;f.removeChild(d);return e}(),c=a.Element;a.Element=function(d,e){e=e||{};d=d.toLowerCase();var f=Element.cache;if(b&&e.name){d="<"+d+' name="'+e.name+'">';delete e.name;return Element.writeAttribute(document.createElement(d),e)}f[d]||(f[d]=Element.extend(document.createElement(d)));
return Element.writeAttribute(f[d].cloneNode(false),e)};Object.extend(a.Element,c||{});if(c)a.Element.prototype=c.prototype})(this);Element.cache={};Element.idCounter=1;
Element.Methods={visible:function(a){return $(a).style.display!="none"},toggle:function(a){a=$(a);Element[Element.visible(a)?"hide":"show"](a);return a},hide:function(a){a=$(a);a.style.display="none";return a},show:function(a){a=$(a);a.style.display="";return a},remove:function(a){a=$(a);a.parentNode.removeChild(a);return a},update:function(){var a=function(){var d=document.createElement("select"),e=true;d.innerHTML='<option value="test">test</option>';if(d.options&&d.options[0])e=d.options[0].nodeName.toUpperCase()!==
"OPTION";return e}(),b=function(){try{var d=document.createElement("table");if(d&&d.tBodies){d.innerHTML="<tbody><tr><td>test</td></tr></tbody>";return typeof d.tBodies[0]=="undefined"}}catch(e){return true}}(),c=function(){var d=document.createElement("script"),e=false;try{d.appendChild(document.createTextNode(""));e=!d.firstChild||d.firstChild&&d.firstChild.nodeType!==3}catch(f){e=true}return e}();return function(d,e){d=$(d);if(e&&e.toElement)e=e.toElement();if(Object.isElement(e))return d.update().insert(e);
e=Object.toHTML(e);var f=d.tagName.toUpperCase();if(f==="SCRIPT"&&c){d.text=e;return d}if(a||b)if(f in Element._insertionTranslations.tags){for(;d.firstChild;)d.removeChild(d.firstChild);Element._getContentFromAnonymousElement(f,e.stripScripts()).each(function(g){d.appendChild(g)})}else d.innerHTML=e.stripScripts();else d.innerHTML=e.stripScripts();e.evalScripts.bind(e).defer();return d}}(),replace:function(a,b){a=$(a);if(b&&b.toElement)b=b.toElement();else if(!Object.isElement(b)){b=Object.toHTML(b);
var c=a.ownerDocument.createRange();c.selectNode(a);b.evalScripts.bind(b).defer();b=c.createContextualFragment(b.stripScripts())}a.parentNode.replaceChild(b,a);return a},insert:function(a,b){a=$(a);if(Object.isString(b)||Object.isNumber(b)||Object.isElement(b)||b&&(b.toElement||b.toHTML))b={bottom:b};var c,d,e,f;for(f in b){c=b[f];f=f.toLowerCase();d=Element._insertionTranslations[f];if(c&&c.toElement)c=c.toElement();if(Object.isElement(c))d(a,c);else{c=Object.toHTML(c);e=(f=="before"||f=="after"?
a.parentNode:a).tagName.toUpperCase();e=Element._getContentFromAnonymousElement(e,c.stripScripts());if(f=="top"||f=="after")e.reverse();e.each(d.curry(a));c.evalScripts.bind(c).defer()}}return a},wrap:function(a,b,c){a=$(a);if(Object.isElement(b))$(b).writeAttribute(c||{});else b=Object.isString(b)?new Element(b,c):new Element("div",b);a.parentNode&&a.parentNode.replaceChild(b,a);b.appendChild(a);return b},inspect:function(a){a=$(a);var b="<"+a.tagName.toLowerCase();$H({id:"id",className:"class"}).each(function(c){var d=
c.first();c=c.last();if(d=(a[d]||"").toString())b+=" "+c+"="+d.inspect(true)});return b+">"},recursivelyCollect:function(a,b){a=$(a);for(var c=[];a=a[b];)a.nodeType==1&&c.push(Element.extend(a));return c},ancestors:function(a){return Element.recursivelyCollect(a,"parentNode")},descendants:function(a){return Element.select(a,"*")},firstDescendant:function(a){for(a=$(a).firstChild;a&&a.nodeType!=1;)a=a.nextSibling;return $(a)},immediateDescendants:function(a){if(!(a=$(a).firstChild))return[];for(;a&&
a.nodeType!=1;)a=a.nextSibling;if(a)return[a].concat($(a).nextSiblings());return[]},previousSiblings:function(a){return Element.recursivelyCollect(a,"previousSibling")},nextSiblings:function(a){return Element.recursivelyCollect(a,"nextSibling")},siblings:function(a){a=$(a);return Element.previousSiblings(a).reverse().concat(Element.nextSiblings(a))},match:function(a,b){if(Object.isString(b))b=new Selector(b);return b.match($(a))},up:function(a,b,c){a=$(a);if(arguments.length==1)return $(a.parentNode);
var d=Element.ancestors(a);return Object.isNumber(b)?d[b]:Selector.findElement(d,b,c)},down:function(a,b,c){a=$(a);if(arguments.length==1)return Element.firstDescendant(a);return Object.isNumber(b)?Element.descendants(a)[b]:Element.select(a,b)[c||0]},previous:function(a,b,c){a=$(a);if(arguments.length==1)return $(Selector.handlers.previousElementSibling(a));var d=Element.previousSiblings(a);return Object.isNumber(b)?d[b]:Selector.findElement(d,b,c)},next:function(a,b,c){a=$(a);if(arguments.length==
1)return $(Selector.handlers.nextElementSibling(a));var d=Element.nextSiblings(a);return Object.isNumber(b)?d[b]:Selector.findElement(d,b,c)},select:function(a){var b=Array.prototype.slice.call(arguments,1);return Selector.findChildElements(a,b)},adjacent:function(a){var b=Array.prototype.slice.call(arguments,1);return Selector.findChildElements(a.parentNode,b).without(a)},identify:function(a){a=$(a);var b=Element.readAttribute(a,"id");if(b)return b;do b="anonymous_element_"+Element.idCounter++;while($(b));
Element.writeAttribute(a,"id",b);return b},readAttribute:function(a,b){a=$(a);if(Prototype.Browser.IE){var c=Element._attributeTranslations.read;if(c.values[b])return c.values[b](a,b);if(c.names[b])b=c.names[b];if(b.include(":"))return!a.attributes||!a.attributes[b]?null:a.attributes[b].value}return a.getAttribute(b)},writeAttribute:function(a,b,c){a=$(a);var d={},e=Element._attributeTranslations.write;if(typeof b=="object")d=b;else d[b]=Object.isUndefined(c)?true:c;for(var f in d){b=e.names[f]||
f;c=d[f];if(e.values[f])b=e.values[f](a,c);if(c===false||c===null)a.removeAttribute(b);else c===true?a.setAttribute(b,b):a.setAttribute(b,c)}return a},getHeight:function(a){return Element.getDimensions(a).height},getWidth:function(a){return Element.getDimensions(a).width},classNames:function(a){return new Element.ClassNames(a)},hasClassName:function(a,b){if(a=$(a)){var c=a.className;return c.length>0&&(c==b||RegExp("(^|\\s)"+b+"(\\s|$)").test(c))}},addClassName:function(a,b){if(a=$(a)){Element.hasClassName(a,
b)||(a.className+=(a.className?" ":"")+b);return a}},removeClassName:function(a,b){if(a=$(a)){a.className=a.className.replace(RegExp("(^|\\s+)"+b+"(\\s+|$)")," ").strip();return a}},toggleClassName:function(a,b){if(a=$(a))return Element[Element.hasClassName(a,b)?"removeClassName":"addClassName"](a,b)},cleanWhitespace:function(a){a=$(a);for(var b=a.firstChild;b;){var c=b.nextSibling;b.nodeType==3&&!/\S/.test(b.nodeValue)&&a.removeChild(b);b=c}return a},empty:function(a){return $(a).innerHTML.blank()},
descendantOf:function(a,b){a=$(a);b=$(b);if(a.compareDocumentPosition)return(a.compareDocumentPosition(b)&8)===8;if(b.contains)return b.contains(a)&&b!==a;for(;a=a.parentNode;)if(a==b)return true;return false},scrollTo:function(a){a=$(a);var b=Element.cumulativeOffset(a);window.scrollTo(b[0],b[1]);return a},getStyle:function(a,b){a=$(a);b=b=="float"?"cssFloat":b.camelize();var c=a.style[b];if(!c||c=="auto")c=(c=document.defaultView.getComputedStyle(a,null))?c[b]:null;if(b=="opacity")return c?parseFloat(c):
1;return c=="auto"?null:c},getOpacity:function(a){return $(a).getStyle("opacity")},setStyle:function(a,b){a=$(a);var c=a.style;if(Object.isString(b)){a.style.cssText+=";"+b;return b.include("opacity")?a.setOpacity(b.match(/opacity:\s*(\d?\.?\d*)/)[1]):a}for(var d in b)if(d=="opacity")a.setOpacity(b[d]);else c[d=="float"||d=="cssFloat"?Object.isUndefined(c.styleFloat)?"cssFloat":"styleFloat":d]=b[d];return a},setOpacity:function(a,b){a=$(a);a.style.opacity=b==1||b===""?"":b<1.0E-5?0:b;return a},getDimensions:function(a){a=
$(a);var b=Element.getStyle(a,"display");if(b!="none"&&b!=null)return{width:a.offsetWidth,height:a.offsetHeight};b=a.style;var c=b.visibility,d=b.position,e=b.display;b.visibility="hidden";if(d!="fixed")b.position="absolute";b.display="block";var f=a.clientWidth;a=a.clientHeight;b.display=e;b.position=d;b.visibility=c;return{width:f,height:a}},makePositioned:function(a){a=$(a);var b=Element.getStyle(a,"position");if(b=="static"||!b){a._madePositioned=true;a.style.position="relative";if(Prototype.Browser.Opera){a.style.top=
0;a.style.left=0}}return a},undoPositioned:function(a){a=$(a);if(a._madePositioned){a._madePositioned=undefined;a.style.position=a.style.top=a.style.left=a.style.bottom=a.style.right=""}return a},makeClipping:function(a){a=$(a);if(a._overflow)return a;a._overflow=Element.getStyle(a,"overflow")||"auto";if(a._overflow!=="hidden")a.style.overflow="hidden";return a},undoClipping:function(a){a=$(a);if(!a._overflow)return a;a.style.overflow=a._overflow=="auto"?"":a._overflow;a._overflow=null;return a},
cumulativeOffset:function(a){var b=0,c=0;do{b+=a.offsetTop||0;c+=a.offsetLeft||0;a=a.offsetParent}while(a);return Element._returnOffset(c,b)},positionedOffset:function(a){var b=0,c=0;do{b+=a.offsetTop||0;c+=a.offsetLeft||0;if(a=a.offsetParent){if(a.tagName.toUpperCase()=="BODY")break;if(Element.getStyle(a,"position")!=="static")break}}while(a);return Element._returnOffset(c,b)},absolutize:function(a){a=$(a);if(Element.getStyle(a,"position")=="absolute")return a;var b=Element.positionedOffset(a),c=
b[1];b=b[0];var d=a.clientWidth,e=a.clientHeight;a._originalLeft=b-parseFloat(a.style.left||0);a._originalTop=c-parseFloat(a.style.top||0);a._originalWidth=a.style.width;a._originalHeight=a.style.height;a.style.position="absolute";a.style.top=c+"px";a.style.left=b+"px";a.style.width=d+"px";a.style.height=e+"px";return a},relativize:function(a){a=$(a);if(Element.getStyle(a,"position")=="relative")return a;a.style.position="relative";var b=parseFloat(a.style.top||0)-(a._originalTop||0),c=parseFloat(a.style.left||
0)-(a._originalLeft||0);a.style.top=b+"px";a.style.left=c+"px";a.style.height=a._originalHeight;a.style.width=a._originalWidth;return a},cumulativeScrollOffset:function(a){var b=0,c=0;do{b+=a.scrollTop||0;c+=a.scrollLeft||0;a=a.parentNode}while(a);return Element._returnOffset(c,b)},getOffsetParent:function(a){if(a.offsetParent)return $(a.offsetParent);if(a==document.body)return $(a);for(;(a=a.parentNode)&&a!=document.body;)if(Element.getStyle(a,"position")!="static")return $(a);return $(document.body)},
viewportOffset:function(a){var b=0,c=0,d=a;do{b+=d.offsetTop||0;c+=d.offsetLeft||0;if(d.offsetParent==document.body&&Element.getStyle(d,"position")=="absolute")break}while(d=d.offsetParent);d=a;do if(!Prototype.Browser.Opera||d.tagName&&d.tagName.toUpperCase()=="BODY"){b-=d.scrollTop||0;c-=d.scrollLeft||0}while(d=d.parentNode);return Element._returnOffset(c,b)},clonePosition:function(a,b,c){c=Object.extend({setLeft:true,setTop:true,setWidth:true,setHeight:true,offsetTop:0,offsetLeft:0},c||{});b=$(b);
var d=Element.viewportOffset(b);a=$(a);var e=[0,0],f=null;if(Element.getStyle(a,"position")=="absolute"){f=Element.getOffsetParent(a);e=Element.viewportOffset(f)}if(f==document.body){e[0]-=document.body.offsetLeft;e[1]-=document.body.offsetTop}if(c.setLeft)a.style.left=d[0]-e[0]+c.offsetLeft+"px";if(c.setTop)a.style.top=d[1]-e[1]+c.offsetTop+"px";if(c.setWidth)a.style.width=b.offsetWidth+"px";if(c.setHeight)a.style.height=b.offsetHeight+"px";return a}};
Object.extend(Element.Methods,{getElementsBySelector:Element.Methods.select,childElements:Element.Methods.immediateDescendants});Element._attributeTranslations={write:{names:{className:"class",htmlFor:"for"},values:{}}};
if(Prototype.Browser.Opera){Element.Methods.getStyle=Element.Methods.getStyle.wrap(function(a,b,c){switch(c){case "left":case "top":case "right":case "bottom":if(a(b,"position")==="static")return null;case "height":case "width":if(!Element.visible(b))return null;var d=parseInt(a(b,c),10);if(d!==b["offset"+c.capitalize()])return d+"px";return(c==="height"?["border-top-width","padding-top","padding-bottom","border-bottom-width"]:["border-left-width","padding-left","padding-right","border-right-width"]).inject(d,
function(e,f){var g=a(b,f);return g===null?e:e-parseInt(g,10)})+"px";default:return a(b,c)}});Element.Methods.readAttribute=Element.Methods.readAttribute.wrap(function(a,b,c){if(c==="title")return b.title;return a(b,c)})}else if(Prototype.Browser.IE){Element.Methods.getOffsetParent=Element.Methods.getOffsetParent.wrap(function(a,b){b=$(b);var c=b.getStyle("position");if(c!=="static")return a(b);b.setStyle({position:"relative"});var d=a(b);b.setStyle({position:c});return d});$w("positionedOffset viewportOffset").each(function(a){Element.Methods[a]=
Element.Methods[a].wrap(function(b,c){c=$(c);var d=c.getStyle("position");if(d!=="static")return b(c);var e=c.getOffsetParent();e&&e.getStyle("position")==="fixed"&&e.setStyle({zoom:1});c.setStyle({position:"relative"});e=b(c);c.setStyle({position:d});return e})});Element.Methods.cumulativeOffset=Element.Methods.cumulativeOffset.wrap(function(a,b){return a(b)});Element.Methods.getStyle=function(a,b){a=$(a);b=b=="float"||b=="cssFloat"?"styleFloat":b.camelize();var c=a.style[b];if(!c&&a.currentStyle)c=
a.currentStyle[b];if(b=="opacity"){if(c=(a.getStyle("filter")||"").match(/alpha\(opacity=(.*)\)/))if(c[1])return parseFloat(c[1])/100;return 1}if(c=="auto"){if((b=="width"||b=="height")&&a.getStyle("display")!="none")return a["offset"+b.capitalize()]+"px";return null}return c};Element.Methods.setOpacity=function(a,b){a=$(a);var c=a.currentStyle;if(c&&!c.hasLayout||!c&&a.style.zoom=="normal")a.style.zoom=1;c=a.getStyle("filter");var d=a.style;if(b==1||b===""){(c=c.replace(/alpha\([^\)]*\)/gi,""))?
d.filter=c:d.removeAttribute("filter");return a}else if(b<1.0E-5)b=0;d.filter=c.replace(/alpha\([^\)]*\)/gi,"")+"alpha(opacity="+b*100+")";return a};Element._attributeTranslations=function(){var a="className",b="for",c=document.createElement("div");c.setAttribute(a,"x");if(c.className!=="x"){c.setAttribute("class","x");if(c.className==="x")a="class"}c=null;c=document.createElement("label");c.setAttribute(b,"x");if(c.htmlFor!=="x"){c.setAttribute("htmlFor","x");if(c.htmlFor==="x")b="htmlFor"}c=null;
return{read:{names:{"class":a,className:a,"for":b,htmlFor:b},values:{_getAttr:function(d,e){return d.getAttribute(e)},_getAttr2:function(d,e){return d.getAttribute(e,2)},_getAttrNode:function(d,e){var f=d.getAttributeNode(e);return f?f.value:""},_getEv:function(){var d=document.createElement("div");d.onclick=Prototype.emptyFunction;d=d.getAttribute("onclick");var e;if(String(d).indexOf("{")>-1)e=function(f,g){g=f.getAttribute(g);if(!g)return null;g=g.toString();g=g.split("{")[1];g=g.split("}")[0];
return g.strip()};else if(d==="")e=function(f,g){g=f.getAttribute(g);if(!g)return null;return g.strip()};d=null;return e}(),_flag:function(d,e){return $(d).hasAttribute(e)?e:null},style:function(d){return d.style.cssText.toLowerCase()},title:function(d){return d.title}}}}}();Element._attributeTranslations.write={names:Object.extend({cellpadding:"cellPadding",cellspacing:"cellSpacing"},Element._attributeTranslations.read.names),values:{checked:function(a,b){a.checked=!!b},style:function(a,b){a.style.cssText=
b?b:""}}};Element._attributeTranslations.has={};$w("colSpan rowSpan vAlign dateTime accessKey tabIndex encType maxLength readOnly longDesc frameBorder").each(function(a){Element._attributeTranslations.write.names[a.toLowerCase()]=a;Element._attributeTranslations.has[a.toLowerCase()]=a});(function(a){Object.extend(a,{href:a._getAttr2,src:a._getAttr2,type:a._getAttr,action:a._getAttrNode,disabled:a._flag,checked:a._flag,readonly:a._flag,multiple:a._flag,onload:a._getEv,onunload:a._getEv,onclick:a._getEv,
ondblclick:a._getEv,onmousedown:a._getEv,onmouseup:a._getEv,onmouseover:a._getEv,onmousemove:a._getEv,onmouseout:a._getEv,onfocus:a._getEv,onblur:a._getEv,onkeypress:a._getEv,onkeydown:a._getEv,onkeyup:a._getEv,onsubmit:a._getEv,onreset:a._getEv,onselect:a._getEv,onchange:a._getEv})})(Element._attributeTranslations.read.values);Prototype.BrowserFeatures.ElementExtensions&&function(){Element.Methods.down=function(a,b,c){a=$(a);if(arguments.length==1)return a.firstDescendant();var d;if(Object.isNumber(b)){d=
a.getElementsByTagName("*");for(var e=[],f=0,g;g=d[f];f++)g.tagName!=="!"&&e.push(g);d=e[b]}else d=Element.select(a,b)[c||0];return d}}()}else if(Prototype.Browser.Gecko&&/rv:1\.8\.0/.test(navigator.userAgent))Element.Methods.setOpacity=function(a,b){a=$(a);a.style.opacity=b==1?0.999999:b===""?"":b<1.0E-5?0:b;return a};else if(Prototype.Browser.WebKit){Element.Methods.setOpacity=function(a,b){a=$(a);a.style.opacity=b==1||b===""?"":b<1.0E-5?0:b;if(b==1)if(a.tagName.toUpperCase()=="IMG"&&a.width){a.width++;
a.width--}else try{var c=document.createTextNode(" ");a.appendChild(c);a.removeChild(c)}catch(d){}return a};Element.Methods.cumulativeOffset=function(a){var b=0,c=0;do{b+=a.offsetTop||0;c+=a.offsetLeft||0;if(a.offsetParent==document.body)if(Element.getStyle(a,"position")=="absolute")break;a=a.offsetParent}while(a);return Element._returnOffset(c,b)}}
if("outerHTML"in document.documentElement)Element.Methods.replace=function(a,b){a=$(a);if(b&&b.toElement)b=b.toElement();if(Object.isElement(b)){a.parentNode.replaceChild(b,a);return a}b=Object.toHTML(b);var c=a.parentNode,d=c.tagName.toUpperCase();if(Element._insertionTranslations.tags[d]){var e=a.next();d=Element._getContentFromAnonymousElement(d,b.stripScripts());c.removeChild(a);e?d.each(function(f){c.insertBefore(f,e)}):d.each(function(f){c.appendChild(f)})}else a.outerHTML=b.stripScripts();
b.evalScripts.bind(b).defer();return a};Element._returnOffset=function(a,b){var c=[a,b];c.left=a;c.top=b;return c};Element._getContentFromAnonymousElement=function(a,b){var c=new Element("div"),d=Element._insertionTranslations.tags[a];if(d){c.innerHTML=d[0]+b+d[1];d[2].times(function(){c=c.firstChild})}else c.innerHTML=b;return $A(c.childNodes)};
Element._insertionTranslations={before:function(a,b){a.parentNode.insertBefore(b,a)},top:function(a,b){a.insertBefore(b,a.firstChild)},bottom:function(a,b){a.appendChild(b)},after:function(a,b){a.parentNode.insertBefore(b,a.nextSibling)},tags:{TABLE:["<table>","</table>",1],TBODY:["<table><tbody>","</tbody></table>",2],TR:["<table><tbody><tr>","</tr></tbody></table>",3],TD:["<table><tbody><tr><td>","</td></tr></tbody></table>",4],SELECT:["<select>","</select>",1]}};
(function(){var a=Element._insertionTranslations.tags;Object.extend(a,{THEAD:a.TBODY,TFOOT:a.TBODY,TH:a.TD})})();Element.Methods.Simulated={hasAttribute:function(a,b){b=Element._attributeTranslations.has[b]||b;var c=$(a).getAttributeNode(b);return!!(c&&c.specified)}};Element.Methods.ByTag={};Object.extend(Element,Element.Methods);
(function(a){if(!Prototype.BrowserFeatures.ElementExtensions&&a.__proto__){window.HTMLElement={};window.HTMLElement.prototype=a.__proto__;Prototype.BrowserFeatures.ElementExtensions=true}})(document.createElement("div"));
Element.extend=function(){function a(e,f){for(var g in f){var h=f[g];if(Object.isFunction(h)&&!(g in e))e[g]=h.methodize()}}var b=function(e){if(typeof window.Element!="undefined"){var f=window.Element.prototype;if(f){var g="_"+(Math.random()+"").slice(2);e=document.createElement(e);f[g]="x";e=e[g]!=="x";delete f[g];return e}}return false}("object");if(Prototype.BrowserFeatures.SpecificElementExtensions){if(b)return function(e){if(e&&typeof e._extendedByPrototype=="undefined"){var f=e.tagName;if(f&&
/^(?:object|applet|embed)$/i.test(f)){a(e,Element.Methods);a(e,Element.Methods.Simulated);a(e,Element.Methods.ByTag[f.toUpperCase()])}}return e};return Prototype.K}var c={},d=Element.Methods.ByTag;b=Object.extend(function(e){if(!e||typeof e._extendedByPrototype!="undefined"||e.nodeType!=1||e==window)return e;var f=Object.clone(c),g=e.tagName.toUpperCase();d[g]&&Object.extend(f,d[g]);a(e,f);e._extendedByPrototype=Prototype.emptyFunction;return e},{refresh:function(){if(!Prototype.BrowserFeatures.ElementExtensions){Object.extend(c,
Element.Methods);Object.extend(c,Element.Methods.Simulated)}}});b.refresh();return b}();Element.hasAttribute=function(a,b){if(a.hasAttribute)return a.hasAttribute(b);return Element.Methods.Simulated.hasAttribute(a,b)};
Element.addMethods=function(a){function b(i){i=i.toUpperCase();Element.Methods.ByTag[i]||(Element.Methods.ByTag[i]={});Object.extend(Element.Methods.ByTag[i],a)}function c(i,j,m){m=m||false;for(var r in i){var s=i[r];if(Object.isFunction(s))if(!m||!(r in j))j[r]=s.methodize()}}function d(i){var j,m={OPTGROUP:"OptGroup",TEXTAREA:"TextArea",P:"Paragraph",FIELDSET:"FieldSet",UL:"UList",OL:"OList",DL:"DList",DIR:"Directory",H1:"Heading",H2:"Heading",H3:"Heading",H4:"Heading",H5:"Heading",H6:"Heading",
Q:"Quote",INS:"Mod",DEL:"Mod",A:"Anchor",IMG:"Image",CAPTION:"TableCaption",COL:"TableCol",COLGROUP:"TableCol",THEAD:"TableSection",TFOOT:"TableSection",TBODY:"TableSection",TR:"TableRow",TH:"TableCell",TD:"TableCell",FRAMESET:"FrameSet",IFRAME:"IFrame"};if(m[i])j="HTML"+m[i]+"Element";if(window[j])return window[j];j="HTML"+i+"Element";if(window[j])return window[j];j="HTML"+i.capitalize()+"Element";if(window[j])return window[j];i=document.createElement(i);return i.__proto__||i.constructor.prototype}
var e=Prototype.BrowserFeatures,f=Element.Methods.ByTag;if(!a){Object.extend(Form,Form.Methods);Object.extend(Form.Element,Form.Element.Methods);Object.extend(Element.Methods.ByTag,{FORM:Object.clone(Form.Methods),INPUT:Object.clone(Form.Element.Methods),SELECT:Object.clone(Form.Element.Methods),TEXTAREA:Object.clone(Form.Element.Methods)})}if(arguments.length==2){var g=a;a=arguments[1]}if(g)Object.isArray(g)?g.each(b):b(g);else Object.extend(Element.Methods,a||{});g=window.HTMLElement?HTMLElement.prototype:
Element.prototype;if(e.ElementExtensions){c(Element.Methods,g);c(Element.Methods.Simulated,g,true)}if(e.SpecificElementExtensions)for(var h in Element.Methods.ByTag){e=d(h);Object.isUndefined(e)||c(f[h],e.prototype)}Object.extend(Element,Element.Methods);delete Element.ByTag;Element.extend.refresh&&Element.extend.refresh();Element.cache={}};
document.viewport={getDimensions:function(){return{width:this.getWidth(),height:this.getHeight()}},getScrollOffsets:function(){return Element._returnOffset(window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft,window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop)}};
(function(a){function b(){if(d.WebKit&&!e.evaluate)return document;if(d.Opera&&window.parseFloat(window.opera.version())<9.5)return document.body;return document.documentElement}function c(h){f||(f=b());g[h]="client"+h;a["get"+h]=function(){return f[g[h]]};return a["get"+h]()}var d=Prototype.Browser,e=document,f,g={};a.getWidth=c.curry("Width");a.getHeight=c.curry("Height")})(document.viewport);Element.Storage={UID:1};
Element.addMethods({getStorage:function(a){if(a=$(a)){if(a===window)a=0;else{if(typeof a._prototypeUID==="undefined")a._prototypeUID=[Element.Storage.UID++];a=a._prototypeUID[0]}Element.Storage[a]||(Element.Storage[a]=$H());return Element.Storage[a]}},store:function(a,b,c){if(a=$(a)){arguments.length===2?Element.getStorage(a).update(b):Element.getStorage(a).set(b,c);return a}},retrieve:function(a,b,c){if(a=$(a)){a=Element.getStorage(a);var d=a.get(b);if(Object.isUndefined(d)){a.set(b,c);d=c}return d}},
clone:function(a,b){if(a=$(a)){var c=a.cloneNode(b);c._prototypeUID=void 0;if(b)for(var d=Element.select(c,"*"),e=d.length;e--;)d[e]._prototypeUID=void 0;return Element.extend(c)}}});
var Selector=Class.create({initialize:function(a){this.expression=a.strip();if(this.shouldUseSelectorsAPI())this.mode="selectorsAPI";else if(this.shouldUseXPath()){this.mode="xpath";this.compileXPathMatcher()}else{this.mode="normal";this.compileMatcher()}},shouldUseXPath:function(){var a=function(){var b=false;if(document.evaluate&&window.XPathResult){b=document.createElement("div");b.innerHTML="<ul><li></li></ul><div><ul><li></li></ul></div>";b=document.evaluate(".//*[local-name()='ul' or local-name()='UL']//*[local-name()='li' or local-name()='LI']",
b,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null).snapshotLength!==2}return b}();return function(){if(!Prototype.BrowserFeatures.XPath)return false;var b=this.expression;if(Prototype.Browser.WebKit&&(b.include("-of-type")||b.include(":empty")))return false;if(/(\[[\w-]*?:|:checked)/.test(b))return false;if(a)return false;return true}}(),shouldUseSelectorsAPI:function(){if(!Prototype.BrowserFeatures.SelectorsAPI)return false;if(Selector.CASE_INSENSITIVE_CLASS_NAMES)return false;if(!Selector._div)Selector._div=
new Element("div");try{Selector._div.querySelector(this.expression)}catch(a){return false}return true},compileMatcher:function(){var a=this.expression,b=Selector.patterns,c=Selector.criteria,d,e,f=b.length,g;if(Selector._cache[a])this.matcher=Selector._cache[a];else{for(this.matcher=["this.matcher = function(root) {","var r = root, h = Selector.handlers, c = false, n;"];a&&d!=a&&/\S/.test(a);){d=a;for(var h=0;h<f;h++){e=b[h].re;g=b[h].name;if(e=a.match(e)){this.matcher.push(Object.isFunction(c[g])?
c[g](e):(new Template(c[g])).evaluate(e));a=a.replace(e[0],"");break}}}this.matcher.push("return h.unique(n);\n}");eval(this.matcher.join("\n"));Selector._cache[this.expression]=this.matcher}},compileXPathMatcher:function(){var a=this.expression,b=Selector.patterns,c=Selector.xpath,d,e,f=b.length,g;if(Selector._cache[a])this.xpath=Selector._cache[a];else{for(this.matcher=[".//*"];a&&d!=a&&/\S/.test(a);){d=a;for(var h=0;h<f;h++){g=b[h].name;if(e=a.match(b[h].re)){this.matcher.push(Object.isFunction(c[g])?
c[g](e):(new Template(c[g])).evaluate(e));a=a.replace(e[0],"");break}}}this.xpath=this.matcher.join("");Selector._cache[this.expression]=this.xpath}},findElements:function(a){a=a||document;var b=this.expression;switch(this.mode){case "selectorsAPI":if(a!==document){var c=a.id,d=$(a).identify();d=d.replace(/([\.:])/g,"\\$1");b="#"+d+" "+b}b=$A(a.querySelectorAll(b)).map(Element.extend);a.id=c;return b;case "xpath":return document._getElementsByXPath(this.xpath,a);default:return this.matcher(a)}},match:function(a){this.tokens=
[];for(var b=this.expression,c=Selector.patterns,d=Selector.assertions,e,f,g=c.length,h;b&&e!==b&&/\S/.test(b);){e=b;for(var i=0;i<g;i++){f=c[i].re;h=c[i].name;if(f=b.match(f))if(d[h]){this.tokens.push([h,Object.clone(f)]);b=b.replace(f[0],"")}else return this.findElements(document).include(a)}}b=true;for(i=0;c=this.tokens[i];i++){h=c[0];c=c[1];if(!Selector.assertions[h](a,c)){b=false;break}}return b},toString:function(){return this.expression},inspect:function(){return"#<Selector:"+this.expression.inspect()+
">"}});if(Prototype.BrowserFeatures.SelectorsAPI&&document.compatMode==="BackCompat")Selector.CASE_INSENSITIVE_CLASS_NAMES=function(){var a=document.createElement("div"),b=document.createElement("span");a.id="prototype_test_id";b.className="Test";a.appendChild(b);return a.querySelector("#prototype_test_id .test")!==null}();
Object.extend(Selector,{_cache:{},xpath:{descendant:"//*",child:"/*",adjacent:"/following-sibling::*[1]",laterSibling:"/following-sibling::*",tagName:function(a){if(a[1]=="*")return"";return"[local-name()='"+a[1].toLowerCase()+"' or local-name()='"+a[1].toUpperCase()+"']"},className:"[contains(concat(' ', @class, ' '), ' #{1} ')]",id:"[@id='#{1}']",attrPresence:function(a){a[1]=a[1].toLowerCase();return(new Template("[@#{1}]")).evaluate(a)},attr:function(a){a[1]=a[1].toLowerCase();a[3]=a[5]||a[6];
return(new Template(Selector.xpath.operators[a[2]])).evaluate(a)},pseudo:function(a){var b=Selector.xpath.pseudos[a[1]];if(!b)return"";if(Object.isFunction(b))return b(a);return(new Template(Selector.xpath.pseudos[a[1]])).evaluate(a)},operators:{"=":"[@#{1}='#{3}']","!=":"[@#{1}!='#{3}']","^=":"[starts-with(@#{1}, '#{3}')]","$=":"[substring(@#{1}, (string-length(@#{1}) - string-length('#{3}') + 1))='#{3}']","*=":"[contains(@#{1}, '#{3}')]","~=":"[contains(concat(' ', @#{1}, ' '), ' #{3} ')]","|=":"[contains(concat('-', @#{1}, '-'), '-#{3}-')]"},
pseudos:{"first-child":"[not(preceding-sibling::*)]","last-child":"[not(following-sibling::*)]","only-child":"[not(preceding-sibling::* or following-sibling::*)]",empty:"[count(*) = 0 and (count(text()) = 0)]",checked:"[@checked]",disabled:"[(@disabled) and (@type!='hidden')]",enabled:"[not(@disabled) and (@type!='hidden')]",not:function(a){for(var b=a[6],c=Selector.patterns,d=Selector.xpath,e,f,g=c.length,h=[];b&&e!=b&&/\S/.test(b);){e=b;for(var i=0;i<g;i++){f=c[i].name;if(a=b.match(c[i].re)){f=
Object.isFunction(d[f])?d[f](a):(new Template(d[f])).evaluate(a);h.push("("+f.substring(1,f.length-1)+")");b=b.replace(a[0],"");break}}}return"[not("+h.join(" and ")+")]"},"nth-child":function(a){return Selector.xpath.pseudos.nth("(count(./preceding-sibling::*) + 1) ",a)},"nth-last-child":function(a){return Selector.xpath.pseudos.nth("(count(./following-sibling::*) + 1) ",a)},"nth-of-type":function(a){return Selector.xpath.pseudos.nth("position() ",a)},"nth-last-of-type":function(a){return Selector.xpath.pseudos.nth("(last() + 1 - position()) ",
a)},"first-of-type":function(a){a[6]="1";return Selector.xpath.pseudos["nth-of-type"](a)},"last-of-type":function(a){a[6]="1";return Selector.xpath.pseudos["nth-last-of-type"](a)},"only-of-type":function(a){var b=Selector.xpath.pseudos;return b["first-of-type"](a)+b["last-of-type"](a)},nth:function(a,b){var c,d=b[6];if(d=="even")d="2n+0";if(d=="odd")d="2n+1";if(c=d.match(/^(\d+)$/))return"["+a+"= "+c[1]+"]";if(c=d.match(/^(-?\d*)?n(([+-])(\d+))?/)){if(c[1]=="-")c[1]=-1;d=c[1]?Number(c[1]):1;c=c[2]?
Number(c[2]):0;return(new Template("[((#{fragment} - #{b}) mod #{a} = 0) and ((#{fragment} - #{b}) div #{a} >= 0)]")).evaluate({fragment:a,a:d,b:c})}}}},criteria:{tagName:'n = h.tagName(n, r, "#{1}", c);      c = false;',className:'n = h.className(n, r, "#{1}", c);    c = false;',id:'n = h.id(n, r, "#{1}", c);           c = false;',attrPresence:'n = h.attrPresence(n, r, "#{1}", c); c = false;',attr:function(a){a[3]=a[5]||a[6];return(new Template('n = h.attr(n, r, "#{1}", "#{3}", "#{2}", c); c = false;')).evaluate(a)},
pseudo:function(a){if(a[6])a[6]=a[6].replace(/"/g,'\\"');return(new Template('n = h.pseudo(n, "#{1}", "#{6}", r, c); c = false;')).evaluate(a)},descendant:'c = "descendant";',child:'c = "child";',adjacent:'c = "adjacent";',laterSibling:'c = "laterSibling";'},patterns:[{name:"laterSibling",re:/^\s*~\s*/},{name:"child",re:/^\s*>\s*/},{name:"adjacent",re:/^\s*\+\s*/},{name:"descendant",re:/^\s/},{name:"tagName",re:/^\s*(\*|[\w\-]+)(\b|$)?/},{name:"id",re:/^#([\w\-\*]+)(\b|$)/},{name:"className",re:/^\.([\w\-\*]+)(\b|$)/},
{name:"pseudo",re:/^:((first|last|nth|nth-last|only)(-child|-of-type)|empty|checked|(en|dis)abled|not)(\((.*?)\))?(\b|$|(?=\s|[:+~>]))/},{name:"attrPresence",re:/^\[((?:[\w-]+:)?[\w-]+)\]/},{name:"attr",re:/\[((?:[\w-]*:)?[\w-]+)\s*(?:([!^$*~|]?=)\s*((['"])([^\4]*?)\4|([^'"][^\]]*?)))?\]/}],assertions:{tagName:function(a,b){return b[1].toUpperCase()==a.tagName.toUpperCase()},className:function(a,b){return Element.hasClassName(a,b[1])},id:function(a,b){return a.id===b[1]},attrPresence:function(a,b){return Element.hasAttribute(a,
b[1])},attr:function(a,b){var c=Element.readAttribute(a,b[1]);return c&&Selector.operators[b[2]](c,b[5]||b[6])}},handlers:{concat:function(a,b){for(var c=0,d;d=b[c];c++)a.push(d);return a},mark:function(a){for(var b=Prototype.emptyFunction,c=0,d;d=a[c];c++)d._countedByPrototype=b;return a},unmark:function(){return function(){var a=document.createElement("div"),b=false;a._countedByPrototype="x";return b=a.getAttribute("_countedByPrototype")==="x"}()?function(a){for(var b=0,c;c=a[b];b++)c.removeAttribute("_countedByPrototype");
return a}:function(a){for(var b=0,c;c=a[b];b++)c._countedByPrototype=void 0;return a}}(),index:function(a,b,c){a._countedByPrototype=Prototype.emptyFunction;if(b){a=a.childNodes;b=a.length-1;for(var d=1;b>=0;b--){var e=a[b];if(e.nodeType==1&&(!c||e._countedByPrototype))e.nodeIndex=d++}}else{b=0;d=1;for(a=a.childNodes;e=a[b];b++)if(e.nodeType==1&&(!c||e._countedByPrototype))e.nodeIndex=d++}},unique:function(a){if(a.length==0)return a;for(var b=[],c,d=0,e=a.length;d<e;d++)if(typeof(c=a[d])._countedByPrototype==
"undefined"){c._countedByPrototype=Prototype.emptyFunction;b.push(Element.extend(c))}return Selector.handlers.unmark(b)},descendant:function(a){for(var b=Selector.handlers,c=0,d=[],e;e=a[c];c++)b.concat(d,e.getElementsByTagName("*"));return d},child:function(a){for(var b=0,c=[],d;d=a[b];b++)for(var e=0,f;f=d.childNodes[e];e++)f.nodeType==1&&f.tagName!="!"&&c.push(f);return c},adjacent:function(a){for(var b=0,c=[],d;d=a[b];b++)(d=this.nextElementSibling(d))&&c.push(d);return c},laterSibling:function(a){for(var b=
Selector.handlers,c=0,d=[],e;e=a[c];c++)b.concat(d,Element.nextSiblings(e));return d},nextElementSibling:function(a){for(;a=a.nextSibling;)if(a.nodeType==1)return a;return null},previousElementSibling:function(a){for(;a=a.previousSibling;)if(a.nodeType==1)return a;return null},tagName:function(a,b,c,d){var e=c.toUpperCase(),f=[],g=Selector.handlers;if(a){if(d){if(d=="descendant"){for(b=0;d=a[b];b++)g.concat(f,d.getElementsByTagName(c));return f}else a=this[d](a);if(c=="*")return a}for(b=0;d=a[b];b++)d.tagName.toUpperCase()===
e&&f.push(d);return f}else return b.getElementsByTagName(c)},id:function(a,b,c,d){var e=$(c),f=Selector.handlers;if(b==document){if(!e)return[];if(!a)return[e]}else if(!b.sourceIndex||b.sourceIndex<1){a=b.getElementsByTagName("*");for(var g=0,h;h=a[g];g++)if(h.id===c)return[h]}if(a){if(d)if(d=="child")for(b=0;h=a[b];b++){if(e.parentNode==h)return[e]}else if(d=="descendant")for(b=0;h=a[b];b++){if(Element.descendantOf(e,h))return[e]}else if(d=="adjacent")for(b=0;h=a[b];b++){if(Selector.handlers.previousElementSibling(e)==
h)return[e]}else a=f[d](a);for(b=0;h=a[b];b++)if(h==e)return[e];return[]}return e&&Element.descendantOf(e,b)?[e]:[]},className:function(a,b,c,d){if(a&&d)a=this[d](a);return Selector.handlers.byClassName(a,b,c)},byClassName:function(a,b,c){a||(a=Selector.handlers.descendant([b]));b=" "+c+" ";for(var d=0,e=[],f,g;f=a[d];d++){g=f.className;if(g.length!=0)if(g==c||(" "+g+" ").include(b))e.push(f)}return e},attrPresence:function(a,b,c,d){a||(a=b.getElementsByTagName("*"));if(a&&d)a=this[d](a);b=[];d=0;
for(var e;e=a[d];d++)Element.hasAttribute(e,c)&&b.push(e);return b},attr:function(a,b,c,d,e,f){a||(a=b.getElementsByTagName("*"));if(a&&f)a=this[f](a);b=Selector.operators[e];e=[];f=0;for(var g;g=a[f];f++){var h=Element.readAttribute(g,c);h!==null&&b(h,d)&&e.push(g)}return e},pseudo:function(a,b,c,d,e){if(a&&e)a=this[e](a);a||(a=d.getElementsByTagName("*"));return Selector.pseudos[b](a,c,d)}},pseudos:{"first-child":function(a){for(var b=0,c=[],d;d=a[b];b++)Selector.handlers.previousElementSibling(d)||
c.push(d);return c},"last-child":function(a){for(var b=0,c=[],d;d=a[b];b++)Selector.handlers.nextElementSibling(d)||c.push(d);return c},"only-child":function(a){for(var b=Selector.handlers,c=0,d=[],e;e=a[c];c++)!b.previousElementSibling(e)&&!b.nextElementSibling(e)&&d.push(e);return d},"nth-child":function(a,b,c){return Selector.pseudos.nth(a,b,c)},"nth-last-child":function(a,b,c){return Selector.pseudos.nth(a,b,c,true)},"nth-of-type":function(a,b,c){return Selector.pseudos.nth(a,b,c,false,true)},
"nth-last-of-type":function(a,b,c){return Selector.pseudos.nth(a,b,c,true,true)},"first-of-type":function(a,b,c){return Selector.pseudos.nth(a,"1",c,false,true)},"last-of-type":function(a,b,c){return Selector.pseudos.nth(a,"1",c,true,true)},"only-of-type":function(a,b,c){var d=Selector.pseudos;return d["last-of-type"](d["first-of-type"](a,b,c),b,c)},getIndices:function(a,b,c){if(a==0)return b>0?[b]:[];return $R(1,c).inject([],function(d,e){0==(e-b)%a&&(e-b)/a>=0&&d.push(e);return d})},nth:function(a,
b,c,d,e){if(a.length==0)return[];if(b=="even")b="2n+0";if(b=="odd")b="2n+1";c=Selector.handlers;var f=[],g=[],h;c.mark(a);h=0;for(var i;i=a[h];h++)if(!i.parentNode._countedByPrototype){c.index(i.parentNode,d,e);g.push(i.parentNode)}if(b.match(/^\d+$/)){b=Number(b);for(h=0;i=a[h];h++)i.nodeIndex==b&&f.push(i)}else if(h=b.match(/^(-?\d*)?n(([+-])(\d+))?/)){if(h[1]=="-")h[1]=-1;b=Selector.pseudos.getIndices(h[1]?Number(h[1]):1,h[2]?Number(h[2]):0,a.length);h=0;for(d=b.length;i=a[h];h++)for(e=0;e<d;e++)i.nodeIndex==
b[e]&&f.push(i)}c.unmark(a);c.unmark(g);return f},empty:function(a){for(var b=0,c=[],d;d=a[b];b++)d.tagName=="!"||d.firstChild||c.push(d);return c},not:function(a,b,c){var d=Selector.handlers;b=(new Selector(b)).findElements(c);d.mark(b);c=0;for(var e=[],f;f=a[c];c++)f._countedByPrototype||e.push(f);d.unmark(b);return e},enabled:function(a){for(var b=0,c=[],d;d=a[b];b++)if(!d.disabled&&(!d.type||d.type!=="hidden"))c.push(d);return c},disabled:function(a){for(var b=0,c=[],d;d=a[b];b++)d.disabled&&
c.push(d);return c},checked:function(a){for(var b=0,c=[],d;d=a[b];b++)d.checked&&c.push(d);return c}},operators:{"=":function(a,b){return a==b},"!=":function(a,b){return a!=b},"^=":function(a,b){return a==b||a&&a.startsWith(b)},"$=":function(a,b){return a==b||a&&a.endsWith(b)},"*=":function(a,b){return a==b||a&&a.include(b)},"~=":function(a,b){return(" "+a+" ").include(" "+b+" ")},"|=":function(a,b){return("-"+(a||"").toUpperCase()+"-").include("-"+(b||"").toUpperCase()+"-")}},split:function(a){var b=
[];a.scan(/(([\w#:.~>+()\s-]+|\*|\[.*?\])+)\s*(,|$)/,function(c){b.push(c[1].strip())});return b},matchElements:function(a,b){var c=$$(b),d=Selector.handlers;d.mark(c);for(var e=0,f=[],g;g=a[e];e++)g._countedByPrototype&&f.push(g);d.unmark(c);return f},findElement:function(a,b,c){if(Object.isNumber(b)){c=b;b=false}return Selector.matchElements(a,b||"*")[c||0]},findChildElements:function(a,b){b=Selector.split(b.join(","));for(var c=[],d=Selector.handlers,e=0,f=b.length,g;e<f;e++){g=new Selector(b[e].strip());
d.concat(c,g.findElements(a))}return f>1?d.unique(c):c}});Prototype.Browser.IE&&Object.extend(Selector.handlers,{concat:function(a,b){for(var c=0,d;d=b[c];c++)d.tagName!=="!"&&a.push(d);return a}});function $$(){return Selector.findChildElements(document,$A(arguments))}
var Form={reset:function(a){a=$(a);a.reset();return a},serializeElements:function(a,b){if(typeof b!="object")b={hash:!!b};else if(Object.isUndefined(b.hash))b.hash=true;var c,d,e=false,f=b.submit,g=a.inject({},function(h,i){if(!i.disabled&&i.name){c=i.name;d=$(i).getValue();if(d!=null&&i.type!="file"&&(i.type!="submit"||!e&&f!==false&&(!f||c==f)&&(e=true)))if(c in h){Object.isArray(h[c])||(h[c]=[h[c]]);h[c].push(d)}else h[c]=d}return h});return b.hash?g:Object.toQueryString(g)}};
Form.Methods={serialize:function(a,b){return Form.serializeElements(Form.getElements(a),b)},getElements:function(a){a=$(a).getElementsByTagName("*");for(var b,c=[],d=Form.Element.Serializers,e=0;b=a[e];e++)c.push(b);return c.inject([],function(f,g){d[g.tagName.toLowerCase()]&&f.push(Element.extend(g));return f})},getInputs:function(a,b,c){a=$(a);a=a.getElementsByTagName("input");if(!b&&!c)return $A(a).map(Element.extend);for(var d=0,e=[],f=a.length;d<f;d++){var g=a[d];b&&g.type!=b||c&&g.name!=c||
e.push(Element.extend(g))}return e},disable:function(a){a=$(a);Form.getElements(a).invoke("disable");return a},enable:function(a){a=$(a);Form.getElements(a).invoke("enable");return a},findFirstElement:function(a){a=$(a).getElements().findAll(function(c){return"hidden"!=c.type&&!c.disabled});var b=a.findAll(function(c){return c.hasAttribute("tabIndex")&&c.tabIndex>=0}).sortBy(function(c){return c.tabIndex}).first();return b?b:a.find(function(c){return/^(?:input|select|textarea)$/i.test(c.tagName)})},
focusFirstElement:function(a){a=$(a);a.findFirstElement().activate();return a},request:function(a,b){a=$(a);b=Object.clone(b||{});var c=b.parameters,d=a.readAttribute("action")||"";if(d.blank())d=window.location.href;b.parameters=a.serialize(true);if(c){if(Object.isString(c))c=c.toQueryParams();Object.extend(b.parameters,c)}if(a.hasAttribute("method")&&!b.method)b.method=a.method;return new Ajax.Request(d,b)}};
Form.Element={focus:function(a){$(a).focus();return a},select:function(a){$(a).select();return a}};
Form.Element.Methods={serialize:function(a){a=$(a);if(!a.disabled&&a.name){var b=a.getValue();if(b!=undefined){var c={};c[a.name]=b;return Object.toQueryString(c)}}return""},getValue:function(a){a=$(a);var b=a.tagName.toLowerCase();return Form.Element.Serializers[b](a)},setValue:function(a,b){a=$(a);var c=a.tagName.toLowerCase();Form.Element.Serializers[c](a,b);return a},clear:function(a){$(a).value="";return a},present:function(a){return $(a).value!=""},activate:function(a){a=$(a);try{a.focus();
if(a.select&&(a.tagName.toLowerCase()!="input"||!/^(?:button|reset|submit)$/i.test(a.type)))a.select()}catch(b){}return a},disable:function(a){a=$(a);a.disabled=true;return a},enable:function(a){a=$(a);a.disabled=false;return a}};var Field=Form.Element,$F=Form.Element.Methods.getValue;
Form.Element.Serializers={input:function(a,b){switch(a.type.toLowerCase()){case "checkbox":case "radio":return Form.Element.Serializers.inputSelector(a,b);default:return Form.Element.Serializers.textarea(a,b)}},inputSelector:function(a,b){if(Object.isUndefined(b))return a.checked?a.value:null;else a.checked=!!b},textarea:function(a,b){if(Object.isUndefined(b))return a.value;else a.value=b},select:function(a,b){if(Object.isUndefined(b))return this[a.type=="select-one"?"selectOne":"selectMany"](a);
else for(var c,d,e=!Object.isArray(b),f=0,g=a.length;f<g;f++){c=a.options[f];d=this.optionValue(c);if(e){if(d==b){c.selected=true;break}}else c.selected=b.include(d)}},selectOne:function(a){var b=a.selectedIndex;return b>=0?this.optionValue(a.options[b]):null},selectMany:function(a){var b,c=a.length;if(!c)return null;var d=0;for(b=[];d<c;d++){var e=a.options[d];e.selected&&b.push(this.optionValue(e))}return b},optionValue:function(a){return Element.extend(a).hasAttribute("value")?a.value:a.text}};
Abstract.TimedObserver=Class.create(PeriodicalExecuter,{initialize:function($super,b,c,d){$super(d,c);this.element=$(b);this.lastValue=this.getValue()},execute:function(){var a=this.getValue();if(Object.isString(this.lastValue)&&Object.isString(a)?this.lastValue!=a:String(this.lastValue)!=String(a)){this.callback(this.element,a);this.lastValue=a}}});Form.Element.Observer=Class.create(Abstract.TimedObserver,{getValue:function(){return Form.Element.getValue(this.element)}});
Form.Observer=Class.create(Abstract.TimedObserver,{getValue:function(){return Form.serialize(this.element)}});
Abstract.EventObserver=Class.create({initialize:function(a,b){this.element=$(a);this.callback=b;this.lastValue=this.getValue();this.element.tagName.toLowerCase()=="form"?this.registerFormCallbacks():this.registerCallback(this.element)},onElementEvent:function(){var a=this.getValue();if(this.lastValue!=a){this.callback(this.element,a);this.lastValue=a}},registerFormCallbacks:function(){Form.getElements(this.element).each(this.registerCallback,this)},registerCallback:function(a){if(a.type)switch(a.type.toLowerCase()){case "checkbox":case "radio":Event.observe(a,
"click",this.onElementEvent.bind(this));break;default:Event.observe(a,"change",this.onElementEvent.bind(this))}}});Form.Element.EventObserver=Class.create(Abstract.EventObserver,{getValue:function(){return Form.Element.getValue(this.element)}});Form.EventObserver=Class.create(Abstract.EventObserver,{getValue:function(){return Form.serialize(this.element)}});
(function(){function a(l){var o=document.documentElement,q=document.body||{scrollLeft:0};return l.pageX||l.clientX+(o.scrollLeft||q.scrollLeft)-(o.clientLeft||0)}function b(l){var o=document.documentElement,q=document.body||{scrollTop:0};return l.pageY||l.clientY+(o.scrollTop||q.scrollTop)-(o.clientTop||0)}function c(l,o,q){var w=Element.retrieve(l,"prototype_event_registry");if(Object.isUndefined(w)){v.push(l);w=Element.retrieve(l,"prototype_event_registry",$H())}var x=w.get(o);if(Object.isUndefined(x)){x=
[];w.set(o,x)}if(x.pluck("handler").include(q))return false;var y;if(o.include(":"))y=function(p){if(Object.isUndefined(p.eventName))return false;if(p.eventName!==o)return false;h.extend(p,l);q.call(l,p)};else if(!j&&(o==="mouseenter"||o==="mouseleave")){if(o==="mouseenter"||o==="mouseleave")y=function(p){h.extend(p,l);for(var u=p.relatedTarget;u&&u!==l;)try{u=u.parentNode}catch(z){u=l}u!==l&&q.call(l,p)}}else y=function(p){h.extend(p,l);q.call(l,p)};y.handler=q;x.push(y);return y}function d(){for(var l=
0,o=v.length;l<o;l++){h.stopObserving(v[l]);v[l]=null}}function e(l,o,q){l=$(l);q=c(l,o,q);if(!q)return l;if(o.include(":"))if(l.addEventListener)l.addEventListener("dataavailable",q,false);else{l.attachEvent("ondataavailable",q);l.attachEvent("onfilterchange",q)}else{o=A(o);l.addEventListener?l.addEventListener(o,q,false):l.attachEvent("on"+o,q)}return l}function f(l,o,q){l=$(l);var w=Element.retrieve(l,"prototype_event_registry");if(Object.isUndefined(w))return l;if(o&&!q){var x=w.get(o);if(Object.isUndefined(x))return l;
x.each(function(u){Element.stopObserving(l,o,u.handler)});return l}else if(!o){w.each(function(u){var z=u.key;u.value.each(function(B){Element.stopObserving(l,z,B.handler)})});return l}if(x=w.get(o)){var y=x.find(function(u){return u.handler===q});if(!y)return l;var p=A(o);if(o.include(":"))if(l.removeEventListener)l.removeEventListener("dataavailable",y,false);else{l.detachEvent("ondataavailable",y);l.detachEvent("onfilterchange",y)}else l.removeEventListener?l.removeEventListener(p,y,false):l.detachEvent("on"+
p,y);w.set(o,x.without(y));return l}}function g(l,o,q,w){l=$(l);if(Object.isUndefined(w))w=true;if(l==document&&document.createEvent&&!l.dispatchEvent)l=document.documentElement;var x;if(document.createEvent){x=document.createEvent("HTMLEvents");x.initEvent("dataavailable",true,true)}else{x=document.createEventObject();x.eventType=w?"ondataavailable":"onfilterchange"}x.eventName=o;x.memo=q||{};document.createEvent?l.dispatchEvent(x):l.fireEvent(x.eventType,x);return h.extend(x)}var h={KEY_BACKSPACE:8,
KEY_TAB:9,KEY_RETURN:13,KEY_ESC:27,KEY_LEFT:37,KEY_UP:38,KEY_RIGHT:39,KEY_DOWN:40,KEY_DELETE:46,KEY_HOME:36,KEY_END:35,KEY_PAGEUP:33,KEY_PAGEDOWN:34,KEY_INSERT:45,cache:{}},i=document.documentElement,j="onmouseenter"in i&&"onmouseleave"in i,m;if(Prototype.Browser.IE){var r={0:1,1:4,2:2};m=function(l,o){return l.button===r[o]}}else m=Prototype.Browser.WebKit?function(l,o){switch(o){case 0:return l.which==1&&!l.metaKey;case 1:return l.which==1&&l.metaKey;default:return false}}:function(l,o){return l.which?
l.which===o+1:l.button===o};h.Methods={isLeftClick:function(l){return m(l,0)},isMiddleClick:function(l){return m(l,1)},isRightClick:function(l){return m(l,2)},element:function(l){l=h.extend(l);var o=l.target,q=l.type;if((l=l.currentTarget)&&l.tagName)if(q==="load"||q==="error"||q==="click"&&l.tagName.toLowerCase()==="input"&&l.type==="radio")o=l;if(o.nodeType==Node.TEXT_NODE)o=o.parentNode;return Element.extend(o)},findElement:function(l,o){var q=h.element(l);if(!o)return q;q=[q].concat(q.ancestors());
return Selector.findElement(q,o,0)},pointer:function(l){return{x:a(l),y:b(l)}},pointerX:a,pointerY:b,stop:function(l){h.extend(l);l.preventDefault();l.stopPropagation();l.stopped=true}};var s=Object.keys(h.Methods).inject({},function(l,o){l[o]=h.Methods[o].methodize();return l});if(Prototype.Browser.IE){var n=function(l){switch(l.type){case "mouseover":l=l.fromElement;break;case "mouseout":l=l.toElement;break;default:return null}return Element.extend(l)};Object.extend(s,{stopPropagation:function(){this.cancelBubble=
true},preventDefault:function(){this.returnValue=false},inspect:function(){return"[object Event]"}});h.extend=function(l,o){if(!l)return false;if(l._extendedByPrototype)return l;l._extendedByPrototype=Prototype.emptyFunction;var q=h.pointer(l);Object.extend(l,{target:l.srcElement||o,relatedTarget:n(l),pageX:q.x,pageY:q.y});return Object.extend(l,s)}}else{h.prototype=window.Event.prototype||document.createEvent("HTMLEvents").__proto__;Object.extend(h.prototype,s);h.extend=Prototype.K}var v=[];Prototype.Browser.IE&&
window.attachEvent("onunload",d);Prototype.Browser.WebKit&&window.addEventListener("unload",Prototype.emptyFunction,false);var A=Prototype.K;j||(A=function(l){var o={mouseenter:"mouseover",mouseleave:"mouseout"};return l in o?o[l]:l});Object.extend(h,h.Methods);Object.extend(h,{fire:g,observe:e,stopObserving:f});Element.addMethods({fire:g,observe:e,stopObserving:f});Object.extend(document,{fire:g.methodize(),observe:e.methodize(),stopObserving:f.methodize(),loaded:false});if(window.Event)Object.extend(window.Event,
h);else window.Event=h})();
(function(){function a(){if(!document.loaded){d&&window.clearTimeout(d);document.loaded=true;document.fire("dom:loaded")}}function b(){if(document.readyState==="complete"){document.stopObserving("readystatechange",b);a()}}function c(){try{document.documentElement.doScroll("left")}catch(e){d=c.defer();return}a()}var d;if(document.addEventListener)document.addEventListener("DOMContentLoaded",a,false);else{document.observe("readystatechange",b);if(window==top)d=c.defer()}Event.observe(window,"load",
a)})();Element.addMethods();Hash.toQueryString=Object.toQueryString;var Toggle={display:Element.toggle};Element.Methods.childOf=Element.Methods.descendantOf;
var Insertion={Before:function(a,b){return Element.insert(a,{before:b})},Top:function(a,b){return Element.insert(a,{top:b})},Bottom:function(a,b){return Element.insert(a,{bottom:b})},After:function(a,b){return Element.insert(a,{after:b})}},$continue=Error('"throw $continue" is deprecated, use "return" instead'),Position={includeScrollOffsets:false,prepare:function(){this.deltaX=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0;this.deltaY=window.pageYOffset||document.documentElement.scrollTop||
document.body.scrollTop||0},within:function(a,b,c){if(this.includeScrollOffsets)return this.withinIncludingScrolloffsets(a,b,c);this.xcomp=b;this.ycomp=c;this.offset=Element.cumulativeOffset(a);return c>=this.offset[1]&&c<this.offset[1]+a.offsetHeight&&b>=this.offset[0]&&b<this.offset[0]+a.offsetWidth},withinIncludingScrolloffsets:function(a,b,c){var d=Element.cumulativeScrollOffset(a);this.xcomp=b+d[0]-this.deltaX;this.ycomp=c+d[1]-this.deltaY;this.offset=Element.cumulativeOffset(a);return this.ycomp>=
this.offset[1]&&this.ycomp<this.offset[1]+a.offsetHeight&&this.xcomp>=this.offset[0]&&this.xcomp<this.offset[0]+a.offsetWidth},overlap:function(a,b){if(!a)return 0;if(a=="vertical")return(this.offset[1]+b.offsetHeight-this.ycomp)/b.offsetHeight;if(a=="horizontal")return(this.offset[0]+b.offsetWidth-this.xcomp)/b.offsetWidth},cumulativeOffset:Element.Methods.cumulativeOffset,positionedOffset:Element.Methods.positionedOffset,absolutize:function(a){Position.prepare();return Element.absolutize(a)},relativize:function(a){Position.prepare();
return Element.relativize(a)},realOffset:Element.Methods.cumulativeScrollOffset,offsetParent:Element.Methods.getOffsetParent,page:Element.Methods.viewportOffset,clone:function(a,b,c){c=c||{};return Element.clonePosition(b,a,c)}};
if(!document.getElementsByClassName)document.getElementsByClassName=function(a){function b(c){return c.blank()?null:"[contains(concat(' ', @class, ' '), ' "+c+" ')]"}a.getElementsByClassName=Prototype.BrowserFeatures.XPath?function(c,d){d=d.toString().strip();var e=/\s/.test(d)?$w(d).map(b).join(""):b(d);return e?document._getElementsByXPath(".//*"+e,c):[]}:function(c,d){d=d.toString().strip();var e=[],f=/\s/.test(d)?$w(d):null;if(!f&&!d)return e;var g=$(c).getElementsByTagName("*");d=" "+d+" ";for(var h=
0,i,j;i=g[h];h++)if(i.className&&(j=" "+i.className+" ")&&(j.include(d)||f&&f.all(function(m){return!m.toString().blank()&&j.include(" "+m+" ")})))e.push(Element.extend(i));return e};return function(c,d){return $(d||document.body).getElementsByClassName(c)}}(Element.Methods);Element.ClassNames=Class.create();
Element.ClassNames.prototype={initialize:function(a){this.element=$(a)},_each:function(a){this.element.className.split(/\s+/).select(function(b){return b.length>0})._each(a)},set:function(a){this.element.className=a},add:function(a){this.include(a)||this.set($A(this).concat(a).join(" "))},remove:function(a){this.include(a)&&this.set($A(this).without(a).join(" "))},toString:function(){return $A(this).join(" ")}};Object.extend(Element.ClassNames.prototype,Enumerable);var S2={Version:"2.0.0_a5",Extensions:{}};
Function.prototype.optionize=function(){var a=this,b=a.argumentNames(),c=this.length-1,d=function(){var e=$A(arguments),f=typeof e.last()==="object"?e.pop():{},g=[];if(c>0)g=(e.length>0?e:[null]).inGroupsOf(c).flatten().concat(f);return a.apply(this,g)};d.argumentNames=function(){return b};return d};Function.ABSTRACT=function(){throw"Abstract method. Implement in subclass.";};
Object.extend(Number.prototype,{constrain:function(a,b){var c=a<b?a:b,d=a<b?b:a,e=Number(this);if(e<c)e=c;if(e>d)e=d;return e},nearer:function(a,b){var c=Number(this);return Math.abs(c-a)<Math.abs(c-b)?a:b},tween:function(a,b){return this+(a-this)*b}});Object.propertize=function(a,b){return Object.isString(a)?b[a]:a};
S2.CSS={PROPERTY_MAP:{backgroundColor:"color",borderBottomColor:"color",borderBottomWidth:"length",borderLeftColor:"color",borderLeftWidth:"length",borderRightColor:"color",borderRightWidth:"length",borderSpacing:"length",borderTopColor:"color",borderTopWidth:"length",bottom:"length",color:"color",fontSize:"length",fontWeight:"integer",height:"length",left:"length",letterSpacing:"length",lineHeight:"length",marginBottom:"length",marginLeft:"length",marginRight:"length",marginTop:"length",maxHeight:"length",
maxWidth:"length",minHeight:"length",minWidth:"length",opacity:"number",outlineColor:"color",outlineOffset:"length",outlineWidth:"length",paddingBottom:"length",paddingLeft:"length",paddingRight:"length",paddingTop:"length",right:"length",textIndent:"length",top:"length",width:"length",wordSpacing:"length",zIndex:"integer",zoom:"number"},LENGTH:/^(([\+\-]?[0-9\.]+)(em|ex|px|in|cm|mm|pt|pc|\%))|0$/,NUMBER:/([\+-]*\d+\.?\d*)/,__parseStyleElement:document.createElement("div"),parseStyle:function(a){S2.CSS.__parseStyleElement.innerHTML=
'<div style="'+a+'"></div>';var b=S2.CSS.__parseStyleElement.childNodes[0].style,c={};S2.CSS.NUMERIC_PROPERTIES.each(function(d){if(b[d])c[d]=b[d]});S2.CSS.COLOR_PROPERTIES.each(function(d){if(b[d])c[d]=S2.CSS.colorFromString(b[d])});if(Prototype.Browser.IE&&a.include("opacity"))c.opacity=a.match(/opacity:\s*((?:0|1)?(?:\.\d*)?)/)[1];return c},normalizeColor:function(a){if(!a||a=="rgba(0, 0, 0, 0)"||a=="transparent")a="#ffffff";a=S2.CSS.colorFromString(a);return[parseInt(a.slice(1,3),16),parseInt(a.slice(3,
5),16),parseInt(a.slice(5,7),16)]},colorFromString:function(a,b){var c="#",d,e;if(a.slice(0,4)=="rgb("){d=a.slice(4,a.length-1).split(",");for(e=3;e--;)c+=parseInt(d[2-e]).toColorPart()}else if(a.slice(0,1)=="#"){if(a.length==4)for(e=1;e<4;e++)c+=(a.charAt(e)+a.charAt(e)).toLowerCase();if(a.length==7)c=a.toLowerCase()}return c.length==7?c:b||c},interpolateColor:function(a,b,c){a=S2.CSS.normalizeColor(a);b=S2.CSS.normalizeColor(b);return"#"+[0,1,2].map(function(d){return Math.max(Math.min(a[d].tween(b[d],
c).round(),255),0).toColorPart()}).join("")},interpolateNumber:function(a,b,c){return 1*(a||0).tween(b,c).toFixed(3)},interpolateLength:function(a,b,c){if(!a||parseFloat(a)===0)a="0"+b.gsub(S2.CSS.NUMBER,"");b.scan(S2.CSS.NUMBER,function(d){b=1*d[1]});return a.gsub(S2.CSS.NUMBER,function(d){return(1*parseFloat(d[1]).tween(b,c).toFixed(3)).toString()})},interpolateInteger:function(a,b,c){return parseInt(a).tween(b,c).round()},interpolate:function(a,b,c,d){return S2.CSS["interpolate"+S2.CSS.PROPERTY_MAP[a.camelize()].capitalize()](b,
c,d)},ElementMethods:{getStyles:function(a){var b=document.defaultView.getComputedStyle($(a),null);return S2.CSS.PROPERTIES.inject({},function(c,d){c[d]=b[d];return c})}}};S2.CSS.PROPERTIES=[];for(property in S2.CSS.PROPERTY_MAP)S2.CSS.PROPERTIES.push(property);S2.CSS.NUMERIC_PROPERTIES=S2.CSS.PROPERTIES.findAll(function(a){return!a.endsWith("olor")});S2.CSS.COLOR_PROPERTIES=S2.CSS.PROPERTIES.findAll(function(a){return a.endsWith("olor")});
if(!(document.defaultView&&document.defaultView.getComputedStyle))S2.CSS.ElementMethods.getStyles=function(a){a=$(a);var b=a.currentStyle,c;c=S2.CSS.PROPERTIES.inject({},function(d,e){d[e]=b[e];return d});if(!c.opacity)c.opacity=a.getOpacity();return c};Element.addMethods(S2.CSS.ElementMethods);
S2.FX=function(){function a(g){e[(f+=g)>0?"start":"stop"]()}function b(){c.invoke("render",e.getTimestamp())}var c=[],d,e,f=0;return{initialize:function(g){if(!d){c.push(d=new S2.FX.Queue);S2.FX.DefaultOptions.queue=d;e=g||new S2.FX.Heartbeat;document.observe("effect:heartbeat",b).observe("effect:queued",a.curry(1)).observe("effect:dequeued",a.curry(-1))}},getQueues:function(){return c},addQueue:function(g){c.push(g)},getHeartbeat:function(){return e},setHeartbeat:function(g){e=g}}}();
Object.extend(S2.FX,{DefaultOptions:{transition:"sinusoidal",position:"parallel",fps:60,duration:0.2},elementDoesNotExistError:{name:"ElementDoesNotExistError",message:"The specified DOM element does not exist, but is required for this effect to operate"},parseOptions:function(a){if(Object.isNumber(a))a={duration:a};else if(Object.isFunction(a))a={after:a};else if(Object.isString(a))a={duration:a=="slow"?1:a=="fast"?0.1:0.2};return a||{}}});
S2.FX.Base=Class.create({initialize:function(a){S2.FX.initialize();this.updateWithoutWrappers=this.update;a&&a.queue&&!S2.FX.getQueues().include(a.queue)&&S2.FX.addQueue(a.queue);this.setOptions(a);this.duration=this.options.duration*1E3;this.state="idle";["after","before"].each(function(b){this[b]=function(c){c(this);return this}},this)},setOptions:function(a){a=S2.FX.parseOptions(a);if(!this.options){this.options=Object.extend(Object.extend({},S2.FX.DefaultOptions),a);if(a.tween)this.options.transition=
a.tween}if(this.options.beforeUpdate||this.options.afterUpdate)this.update=this.updateWithoutWrappers.wrap(function(b,c){this.options.beforeUpdate&&this.options.beforeUpdate(this,c);b(c);this.options.afterUpdate&&this.options.afterUpdate(this,c)}.bind(this));if(this.options.transition===false)this.options.transition=S2.FX.Transitions.linear;this.options.transition=Object.propertize(this.options.transition,S2.FX.Transitions)},play:function(a){this.setOptions(a);this.frameCount=0;this.options.queue.add(this);
this.maxFrames=this.options.fps*this.duration/1E3;return this},render:function(a){if(a>=this.startsAt){if(this.state=="idle"){this.options.before&&this.options.before(this);this.setup&&this.setup();this.state="running";this.update(this.options.transition(0));this.frameCount++;return this}if(a>=this.endsAt&&this.state!="finished"){this.update(this.options.transition(1));this.teardown&&this.teardown();this.options.after&&this.options.after(this);this.state="finished"}else if(this.state=="running"){a=
1-(this.endsAt-a)/this.duration;if((this.maxFrames*a).floor()>this.frameCount){this.update(this.options.transition(a));this.frameCount++}}}return this},cancel:function(a){if(!this.state!="running"){this.teardown&&this.teardown();a&&this.options.after&&this.options.after(this);this.state="finished"}},finish:function(){if(!this.state!="running"){this.update(this.options.transition(1));this.cancel(true)}},inspect:function(){return"#<S2.FX:"+[this.state,this.startsAt,this.endsAt].inspect()+">"}});
S2.FX.Element=Class.create(S2.FX.Base,{initialize:function($super,b,c){if(!(this.element=$(b)))throw S2.FX.elementDoesNotExistError;this.operators=[];return $super(c)},animate:function(){var a=$A(arguments),b=a.shift();b=b.charAt(0).toUpperCase()+b.substring(1);this.operators.push(new S2.FX.Operators[b](this,a[0],a[1]||{}))},play:function($super,b,c){if(b)this.element=$(b);return $super(c)},update:function(a){this.operators.invoke("render",a)}});
S2.FX.Heartbeat=Class.create({initialize:function(a){this.options=Object.extend({framerate:Prototype.Browser.MobileSafari?20:60},a);this.beat=this.beat.bind(this)},start:function(){if(!this.heartbeatInterval){this.heartbeatInterval=setInterval(this.beat,1E3/this.options.framerate);this.updateTimestamp()}},stop:function(){if(this.heartbeatInterval){clearInterval(this.heartbeatInterval);this.timestamp=this.heartbeatInterval=null}},beat:function(){this.updateTimestamp();document.fire("effect:heartbeat")},
getTimestamp:function(){return this.timestamp||this.generateTimestamp()},generateTimestamp:function(){return(new Date).getTime()},updateTimestamp:function(){this.timestamp=this.generateTimestamp()}});
S2.FX.Queue=function(){return function(){function a(c){b=b.without(c);delete c;document.fire("effect:dequeued",this);return this}var b=[];Object.extend(this,{getEffects:function(){return b},active:function(){return b.length>0},add:function(c){var d=c.options.position||"parallel",e=S2.FX.getHeartbeat().getTimestamp();if(d=="end")e=b.without(c).pluck("endsAt").max()||e;c.startsAt=e+(c.options.delay||0)*1E3;c.endsAt=c.startsAt+(c.options.duration||1)*1E3;b.push(c);document.fire("effect:queued",this);
return this},remove:a,render:function(c){b.invoke("render",c);b.select(function(d){return d.state=="finished"}).each(a);return this}})}}();S2.FX.Attribute=Class.create(S2.FX.Base,{initialize:function($super,b,c,d,e,f){b=Object.isString(b)?$(b):b;this.method=Object.isFunction(f)?f.bind(b):Object.isFunction(b[f])?b[f].bind(b):function(g){b[f]=g};this.to=d;this.from=c;return $super(e)},update:function(a){this.method(this.from.tween(this.to,a))}});
S2.FX.Style=Class.create(S2.FX.Element,{setup:function(){this.animate("style",this.element,{style:this.options.style})}});S2.FX.Operators={};
S2.FX.Operators.Base=Class.create({initialize:function(a,b,c){this.effect=a;this.object=b;this.options=Object.extend({transition:Prototype.K},c)},inspect:function(){return"#<S2.FX.Operators.Base:"+this.lastValue+">"},setup:function(){},valueAt:function(){},applyValue:function(){},render:function(a){a=this.valueAt(this.options.transition(a));this.applyValue(a);this.lastValue=a}});
S2.FX.Operators.Style=Class.create(S2.FX.Operators.Base,{initialize:function($super,b,c,d){$super(b,c,d);this.element=$(this.object);this.style=Object.isString(this.options.style)?S2.CSS.parseStyle(this.options.style):this.options.style;this.tweens=[];for(var e in this.style){b=e.underscore().dasherize();c=this.element.getStyle(b);d=this.style[e];if(c!=d)this.tweens.push([b,S2.CSS.interpolate.curry(b,c,d),e in this.options.propertyTransitions?Object.propertize(this.options.propertyTransitions[e],
S2.FX.Transitions):Prototype.K])}},valueAt:function(a){return this.tweens.map(function(b){return b[0]+":"+b[1](b[2](a))}).join(";")},applyValue:function(a){if(this.currentStyle!=a){this.element.setStyle(a);this.currentStyle=a}}});
S2.FX.Morph=Class.create(S2.FX.Element,{setup:function(){if(this.options.change)this.setupWrappers();else if(this.options.style)this.animate("style",this.destinationElement||this.element,{style:this.options.style,propertyTransitions:this.options.propertyTransitions||{}})},teardown:function(){this.options.change&&this.teardownWrappers()},setupWrappers:function(){var a=this.element.getStyle("float"),b,c,d,e;this.transitionElement=(new Element("div")).setStyle({position:"relative",overflow:"hidden",
"float":a});this.element.setStyle({"float":"none"}).insert({before:this.transitionElement});this.sourceElementWrapper=this.element.cloneWithoutIDs().wrap("div");this.destinationElementWrapper=this.element.wrap("div");this.transitionElement.insert(this.sourceElementWrapper).insert(this.destinationElementWrapper);a=this.sourceElementWrapper.getHeight();b=this.sourceElementWrapper.getWidth();this.options.change();c=this.destinationElementWrapper.getHeight();d=this.destinationElementWrapper.getWidth();
this.outerWrapper=new Element("div");this.transitionElement.insert({before:this.outerWrapper});this.outerWrapper.setStyle({overflow:"hidden",height:a+"px",width:b+"px"}).appendChild(this.transitionElement);e=Math.max(c,a);maxWidth=Math.max(d,b);this.transitionElement.setStyle({height:a+"px",width:b+"px"});this.sourceElementWrapper.setStyle({position:"absolute",height:e+"px",width:maxWidth+"px",top:0,left:0});this.destinationElementWrapper.setStyle({position:"absolute",height:e+"px",width:maxWidth+
"px",top:0,left:0,opacity:0,zIndex:2E3});this.outerWrapper.insert({before:this.transitionElement}).remove();this.animate("style",this.transitionElement,{style:"height:"+c+"px; width:"+d+"px"});this.animate("style",this.destinationElementWrapper,{style:"opacity: 1.0"})},teardownWrappers:function(){var a=this.destinationElementWrapper.down();a&&this.transitionElement.insert({before:a});this.transitionElement.remove()}});
S2.FX.Parallel=Class.create(S2.FX.Base,{initialize:function($super,b,c){this.effects=b||[];return $super(c||{})},setup:function(){this.effects.invoke("setup")},update:function(a){this.effects.invoke("update",a)}});S2.FX.Operators.Scroll=Class.create(S2.FX.Operators.Base,{initialize:function($super,b,c,d){$super(b,c,d);this.start=c.scrollTop;this.end=this.options.scrollTo},valueAt:function(a){return this.start+(this.end-this.start)*a},applyValue:function(a){this.object.scrollTop=a.round()}});
S2.FX.Scroll=Class.create(S2.FX.Element,{setup:function(){this.animate("scroll",this.element,{scrollTo:this.options.to})}});
S2.FX.SlideDown=Class.create(S2.FX.Element,{setup:function(){var a=this.destinationElement||this.element,b=a.getLayout();b={height:b.get("height")+"px",paddingTop:b.get("padding-top")+"px",paddingBottom:b.get("padding-bottom")+"px"};a.setStyle({height:"0",paddingTop:"0",paddingBottom:"0",overflow:"hidden"}).show();this.animate("style",a,{style:b,propertyTransitions:{}})},teardown:function(){(this.destinationElement||this.element).setStyle({height:"",paddingTop:"",paddingBottom:"",overflow:"visible"})}});
S2.FX.SlideUp=Class.create(S2.FX.Morph,{setup:function(){var a=this.destinationElement||this.element;a.getLayout();a.setStyle({overflow:"hidden"});this.animate("style",a,{style:{height:"0px",paddingTop:"0px",paddingBottom:"0px"},propertyTransitions:{}})},teardown:function(){(this.destinationElement||this.element).setStyle({height:"",paddingTop:"",paddingBottom:"",overflow:"visible"}).hide()}});
S2.FX.Transitions={linear:Prototype.K,sinusoidal:function(a){return-Math.cos(a*Math.PI)/2+0.5},reverse:function(a){return 1-a},mirror:function(a,b){b=b||S2.FX.Transitions.sinusoidal;return a<0.5?b(a*2):b(1-(a-0.5)*2)},flicker:function(a){a+=(Math.random()-0.5)/5;return S2.FX.Transitions.sinusoidal(a<0?0:a>1?1:a)},wobble:function(a){return-Math.cos(a*Math.PI*9*a)/2+0.5},pulse:function(a,b){return-Math.cos(a*((b||5)-0.5)*2*Math.PI)/2+0.5},blink:function(a,b){return Math.round(a*(b||5))%2},spring:function(a){return 1-
Math.cos(a*4.5*Math.PI)*Math.exp(-a*6)},none:Prototype.K.curry(0),full:Prototype.K.curry(1)};
(function(){function a(b,c,d,e,f,g){function h(v,A){var l,o,q,w;q=v;for(o=0;o<8;o++){w=((i*q+j)*q+m)*q-v;if((w>=0?w:0-w)<A)return q;l=(3*i*q+2*j)*q+m;if((l>=0?l:0-l)<1.0E-6)break;q-=w/l}l=0;o=1;q=v;if(q<l)return l;if(q>o)return o;for(;l<o;){w=((i*q+j)*q+m)*q;if((w-v>=0?w-v:0-(w-v))<A)break;if(v>w)l=q;else o=q;q=(o-l)*0.5+l}return q}var i=0,j=0,m=0,r=0,s=0,n=0;m=3*c;j=3*(e-c)-m;i=1-m-j;n=3*d;s=3*(f-d)-n;r=1-n-s;return function(v,A){var l=h(v,A);return((r*l+s)*l+n)*l}(b,1/(200*g))}S2.FX.cubicBezierTransition=
function(b,c,d,e){return function(f){return a(f,b,c,d,e,1)}}})();S2.FX.Transitions.webkitCubic=S2.FX.cubicBezierTransition(0.25,0.1,0.25,1);S2.FX.Transitions.webkitEaseInOut=S2.FX.cubicBezierTransition(0.42,0,0.58,1);
Object.extend(S2.FX.Transitions,{easeInQuad:function(a){return Math.pow(a,2)},easeOutQuad:function(a){return-(Math.pow(a-1,2)-1)},easeInOutQuad:function(a){if((a/=0.5)<1)return 0.5*Math.pow(a,2);return-0.5*((a-=2)*a-2)},easeInCubic:function(a){return Math.pow(a,3)},easeOutCubic:function(a){return Math.pow(a-1,3)+1},easeInOutCubic:function(a){if((a/=0.5)<1)return 0.5*Math.pow(a,3);return 0.5*(Math.pow(a-2,3)+2)},easeInQuart:function(a){return Math.pow(a,4)},easeOutQuart:function(a){return-(Math.pow(a-
1,4)-1)},easeInOutQuart:function(a){if((a/=0.5)<1)return 0.5*Math.pow(a,4);return-0.5*((a-=2)*Math.pow(a,3)-2)},easeInQuint:function(a){return Math.pow(a,5)},easeOutQuint:function(a){return Math.pow(a-1,5)+1},easeInOutQuint:function(a){if((a/=0.5)<1)return 0.5*Math.pow(a,5);return 0.5*(Math.pow(a-2,5)+2)},easeInSine:function(a){return-Math.cos(a*(Math.PI/2))+1},easeOutSine:function(a){return Math.sin(a*(Math.PI/2))},easeInOutSine:function(a){return-0.5*(Math.cos(Math.PI*a)-1)},easeInExpo:function(a){return a==
0?0:Math.pow(2,10*(a-1))},easeOutExpo:function(a){return a==1?1:-Math.pow(2,-10*a)+1},easeInOutExpo:function(a){if(a==0)return 0;if(a==1)return 1;if((a/=0.5)<1)return 0.5*Math.pow(2,10*(a-1));return 0.5*(-Math.pow(2,-10*--a)+2)},easeInCirc:function(a){return-(Math.sqrt(1-a*a)-1)},easeOutCirc:function(a){return Math.sqrt(1-Math.pow(a-1,2))},easeInOutCirc:function(a){if((a/=0.5)<1)return-0.5*(Math.sqrt(1-a*a)-1);return 0.5*(Math.sqrt(1-(a-=2)*a)+1)},easeOutBounce:function(a){return a<1/2.75?7.5625*
a*a:a<2/2.75?7.5625*(a-=1.5/2.75)*a+0.75:a<2.5/2.75?7.5625*(a-=2.25/2.75)*a+0.9375:7.5625*(a-=2.625/2.75)*a+0.984375},easeInBack:function(a){return a*a*(2.70158*a-1.70158)},easeOutBack:function(a){return(a-=1)*a*(2.70158*a+1.70158)+1},easeInOutBack:function(a){var b=1.70158;if((a/=0.5)<1)return 0.5*a*a*(((b*=1.525)+1)*a-b);return 0.5*((a-=2)*a*(((b*=1.525)+1)*a+b)+2)},elastic:function(a){return-1*Math.pow(4,-8*a)*Math.sin((a*6-1)*2*Math.PI/2)+1},swingFromTo:function(a){var b=1.70158;return(a/=0.5)<
1?0.5*a*a*(((b*=1.525)+1)*a-b):0.5*((a-=2)*a*(((b*=1.525)+1)*a+b)+2)},swingFrom:function(a){return a*a*(2.70158*a-1.70158)},swingTo:function(a){return(a-=1)*a*(2.70158*a+1.70158)+1},bounce:function(a){return a<1/2.75?7.5625*a*a:a<2/2.75?7.5625*(a-=1.5/2.75)*a+0.75:a<2.5/2.75?7.5625*(a-=2.25/2.75)*a+0.9375:7.5625*(a-=2.625/2.75)*a+0.984375},bouncePast:function(a){return a<1/2.75?7.5625*a*a:a<2/2.75?2-(7.5625*(a-=1.5/2.75)*a+0.75):a<2.5/2.75?2-(7.5625*(a-=2.25/2.75)*a+0.9375):2-(7.5625*(a-=2.625/2.75)*
a+0.984375)},easeFromTo:function(a){if((a/=0.5)<1)return 0.5*Math.pow(a,4);return-0.5*((a-=2)*Math.pow(a,3)-2)},easeFrom:function(a){return Math.pow(a,4)},easeTo:function(a){return Math.pow(a,0.25)}});Prototype.BrowserFeatures.WebkitCSSTransitions=false;S2.Extensions.webkitCSSTransitions=false;
(function(){try{document.createEvent("WebKitTransitionEvent")}catch(a){return}Prototype.BrowserFeatures.WebkitCSSTransitions=true;S2.Extensions.webkitCSSTransitions=true;if(Prototype.BrowserFeatures.WebkitCSSTransitions){$w("webkitBorderTopLeftRadius webkitBorderTopRightRadius webkitBorderBottomLeftRadius webkitBorderBottomRightRadius webkitBackgroundSize").each(function(b){S2.CSS.PROPERTIES.push(b)});S2.CSS.NUMERIC_PROPERTIES=S2.CSS.PROPERTIES.findAll(function(b){return!b.endsWith("olor")});S2.FX.Operators.WebkitCssTransition=
Class.create(S2.FX.Operators.Base,{initialize:function($super,c,d,e){$super(c,d,e);this.element=$(this.object);if(Object.isString(this.options.style))if(this.options.style.include(":"))this.style=$H(S2.CSS.parseStyle(this.options.style));else{this.element.addClassName(e.style);this.style=$H(this.element.getStyles());this.element.removeClassName(e.style);var f=this.element.getStyles();this.style=this.style.reject(function(g){return g.value==f[g.key]})}else this.style=$H(this.options.style);this.properties=
[];this.targetStyle="";this.style.each(function(g){var h=g[0].underscore().dasherize();g=g[1];this.element.getStyle(h);if(h.startsWith("webkit"))h="-"+h;this.properties.push(h);this.targetStyle+=";"+h+":"+g},this)},render:function(){this.element.style.webkitTransitionProperty=this.properties.join(",");this.element.style.webkitTransitionDuration=(this.effect.duration/1E3).toFixed(3)+"s";for(t in S2.FX.Operators.WebkitCssTransition.TIMING_MAP)if(S2.FX.Transitions[t]===this.effect.options.transition)this.element.style.webkitTransitionTimingFunction=
S2.FX.Operators.WebkitCssTransition.TIMING_MAP[t];this.element.setStyle(this.targetStyle);this.render=Prototype.emptyFunction}});S2.FX.Operators.WebkitCssTransition.TIMING_MAP={linear:"linear",sinusoidal:"ease-in-out"};timingFunctionForTransition=function(b){var c=null;for(t in S2.FX.Operators.WebkitCssTransition.TIMING_MAP)if(S2.FX.Transitions[t]===b)c=S2.FX.Operators.WebkitCssTransition.TIMING_MAP[t];return c};isWebkitCSSTransitionCompatible=function(b){return S2.Extensions.webkitCSSTransitions&&
(b.options.engine||"")!="javascript"&&timingFunctionForTransition(b.options.transition)&&!b.options.propertyTransitions};S2.FX.Morph=Class.create(S2.FX.Morph,{setup:function(){if(this.options.change)this.setupWrappers();else if(this.options.style){this.engine=isWebkitCSSTransitionCompatible(this)?"webkit":"javascript";this.animate(this.engine=="webkit"?"webkitCssTransition":"style",this.destinationElement||this.element,{style:this.options.style,propertyTransitions:this.options.propertyTransitions||
{}})}},render:function($super,c){if(this.engine=="webkit"){if(this.options.before)this.element.beforeStartEffect=this.options.before;if(this.options.after){this.element.afterFinishEffect=this.options.after;delete this.options.after}this.element._effect=this}return $super(c)}});Element.addMethods({morph:function(b,c,d){if(Object.isNumber(d))d={duration:d};return b.effect("morph",Object.extend(d,{style:c}))}.optionize()});S2.FX.webkitTransitionStartEvent=document.observe("webkitTransitionStart",function(b){if((b=
b.element())&&b.beforeStartEffect){b.beforeStartEffect();b.beforeStartEffect=null}});S2.FX.webkitTransitionEndEvent=document.observe("webkitTransitionEnd",function(b){var c=b.element();if(c){(function(){c.style.webkitTransitionDuration=""}).defer();if(c.afterFinishEffect){c.afterFinishEffect();c.afterFinishEffect=null}}})}})();
(function(){function a(e,f){if(Object.isElement(e)){element=e;e=element.getStyle(f)}if(e===null)return null;if(/^\d+(px)?$/i.test(e))return window.parseInt(e,10);if(/\d/.test(e)&&element.runtimeStyle){var g=element.style.left,h=element.runtimeStyle.left;element.runtimeStyle.left=element.currentStyle.left;element.style.left=e||0;e=element.style.pixelLeft;element.style.left=g;element.runtimeStyle.left=h;return e}if(e.include("%")){h=(h=e.match(/^(\d+)%?$/i))?Number(h[1])/100:null;if(f.include("left")||
f.include("right")||f.include("width"))g=$(element.parentNode).measure("width");else if(f.include("top")||f.include("bottom")||f.include("height"))g=$(element.parentNode).measure("height");return g*h}return 0}function b(e){var f=e.getLayout(),g=0,h=0;do{g+=e.offsetTop||0;h+=e.offsetLeft||0;if(e=e.offsetParent){if($w("BODY HTML").include(e.nodeName.toUpperCase()))break;if(Element.getStyle(e,"position")!=="static")break}}while(e);h-=f.get("margin-top");g-=f.get("margin-left");return new Element.Offset(h,
g)}function c(e){var f=0,g=0,h=e;do{f+=h.offsetTop||0;g+=h.offsetLeft||0;if(h.offsetParent==document.body&&Element.getStyle(h,"position")=="absolute")break}while(h=h.offsetParent);h=e;e=h.tagName;var i=Prototype.Browser.Opera;do if(!i||e&&e.toUpperCase()==="BODY"){f-=h.scrollTop||0;g-=h.scrollLeft||0}while(h=h.parentNode);return new Element.Offset(g,f)}var d=Prototype.K;if("currentStyle"in document.documentElement)d=function(e){if(!e.currentStyle.hasLayout)e.style.zoom=1;return e};Element.Layout=
Class.create(Hash,{initialize:function($super,f,g){$super();this.element=$(f);if(g){this._preComputing=true;this._begin()}Element.Layout.PROPERTIES.each(function(h){g?this._compute(h):this._set(h,null)},this);if(g){this._end();this._preComputing=false}},_set:function(e,f){return Hash.prototype.set.call(this,e,f)},set:function(){throw"Properties of Element.Layout are read-only.";},get:function($super,f){var g=$super(f);return g===null?this._compute(f):g},_begin:function(){if(!this._prepared){var e=
this.element,f;a:{for(f=e;f&&f.parentNode;){if(f.getStyle("display")==="none"){f=false;break a}f=$(f.parentNode)}f=true}if(!f){e.store("prototype_original_styles",{position:e.style.position||"",width:e.style.width||"",visibility:e.style.visibility||"",display:e.style.display||""});f=e.getStyle("position");var g=e.getStyle("width");e.setStyle({position:"absolute",visibility:"hidden",display:"block"});var h=e.getStyle("width");f=g&&h===g?window.parseInt(g,10):g&&(f==="absolute"||f==="fixed")?window.parseInt(g,
10):$(e.parentNode).getLayout().get("width")-this.get("margin-left")-this.get("border-left")-this.get("padding-left")-this.get("padding-right")-this.get("border-right")-this.get("margin-right");e.setStyle({width:f+"px"})}this._prepared=true}},_end:function(){var e=this.element,f=e.retrieve("prototype_original_styles");e.store("prototype_original_styles",null);e.setStyle(f);this._prepared=false},_compute:function(e){var f=Element.Layout.COMPUTATIONS;if(!(e in f))throw"Property not found.";f=f[e].call(this,
this.element);this._set(e,f);return f}});Object.extend(Element.Layout,{PROPERTIES:$w("height width top left right bottom border-left border-right border-top border-bottom padding-left padding-right padding-top padding-bottom margin-top margin-bottom margin-left margin-right padding-box-width padding-box-height border-box-width border-box-height margin-box-width margin-box-height"),COMPOSITE_PROPERTIES:$w("padding-box-width padding-box-height margin-box-width margin-box-height border-box-width border-box-height"),
COMPUTATIONS:{height:function(){this._preComputing||this._begin();var e=this.get("border-box-height");if(e<=0)return 0;var f=this.get("border-top"),g=this.get("border-bottom"),h=this.get("padding-top"),i=this.get("padding-bottom");this._preComputing||this._end();return e-f-g-h-i},width:function(){this._preComputing||this._begin();var e=this.get("border-box-width");if(e<=0)return 0;var f=this.get("border-left"),g=this.get("border-right"),h=this.get("padding-left"),i=this.get("padding-right");this._preComputing||
this._end();return e-f-g-h-i},"padding-box-height":function(){var e=this.get("height"),f=this.get("padding-top"),g=this.get("padding-bottom");return e+f+g},"padding-box-width":function(){var e=this.get("width"),f=this.get("padding-left"),g=this.get("padding-right");return e+f+g},"border-box-height":function(e){return e.offsetHeight},"border-box-width":function(e){return e.offsetWidth},"margin-box-height":function(){var e=this.get("border-box-height"),f=this.get("margin-top"),g=this.get("margin-bottom");
if(e<=0)return 0;return e+f+g},"margin-box-width":function(){var e=this.get("border-box-width"),f=this.get("margin-left"),g=this.get("margin-right");if(e<=0)return 0;return e+f+g},top:function(e){return e.positionedOffset().top},bottom:function(e){var f=e.positionedOffset();e=e.getOffsetParent().measure("height");var g=this.get("border-box-height");return e-g-f.top},left:function(e){return e.positionedOffset().left},right:function(e){var f=e.positionedOffset();e=e.getOffsetParent().measure("width");
var g=this.get("border-box-width");return e-g-f.left},"padding-top":function(e){return a(e,"paddingTop")},"padding-bottom":function(e){return a(e,"paddingBottom")},"padding-left":function(e){return a(e,"paddingLeft")},"padding-right":function(e){return a(e,"paddingRight")},"border-top":function(e){return Object.isNumber(e.clientTop)?e.clientTop:a(e,"borderTopWidth")},"border-bottom":function(e){return Object.isNumber(e.clientBottom)?e.clientBottom:a(e,"borderBottomWidth")},"border-left":function(e){return Object.isNumber(e.clientLeft)?
e.clientLeft:a(e,"borderLeftWidth")},"border-right":function(e){return Object.isNumber(e.clientRight)?e.clientRight:a(e,"borderRightWidth")},"margin-top":function(e){return a(e,"marginTop")},"margin-bottom":function(e){return a(e,"marginBottom")},"margin-left":function(e){return a(e,"marginLeft")},"margin-right":function(e){return a(e,"marginRight")}}});"getBoundingClientRect"in document.documentElement&&Object.extend(Element.Layout.COMPUTATIONS,{right:function(e){var f=d(e.getOffsetParent());e=e.getBoundingClientRect();
return(f.getBoundingClientRect().right-e.right).round()},bottom:function(e){var f=d(e.getOffsetParent());e=e.getBoundingClientRect();return(f.getBoundingClientRect().bottom-e.bottom).round()}});Element.Offset=Class.create({initialize:function(e,f){this.left=e.round();this.top=f.round();this[0]=this.left;this[1]=this.top},relativeTo:function(e){return new Element.Offset(this.left-e.left,this.top-e.top)},inspect:function(){return"#<Element.Offset left: #{left} top: #{top}>".interpolate(this)},toString:function(){return"[#{left}, #{top}]".interpolate(this)},
toArray:function(){return[this.left,this.top]}});Element.addMethods({getLayout:function(e){return new Element.Layout(e)},measure:function(e,f){return $(e).getLayout().get(f)},cumulativeOffset:function(e){var f=0,g=0;do{f+=e.offsetTop||0;g+=e.offsetLeft||0;e=e.offsetParent}while(e);return new Element.Offset(g,f)},positionedOffset:b,cumulativeScrollOffset:function(e){var f=0,g=0;do{f+=e.scrollTop||0;g+=e.scrollLeft||0;e=e.parentNode}while(e);return new Element.Offset(g,f)},viewportOffset:c});"getBoundingClientRect"in
document.documentElement&&Element.addMethods({viewportOffset:function(e){e=$(e);e=e.getBoundingClientRect();return new Element.Offset(e.left,e.top)},cumulativeOffset:function(e){e=$(e);var f=$(document.documentElement).viewportOffset();return e.viewportOffset().relativeTo(f)},positionedOffset:function(e){e=$(e);var f=e.getOffsetParent();if(f.nodeName.toUpperCase()==="HTML")return b(e);var g=e.viewportOffset();f=$w("BODY HTML").include(f.nodeName.toUpperCase())?c(f):f.viewportOffset();g=g.relativeTo(f);
f=e.getLayout();e=g.top-f.get("margin-top");g=g.left-f.get("margin-left");return new Element.Offset(g,e)}})})();S2.UI={};Object.deepExtend=function(a,b){for(var c in b)if(b[c]&&b[c].constructor&&b[c].constructor===Object){a[c]=a[c]||{};arguments.callee(a[c],b[c])}else a[c]=b[c];return a};S2.UI.Mixin={};
S2.UI.Mixin.Configurable={setOptions:function(a){if(!this.options){this.options={};var b=this.constructor;if(b.superclass){for(var c=[],d=b;d=d.superclass;)c.push(d);c=c.reverse();d=0;for(var e=c.length;d<e;d++)Object.deepExtend(this.options,c[d].DEFAULT_OPTIONS||{})}Object.deepExtend(this.options,b.DEFAULT_OPTIONS||{})}return Object.deepExtend(this.options,a||{})}};
S2.UI.Mixin.Trackable={register:function(){var a=this.constructor;if(!a.instances)a.instances=[];a.instances.include(this)||a.instances.push(this);Object.isFunction(a.onRegister)&&a.onRegister.call(a,this)},unregister:function(){var a=this.constructor;a.instances=a.instances.without(this);Object.isFunction(a.onRegister)&&a.onUnregister.call(a,this)}};
S2.UI.Mixin.Shim={__SHIM_TEMPLATE:new Template("<iframe frameborder='0' tabindex='-1' src='javascript:false;' style='display:block;position:absolute;z-index:-1;overflow:hidden; filter:Alpha(Opacity=\"0\");top:expression(((parseInt(this.parentNode.currentStyle.borderTopWidth)||0)*-1)+'px');left:expression(((parseInt(this.parentNode.currentStyle.borderLeftWidth)||0)*-1)+'px');width:expression(this.parentNode.offsetWidth+'px');height:expression(this.parentNode.offsetHeight+'px');' id='#{0}'></iframe>"),createShim:function(a){if(this.__shim_isie6=
Prototype.Browser.IE&&/6.0/.test(navigator.userAgent))if(a=$(a||this.element)){this.__shimmed=a;var b=a.identify()+"_iframeshim",c=$(b);c&&c.remove();a.insert({top:this.__SHIM_TEMPLATE.evaluate([b])});this.__shim_id=b}},adjustShim:function(){if(this.__shim_isie6){var a=this.__shimmed.down("iframe#"+this.__shim_id),b=this.__shimmed;a&&a.setStyle({width:b.offsetWidth+"px",height:b.offsetHeight+"px"})}},destroyShim:function(){if(this.__shim_isie6){var a=this.__shimmed.down("iframe#"+this.__shim_id);
a&&a.remove();this.__shimmed=null}}};
Object.extend(S2.UI,{addClassNames:function(a,b){if(Object.isElement(a))a=[a];if(Object.isString(b))b=b.split(" ");for(var c,d,e=0,f;f=a[e];e++)for(c=0;d=b[c];c++)f.addClassName(d);return a},removeClassNames:function(a,b){if(Object.isElement(a))a=[a];if(Object.isString(b))b=b.split(" ");for(var c,d,e=0,f;f=a[e];e++)for(c=0;d=b[c];c++)f.removeClassName(d)},FOCUSABLE_ELEMENTS:$w("input select textarea button object"),isFocusable:function(a){var b=a.nodeName.toLowerCase(),c=a.readAttribute("tabIndex"),
d=false;d=S2.UI.FOCUSABLE_ELEMENTS.include(b)?!a.disabled:$w("a area").include(b)?a.href||c&&!isNaN(c):c&&!isNaN(c);return!!d&&S2.UI.isVisible(a)},findFocusables:function(a){return $(a).descendants().select(S2.UI.isFocusable)},isVisible:function(a){for(a=$(a);a&&a.parentNode;){var b=a.getStyle("display"),c=a.getStyle("visibility");if(b==="none"||c==="hidden")return false;a=$(a.parentNode)}return true},makeVisible:function(a,b){if(Object.isElement(a))a=[a];for(var c=b?"visible":"hidden",d=0,e;e=a[d];d++)e.setStyle({visibility:c});
return a},modifierUsed:function(a){return a.metaKey||a.ctrlKey||a.altKey}});
(function(){function a(c){var d=Event.element(c);if(d)for(var e=0,f;f=b[e];e++)if(d===f||d.descendantOf(f)){Event.stop(c);break}}var b=[];if(document.attachEvent)document.onselectstart=a.bindAsEventListener(window);else document.observe("mousedown",a);Object.extend(S2.UI,{enableTextSelection:function(c){c.setStyle({"-moz-user-select":"","-webkit-user-select":""});b=b.without(c);return c},disableTextSelection:function(c){c.setStyle({"-moz-user-select":"none","-webkit-user-select":"none"});b.include(c)||
b.push(c);return c}})})();
S2.UI.Behavior=Class.create(S2.UI.Mixin.Configurable,{initialize:function(a,b){this.element=a;this.setOptions(b);Object.extend(this,b);this._observers={};var c,d,e;for(e in this)if(e.startsWith("on")||e.include("/on")){c=e.split("/");a=c.length===2?this[c.first()]||this.element:this.element;c=c.last();d=this._observers[c]=this[e].bind(this);a.observe(c.substring(2),d)}},destroy:function(){var a=this.options.proxy||this.element,b,c;for(c in this._observers){b=this._observers[c];a.stopObserving(c.substring(2),
b)}}});
Object.extend(S2.UI,{addBehavior:function(a,b,c){var d=arguments.callee;if(Object.isArray(a))a.each(function(f){d(f,b,c)});else if(Object.isArray(b))b.each(function(f){d(a,f,c)});else{var e=new b(a,c||{});$(a).retrieve("ui.behaviors",[]).push(e)}},removeBehavior:function(a,b){var c=arguments.callee;if(Object.isArray(a))a.each(function(h){c(h,b)});else if(Object.isArray(b))b.each(function(h){c(a,h)});else{for(var d=$(a).retrieve("ui.behaviors",[]),e=[],f=0,g;g=d[f];f++)if(!(!g instanceof b)){g.destroy();e.push(g)}$(a).set("ui.behaviors",
d.without(e))}},getBehavior:function(a,b){a=$(a);for(var c=a.retrieve("ui.behaviors",[]),d=0,e=c.length,f;d<e;d++){f=c[d];if(f.constructor===b)return f}return null}});
S2.UI.Behavior.Drag=Class.create(S2.UI.Behavior,{initialize:function($super,b,c){this.__onmousemove=this._onmousemove.bind(this);$super(b,c);this.element.addClassName("ui-draggable")},destroy:function($super){this.element.removeClassName("ui-draggable");$super()},"handle/onmousedown":function(a){var b=this.element;this._startPointer=a.pointer();this._startPosition={left:window.parseInt(b.getStyle("left"),10),top:window.parseInt(b.getStyle("top"),10)};document.observe("mousemove",this.__onmousemove)},
"handle/onmouseup":function(){this._startPosition=this._startPointer=null;document.stopObserving("mousemove",this.__onmousemove)},_onmousemove:function(a){a=a.pointer();if(this._startPointer){a={x:a.x-this._startPointer.x,y:a.y-this._startPointer.y};this.element.setStyle({left:this._startPosition.left+a.x+"px",top:this._startPosition.top+a.y+"px"})}}});
S2.UI.Behavior.Focus=Class.create(S2.UI.Behavior,{onfocus:function(){this.element.hasClassName("ui-state-disabled")||this.element.addClassName("ui-state-focus")},onblur:function(){this.element.hasClassName("ui-state-disabled")||this.element.removeClassName("ui-state-focus")}});
S2.UI.Behavior.Hover=Class.create(S2.UI.Behavior,{onmouseenter:function(){this.element.hasClassName("ui-state-disabled")||this.element.addClassName("ui-state-hover")},onmouseleave:function(){this.element.hasClassName("ui-state-disabled")||this.element.removeClassName("ui-state-hover")}});S2.UI.Behavior.Resize=Class.create(S2.UI.Behavior,{initialize:function(){}});
S2.UI.Behavior.Down=Class.create(S2.UI.Behavior,{onmousedown:function(){this._down=true;this.element.hasClassName("ui-state-disabled")||this.element.addClassName("ui-state-down")},onmouseup:function(){this._down=false;this.element.hasClassName("ui-state-disabled")||this.element.removeClassName("ui-state-down")},onmouseleave:function(a){return this.onmouseup(a)},onmouseenter:function(a){if(this._down)return this.onmousedown(a)}});
(function(a){a.Base=Class.create(a.Mixin.Configurable,{NAME:"S2.UI.Base",addObservers:Function.ABSTRACT,removeObservers:Function.ABSTRACT,destroy:function(){this.removeObservers()},toElement:function(){return this.element},inspect:function(){return"#<#{NAME}>".interpolate(this)}})})(S2.UI);Object.extend(Event,{KEY_SPACE:32});
(function(a){a.Accordion=Class.create(a.Base,{NAME:"S2.UI.Accordion",initialize:function(b,c){this.element=$(b);var d=this.setOptions(c);a.addClassNames(this.element,"ui-accordion ui-widget ui-helper-reset");if(this.element.nodeName.toUpperCase()==="UL"){var e=this.element.childElements().grep(new Selector("li"));a.addClassNames(e,"ui-accordion-li-fix")}this.headers=this.element.select(d.headerSelector);if(!(!this.headers||this.headers.length===0)){a.addClassNames(this.headers,"ui-accordion-header ui-helper-reset ui-state-default ui-corner-all");
a.addBehavior(this.headers,[a.Behavior.Hover,a.Behavior.Focus]);this.content=this.headers.map(function(f){return f.next()});a.addClassNames(this.content,"ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom");this.headers.each(function(f){var g=new Element("span");a.addClassNames(g,"ui-icon "+d.icons.header);f.insert({top:g})});this._markActive(d.active||this.headers.first(),false);this.element.writeAttribute({role:"tablist","aria-multiselectable":d.multiple.toString()});this.headers.invoke("writeAttribute",
"role","tab");this.content.invoke("writeAttribute","role","tabpanel");this.headers.map(function(f){return f.down("a")}).invoke("observe","click",function(f){f.preventDefault()});this.observers={click:this.click.bind(this),keypress:this.keypress.bind(this)};this.addObservers()}},addObservers:function(){this.headers.invoke("observe","click",this.observers.click);Prototype.Browser.WebKit?this.headers.invoke("observe","keydown",this.observers.keypress):this.headers.invoke("observe","keypress",this.observers.keypress)},
click:function(b){(b=b.findElement(this.options.headerSelector))&&this.headers.include(b)&&this._toggleActive(b)},keypress:function(b){if(!(b.shiftKey||b.metaKey||b.altKey||b.ctrlKey)){var c=b.findElement(this.options.headerSelector);switch(b.keyCode===0?b.charCode:b.keyCode){case Event.KEY_SPACE:this._toggleActive(c);b.stop();break;case Event.KEY_DOWN:case Event.KEY_RIGHT:this._focusHeader(c,1);b.stop();break;case Event.KEY_UP:case Event.KEY_LEFT:this._focusHeader(c,-1);b.stop();break;case Event.KEY_HOME:this._focusHeader(this.headers.first());
b.stop();break;case Event.KEY_END:this._focusHeader(this.headers.last());b.stop()}}},_focusHeader:function(b,c){if(Object.isNumber(c)){var d=this.headers.indexOf(b);d+=c;if(d>this.headers.length-1)d=this.headers.length-1;else if(d<0)d=0;b=this.headers[d]}(function(){b.down("a").focus()}).defer()},_toggleActive:function(b){if(b.hasClassName("ui-state-active")){if(this.options.multiple){this._removeActive(b);this._activatePanel(null,b.next(),true)}}else this._markActive(b)},_removeActive:function(b){var c=
this.options;a.removeClassNames(b,"ui-state-active ui-corner-top");a.addClassNames(b,"ui-state-default ui-corner-all");b.writeAttribute("aria-expanded","false");b=b.down(".ui-icon");b.removeClassName(c.icons.headerSelected);b.addClassName(c.icons.header)},_markActive:function(b,c){if(Object.isUndefined(c))c=true;var d=this.options,e=null;if(!d.multiple){e=this.element.down(".ui-accordion-content-active");this.headers.each(this._removeActive.bind(this))}if(b){a.removeClassNames(b,"ui-state-default ui-corner-all");
a.addClassNames(b,"ui-state-active ui-corner-top");b.writeAttribute("aria-expanded","true");this._activatePanel(b.next(),e,c);e=b.down(".ui-icon");e.removeClassName(d.icons.header);e.addClassName(d.icons.headerSelected);return b}},_activatePanel:function(b,c,d){if(d)this.options.transition(b,c);else{c&&c.removeClassName("ui-accordion-content-active");b&&b.addClassName("ui-accordion-content-active")}}});Object.extend(a.Accordion,{DEFAULT_OPTIONS:{multiple:false,headerSelector:"h3",icons:{header:"ui-icon-triangle-1-e",
headerSelected:"ui-icon-triangle-1-s"},transition:function(b,c){var d=[],e;if(c){e=new S2.FX.SlideUp(c,{duration:0.2,after:function(){c.removeClassName("ui-accordion-content-active")}});d.push(e)}if(b){e=new S2.FX.SlideDown(b,{duration:0.2,before:function(){b.addClassName("ui-accordion-content-active")}});d.push(e)}d.invoke("play")}}})})(S2.UI);
(function(a){a.Button=Class.create(a.Base,{NAME:"S2.UI.Button",initialize:function(b,c){this.element=$(b);this.element.store("ui.button",this);var d=this.setOptions(c);a.addClassNames(this.element,"ui-state-default ui-corner-all");a.addBehavior(this.element,[a.Behavior.Hover,a.Behavior.Focus,a.Behavior.Down]);d.primary&&this.element.addClassName("ui-priority-primary");this.element.writeAttribute("role","button");this.enabled=true;this.setEnabled(this.element.disabled===true||!this.element.hasClassName("ui-state-disabled"))},
setEnabled:function(b){if(this.enabled!==b){(this.enabled=b)?this.element.removeClassName("ui-state-disabled"):this.element.addClassName("ui-state-disabled");this.element.disabled=!b}},toElement:function(){return this.element},toHTML:function(){return this.element.toHTML()},toString:function(){return this.element.toHTML()},inspect:function(){return this.element.inspect()}});Object.extend(a.Button,{DEFAULT_OPTIONS:{primary:false}})})(S2.UI);
(function(a){a.Tabs=Class.create(a.Base,{NAME:"S2.UI.Tabs",initialize:function(b,c){this.element=$(b);a.addClassNames(this.element,"ui-widget ui-widget-content ui-tabs ui-corner-all");this.setOptions(c);var d=this.options;this.anchors=[];this.panels=[];this.list=this.element.down("ul");this.list.cleanWhitespace();this.nav=this.list;a.addClassNames(this.nav,"ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all");this.tabs=this.list.select("li");a.addClassNames(this.tabs,"ui-state-default ui-corner-top");
a.addBehavior(this.tabs,[a.Behavior.Hover,a.Behavior.Down]);this.element.writeAttribute({role:"tablist","aria-multiselectable":"false"});this.tabs.each(function(g){var h=g.down("a");if(h){var i=h.readAttribute("href");if(i.include("#")){i=i.split("#").last();i=$(i);g.writeAttribute("tabIndex","0");if(i){i.store("ui.tab",g);g.store("ui.panel",i);this.anchors.push(h);this.panels.push(i)}}}},this);this.anchors.invoke("writeAttribute","role","tab");this.panels.invoke("writeAttribute","role","tabpanel");
this.tabs.first().addClassName("ui-position-first");this.tabs.last().addClassName("ui-position-last");a.addClassNames(this.panels,"ui-tabs-panel ui-tabs-hide ui-widget-content ui-corner-bottom");this.observers={onKeyPress:this.onKeyPress.bind(this),onTabClick:this.onTabClick.bind(this)};this.addObservers();var e=window.location.hash.substring(1),f;e.empty()||(f=$(e));this.setSelectedTab(f&&this.panels.include(f)?f.retrieve("ui.tab"):d.selectedTab?$(d.selectedTab):this.tabs.first())},addObservers:function(){this.anchors.invoke("observe",
"click",this.observers.onTabClick);this.tabs.invoke("observe","keypress",this.observers.onKeyPress)},_setSelected:function(b){b=$(b);var c=b.retrieve("ui.tab"),d=this.list.down(".ui-tabs-selected"),e=d?d.retrieve("ui.panel"):null;a.removeClassNames(this.tabs,"ui-tabs-selected ui-state-active");a.addClassNames(this.tabs,"ui-state-default");c.removeClassName("ui-state-default").addClassName("ui-tabs-selected ui-state-active");this.element.fire("ui:tabs:change",{from:{tab:d,panel:e},to:{tab:c,panel:b}});
this.options.panel.transition(e,b)},setSelectedTab:function(b){this.setSelectedPanel(b.retrieve("ui.panel"))},setSelectedPanel:function(b){this._setSelected(b.readAttribute("id"))},onTabClick:function(b){b.stop();b.findElement("a");this.setSelectedTab(b.findElement("li"))},onKeyPress:function(b){if(!a.modifierUsed(b)){var c=b.findElement("li");switch(b.keyCode||b.charCode){case Event.KEY_SPACE:case Event.KEY_RETURN:this.setSelectedTab(c);b.stop();break;case Event.KEY_UP:case Event.KEY_LEFT:this._focusTab(c,
-1);break;case Event.KEY_DOWN:case Event.KEY_RIGHT:this._focusTab(c,1)}}},_focusTab:function(b,c){if(Object.isNumber(c)){var d=this.tabs.indexOf(b);d+=c;if(d>this.tabs.length-1)d=this.tabs.length-1;else if(d<0)d=0;b=this.tabs[d]}(function(){b.focus()}).defer()}});Object.extend(a.Tabs,{DEFAULT_OPTIONS:{panel:{transition:function(b,c){b&&b.addClassName("ui-tabs-hide");c.removeClassName("ui-tabs-hide")}}}})})(S2.UI);
(function(a){a.Overlay=Class.create(a.Base,a.Mixin.Trackable,a.Mixin.Shim,{NAME:"S2.UI.Overlay",initialize:function(b){this.setOptions(b);this.element=new Element("div",{"class":"ui-widget-overlay"});this.register();this.createShim();this.adjustShim();this.constructor.onResize()},destroy:function(){this.element.remove();this.unregister()},toElement:function(){return this.element}});Object.extend(a.Overlay,{onRegister:function(){if(this.instances.length===1){this._resizeObserver=this._resizeObserver||
this.onResize.bind(this);Event.observe(window,"resize",this._resizeObserver);Event.observe(window,"scroll",this._resizeObserver)}},onUnregister:function(){if(this.instances.length===0){Event.stopObserving(window,"resize",this._resizeObserver);Event.stopObserving(window,"scroll",this._resizeObserver)}},onResize:function(){var b=document.viewport.getDimensions(),c=document.viewport.getScrollOffsets();this.instances.each(function(d){d.element.setStyle({width:b.width+"px",height:b.height+"px",left:c.left+
"px",top:c.top+"px"})});(function(){this.instances.invoke("adjustShim")}).bind(this).defer()}})})(S2.UI);
(function(a){a.Dialog=Class.create(a.Base,{NAME:"S2.UI.Dialog",initialize:function(b,c){if(Object.isElement(b))b=$(b);else{c=b;b=null}var d=this.setOptions(c);this.element=b||new Element("div");a.addClassNames(this.element,"ui-dialog ui-widget ui-widget-content ui-corner-all");this.element.hide().setStyle({position:"absolute",overflow:"hidden",zIndex:d.zIndex,outline:"0"});this.element.writeAttribute({tabIndex:"-1",role:"dialog"});this.content=d.content?Object.isElement(d.content)?d.content:(new Element("div")).update(d.content):
new Element("div");a.addClassNames(this.content,"ui-dialog-content ui-widget-content");this.element.insert(this.content);this.titleBar=this.options.titleBar||new Element("div");a.addClassNames(this.titleBar,"ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix");this.element.insert({top:this.titleBar});this.closeButton=new Element("a",{href:"#"});a.addClassNames(this.closeButton,"ui-dialog-titlebar-close ui-corner-all");new a.Button(this.closeButton);this.closeButton.observe("mousedown",
Event.stop);this.closeButton.observe("click",function(e){e.stop();this.close(false)}.bind(this));this.titleBar.insert(this.closeButton);this.closeText=new Element("span");a.addClassNames(this.closeText,"ui-icon ui-icon-closethick");this.closeButton.insert(this.closeText);this.titleText=new Element("span",{"class":"ui-dialog-title"});this.titleText.update(this.options.title).identify();this.element.writeAttribute("aria-labelledby",this.titleText.readAttribute("id"));this.titleBar.insert({top:this.titleText});
a.disableTextSelection(this.element);this.options.draggable&&a.addBehavior(this.element,a.Behavior.Drag,{handle:this.titleBar});(d=this.options.buttons)&&d.length&&this._createButtons();this.observers={keypress:this.keypress.bind(this)}},toElement:function(){return this.element},_createButtons:function(){var b=this.options.buttons;this.buttonPane&&this.buttonPane.remove();this.buttonPane=new Element("div");a.addClassNames(this.buttonPane,"ui-dialog-buttonpane ui-widget-content ui-helper-clearfix");
b.each(function(c){var d=new Element("button",{type:"button"});a.addClassNames(d,"ui-state-default ui-corner-all");c.primary&&d.addClassName("ui-priority-primary");c.secondary&&d.addClassName("ui-priority-secondary");d.update(c.label);new a.Button(d);d.observe("click",c.action.bind(this,this));this.buttonPane.insert(d)},this);this.element.insert(this.buttonPane)},_position:function(){var b=document.viewport.getDimensions(),c=this.element;c={width:parseInt(c.getStyle("width"),10),height:parseInt(c.getStyle("height"),
10)};b={left:(b.width/2-c.width/2).round(),top:(b.height/2-c.height/2).round()};c=document.viewport.getScrollOffsets();b.left+=c.left;b.top+=c.top;this.element.setStyle({left:b.left+"px",top:b.top+"px"})},open:function(){if(!this._isOpen)if(!this.element.fire("ui:dialog:before:open",{dialog:this}).stopped){var b=this.options;this.overlay=b.modal?new a.Overlay:null;$(document.body).insert(this.overlay);$(document.body).insert(this.element);this.element.show();this._position();this.focusables=a.findFocusables(this.element);
b.submitForms||this.content.select("form").invoke("observe","submit",Event.stop);var c=this.focusables.without(this.closeButton),d=b.focus;b=false;if(d==="first"){c.first().focus();b=true}else if(d==="last"){c.last().focus();b=true}else if(Object.isElement(d)){d.focus();b=true}else if(this.buttonPane)if(d=this.buttonPane.down(".ui-priority-primary")){d.focus();b=true}!b&&c.length>0&&c.first().focus();Event.observe(window,"keydown",this.observers.keypress);this._isOpen=true;this.element.fire("ui:dialog:after:open",
{dialog:this});return this}},close:function(b){b=!!b;if(!this.element.fire("ui:dialog:before:close",{dialog:this}).stopped){this.overlay&&this.overlay.destroy();this.element.hide();this._isOpen=false;Event.stopObserving(window,"keydown",this.observers.keypress);b={dialog:this,success:b};var c=this.content.down("form");c&&Object.extend(b,{form:c.serialize({hash:true})});this.element.fire("ui:dialog:after:close",b);a.enableTextSelection(this.element,true);return this}},keypress:function(b){if(!a.modifierUsed(b)){var c=
this.focusables,d=this.options;if(b.keyCode===Event.KEY_ESC)d.closeOnEscape&&this.close(false);else if(b.keyCode===Event.KEY_RETURN)this.close(true);else if(b.keyCode===Event.KEY_TAB)if(this.options.modal)if(c){var e;d=b.findElement();d=c.indexOf(d);if(e=d===-1?c.first():b.shiftKey?d===0?c.last():c[d-1]:d===c.length-1?c.first():c[d+1]){b.stop();(function(){e.focus()}).defer()}}}}});Object.extend(a.Dialog,{DEFAULT_OPTIONS:{zIndex:1E3,title:"Dialog",content:null,modal:true,focus:"auto",submitForms:false,
closeOnEscape:true,draggable:true,resizable:false,buttons:[{label:"OK",primary:true,action:function(b){b.close(true)}}]}})})(S2.UI);
(function(a){a.Slider=Class.create(a.Base,{NAME:"S2.UI.Slider",initialize:function(b,c){this.element=$(b);var d=this.setOptions(c);a.addClassNames(this.element,"ui-slider ui-widget ui-widget-content ui-corner-all");this.orientation=d.orientation;this.element.addClassName("ui-slider-"+this.orientation);this._computeTrackLength();var e=d.value.initial;Object.isArray(e)||(e=[e]);this.values=e;this.handles=[];this.values.each(function(g,h){var i=new Element("a",{href:"#"});i.store("ui.slider.handle",
h);this.handles.push(i);this.element.insert(i)},this);a.addClassNames(this.handles,"ui-slider-handle ui-state-default ui-corner-all");this.handles.invoke("writeAttribute","tabIndex","0");this.activeHandle=this.handles.first();this.handles.invoke("observe","click",Event.stop);a.addBehavior(this.handles,[a.Behavior.Hover,a.Behavior.Focus]);this.observers={focus:this.focus.bind(this),blur:this.blur.bind(this),keydown:this.keydown.bind(this),keyup:this.keyup.bind(this),mousedown:this.mousedown.bind(this),
mouseup:this.mouseup.bind(this),mousemove:this.mousemove.bind(this),rangeMouseDown:this.rangeMouseDown.bind(this),rangeMouseMove:this.rangeMouseMove.bind(this),rangeMouseUp:this.rangeMouseUp.bind(this)};e=d.value;if(e.step!==null){this._possibleValues=[];for(var f=e.min;f<e.max;f+=e.step)this._possibleValues.push(f);this._possibleValues.push(e.max);this.keyboardStep=e.step}else if(d.possibleValues){this._possibleValues=d.possibleValues.clone();this.keyboardStep=null}else this.keyboardStep=(e.max-
e.min)/100;this.range=null;if(d.range&&this.values.length===2){this.restricted=true;this.range=new Element("div",{"class":"ui-slider-range"});this.element.insert(this.range);this.range.addClassName("ui-widget-header")}this._computeTrackLength();this._computeHandleLength();this.disabled=this.dragging=this.active=false;this.addObservers();this.values.each(this.setValue,this);this.initialized=true},addObservers:function(){this.element.observe("mousedown",this.observers.mousedown);this.range&&this.range.observe("mousedown",
this.observers.rangeMouseDown);this.handles.invoke("observe","keydown",this.observers.keydown);this.handles.invoke("observe","keyup",this.observers.keyup)},_computeTrackLength:function(){var b;if(this.orientation==="vertical"){b=this.element.offsetHeight;b=b!==0?b:window.parseInt(this.element.getStyle("height"),10)}else{b=this.element.offsetWidth;b=b!==0?b:window.parseInt(this.element.getStyle("width"),10)}return this._trackLength=b},_computeHandleLength:function(){var b=this.handles.first(),c;if(b){if(this.orientation===
"vertical"){c=b.offsetHeight;b=c!==0?c:window.parseInt(b.getStyle("height"),10)}else{c=b.offsetWidth;b=c!==0?c:window.parseInt(b.getStyle("width"),10)}return this._handleLength=b}},_nextValue:function(b,c){return this.options.possibleValues?this._possibleValues[this._possibleValues.indexOf(b)+c]:b+this.keyboardStep*c},keydown:function(b){if(!this.options.disabled){var c=b.findElement(),d=c.retrieve("ui.slider.handle"),e=this.options;if(Object.isNumber(d))if([Event.KEY_HOME,Event.KEY_END,Event.KEY_UP,
Event.KEY_DOWN,Event.KEY_LEFT,Event.KEY_RIGHT].include(b.keyCode)){c.addClassName("ui-state-active");var f;c=f=this.values[d];switch(b.keyCode){case Event.KEY_HOME:f=e.value.min;break;case Event.KEY_END:f=e.value.max;break;case Event.KEY_UP:case Event.KEY_RIGHT:if(c===e.value.max)return;f=this._nextValue(c,1);break;case Event.KEY_DOWN:case Event.KEY_LEFT:if(c===e.value.min)return;f=this._nextValue(c,-1)}this.dragging=true;this.setValue(f,d);if(!Prototype.Browser.WebKit){d=this._timer?0.1:1;this._timer=
arguments.callee.bind(this).delay(d,b)}}}},keyup:function(b){this.dragging=false;if(this._timer){window.clearTimeout(this._timer);this._timer=null}this._updateFinished();b.findElement().removeClassName("ui-state-active")},setValue:function(b,c){if(!this.activeHandle){this.activeHandle=this.handles[c||0];this._updateStyles()}c=c||this.activeHandle.retrieve("ui.slider.handle")||0;if(this.initialized&&this.restricted){if(c>0&&b<this.values[c-1])b=this.values[c-1];if(c<this.handles.length-1&&b>this.values[c+
1])b=this.values[c+1]}b=this._getNearestValue(b);this.values[c]=b;var d={};d[this.orientation==="vertical"?"top":"left"]=this._valueToPx(b)+"px";this.handles[c].setStyle(d);this._drawRange();!this.dragging&&!this.undoing&&!this.initialized&&this._updateFinished();if(this.initialized){this.element.fire("ui:slider:value:changing",{slider:this,values:this.values});this.options.onSlide(this.values,this)}return this},_getNearestValue:function(b){var c=this.options.value;if(b<c.min)b=c.min;if(b>c.max)b=
c.max;if(this._possibleValues){var d;for(c=0;c<this._possibleValues.length;c++){d=this._possibleValues[c];if(d===b)return b;if(d>b)break}b=b.nearer(this._possibleValues[c-1],d)}return b},_valueToPx:function(b){var c=this.options.value,d=(this._trackLength-this._handleLength/2)/(c.max-c.min);d*=b-c.min;if(this.orientation==="vertical")d=this._trackLength-d-this._handleLength;return Math.round(d)},mousedown:function(b){var c=this.options;if(!(!b.isLeftClick()||c.disabled)){b.stop();this._oldValues=
this.values.clone();this.active=true;var d=b.findElement();c=b.pointer();if(d===this.element){b=this.element.cumulativeOffset();this.setValue(this._pxToValue({x:Math.round(c.x-b.left+this._handleLength/4),y:Math.round(c.y-b.top+this._handleLength/4)}));handle=this.activeHandle=this.activeHandle||this.handles.first()}else{handle=b.findElement(".ui-slider-handle");if(!handle)return;this.activeHandle=handle}this._updateStyles();b=handle.cumulativeOffset();this._offsets={x:c.x-b.left,y:c.y-b.top};document.observe("mousemove",
this.observers.mousemove);document.observe("mouseup",this.observers.mouseup)}},mouseup:function(b){if(this.active&&this.dragging){this._updateFinished();b.stop()}this.active=this.dragging=false;this.activeHandle=null;this._updateStyles();document.stopObserving("mousemove",this.observers.mousemove);document.stopObserving("mouseup",this.observers.mouseup)},mousemove:function(b){if(this.active){b.stop();this.dragging=true;this._draw(b);Prototype.Browser.WebKit&&window.scrollBy(0,0)}},rangeMouseDown:function(b){b=
b.pointer();var c=this.element.cumulativeOffset();b={x:Math.round(b.x-c.left),y:Math.round(b.y-c.top)};this._rangeInitialValues=this.values.clone();this._rangePseudoValue=this._pxToValue(b);document.observe("mousemove",this.observers.rangeMouseMove);document.observe("mouseup",this.observers.rangeMouseUp)},rangeMouseMove:function(b){this.dragging=true;b.stop();var c=this.options;b=b.pointer();var d=this.element.cumulativeOffset(),e=this._pxToValue({x:Math.round(b.x-d.left),y:Math.round(b.y-d.top)})-
this._rangePseudoValue;b=this._rangeInitialValues.map(function(f){return f+e});if(b[0]<c.value.min){e=c.value.min-this._rangeInitialValues[0];b=this._rangeInitialValues.map(function(f){return f+e})}else if(b[1]>c.value.max){e=c.value.max-this._rangeInitialValues[1];b=this._rangeInitialValues.map(function(f){return f+e})}b.each(this.setValue,this)},rangeMouseUp:function(){this.dragging=false;document.stopObserving("mousemove",this.observers.rangeMouseMove);document.stopObserving("mouseup",this.observers.rangeMouseUp);
this._updateFinished()},_draw:function(b){b=b.pointer();var c=this.element.cumulativeOffset();b.x-=this._offsets.x+c.left;b.y-=this._offsets.y+c.top;this.setValue(this._pxToValue(b))},_pxToValue:function(b){var c=this.options;b=(this.orientation==="horizontal"?b.x:b.y)/(this._trackLength-this._handleLength)*(c.value.max-c.value.min)+c.value.min;if(this.orientation==="vertical")b=c.value.max-(b-c.value.min);return b},undo:function(){if(this._oldValues){this.values=this._oldValues.clone();this.undoing=
true;this._oldValues.each(this.setValue,this);this.undoing=false}},_updateFinished:function(){if(this.element.fire("ui:slider:value:changed",{slider:this,values:this.values}).stopped)this.undo();else{this.activeHandle=null;this._updateStyles();this.options.onChange(this.values,this)}},_updateStyles:function(){a.removeClassNames(this.handles,"ui-state-active");this.activeHandle&&this.activeHandle.addClassName("ui-state-active")},_drawRange:function(){if(this.range){var b=this.values.map(this._valueToPx,
this);this.orientation==="vertical"?this.range.setStyle({top:b[1]+"px",height:b[0]-b[1]+"px"}):this.range.setStyle({left:b[0]+"px",width:b[1]-b[0]+"px"})}},focus:function(b){if(!this.options.disabled){b=b.findElement();this.element.select(".ui-state-focus").invoke("removeClassName","ui-state-focus");b.addClassName("ui-state-focus")}},blur:function(b){b.findElement().removeClassName("ui-state-focus")}});Object.extend(a.Slider,{DEFAULT_OPTIONS:{range:false,disabled:false,value:{min:0,max:100,initial:0,
step:null},possibleValues:null,orientation:"horizontal",onSlide:Prototype.emptyFunction,onChange:Prototype.emptyFunction}})})(S2.UI);
(function(a){a.ProgressBar=Class.create(a.Base,{NAME:"S2.UI.ProgressBar",initialize:function(b,c){this.element=$(b);var d=this.setOptions(c);a.addClassNames(this.element,"ui-progressbar ui-widget ui-widget-content ui-corner-all");this.element.writeAttribute({role:"progressbar","aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":0});this.valueElement=new Element("div",{"class":"ui-progressbar-value ui-widget-header ui-corner-left"});this.value=d.value.initial;this._refreshValue();this.element.insert(this.valueElement);
this.element.store(this.NAME,this)},destroy:function(){a.removeClassNames(this.element,"ui-progressbar ui-widget ui-widget-content ui-corner-all");a.removeAttributes(this.element,"role aria-valuemin aria-valuemax aria-valuenow");this.element.getData().unset(this.NAME)},getValue:function(){var b=this.value,c=this.options.value;if(b<c.min)b=c.min;if(b>c.max)b=c.max;return b},setValue:function(b){this._oldValue=this.getValue();this.value=b;this._refreshValue();return this},undo:function(){this.undoing=
true;this.setValue(this._oldValue);this.undoing=false;return this},_refreshValue:function(){var b=this.getValue();if(!this.undoing)if(this.element.fire("ui:progressbar:value:changed",{progressBar:this,value:b}).stopped){this.undo();return}b===this.options.value.max?this.valueElement.addClassName("ui-corner-right"):this.valueElement.removeClassName("ui-corner-right");var c="width: #{0}px".interpolate([window.parseInt(this.element.getStyle("width"),10)*b/100]);a.makeVisible(this.valueElement,b>this.options.value.min);
this.valueElement.morph(c,{duration:0.7,transition:"linear"});this.element.writeAttribute("aria-valuenow",b)}});Object.extend(a.ProgressBar,{DEFAULT_OPTIONS:{value:{min:0,max:100,initial:0}}})})(S2.UI);
(function(a){a.Menu=Class.create(a.Base,a.Mixin.Shim,{NAME:"S2.UI.Menu",initialize:function(b){this.element=$(b);if(!this.element){this.element=new Element("ul",{"class":"ui-helper-hidden"});this.close()}this.activeId=this.element.identify()+"_active";b=this.setOptions();a.addClassNames(this.element,"ui-widget ui-widget-content ui-menu ui-corner-"+b.corner);this.choices=this.element.select("li");this._highlightedIndex=-1;this.element.writeAttribute({role:"menu","aria-activedescendant":this.activeId});
this.choices.invoke("writeAttribute","role","menuitem");this.observers={mouseover:this._mouseover.bind(this),click:this._click.bind(this)};this.addObservers();this._shown=false;this.createShim()},addObservers:function(){this.element.observe("mouseover",this.observers.mouseover);this.element.observe("mousedown",this.observers.click)},removeObservers:function(){this.element.stopObserving("mouseover",this.observers.mouseover);this.element.stopObserving("mousedown",this.observers.click)},clear:function(){this.element.select("li").invoke("remove");
this.choices=[];return this},addChoice:function(b){var c;if(Object.isElement(b))if(b.tagName.toUpperCase()==="LI")c=b;else{c=new Element("li");c.insert(b)}else{c=new Element("li");c.update(b)}c.addClassName("ui-menu-item");c.writeAttribute("role","menuitem");this.element.insert(c);this.choices=this.element.select("li");return c},_mouseover:function(b){(b=b.findElement("li"))&&this.highlightChoice(b)},_click:function(b){(b=b.findElement("li"))&&this.selectChoice(b)},moveHighlight:function(b){this._highlightedIndex=
(this._highlightedIndex+b).constrain(-1,this.choices.length-1);this.highlightChoice();return this},highlightChoice:function(b){var c=this.choices;b=Object.isElement(b)?c.indexOf(b):Object.isNumber(b)?b:this._highlightedIndex;a.removeClassNames(this.choices,"ui-state-active");if(b!==-1){this.choices[b].addClassName("ui-state-active");this._highlightedIndex=b;(c=this.element.down("#"+this.activeId))&&c.writeAttribute("id","");this.choices[b].writeAttribute("id",this.activeId)}},selectChoice:function(b){if(Object.isNumber(b))b=
this.choices[b];else b||(b=this.choices[this._highlightedIndex]);this.element.fire("ui:menu:selected",{instance:this,element:b}).stopped||this.close();return this},open:function(){this.element.fire("ui:menu:opened",{instance:this});this.element.removeClassName("ui-helper-hidden");this._highlightedIndex=-1;Prototype.Browser.IE&&this.adjustShim()},close:function(){this.element.fire("ui:menu:closed",{instance:this});this.element.addClassName("ui-helper-hidden");return this},isOpen:function(){return!this.element.hasClassName("ui-helper-hidden")}});
Object.extend(a.Menu,{DEFAULT_OPTIONS:{corner:"all"}})})(S2.UI);
(function(a){a.Autocompleter=Class.create(a.Base,{NAME:"S2.UI.Autocompleter",initialize:function(b,c){this.element=$(b);var d=this.setOptions(c);a.addClassNames(this.element,"ui-widget ui-autocompleter");this.input=this.element.down('input[type="text"]');if(!this.input){this.input=new Element("input",{type:"text"});this.element.insert(this.input)}this.input.insert({before:this.button});this.input.setAttribute("autocomplete","off");this.name=d.parameterName||this.input.readAttribute("name");if(d.choices)this.choices=
d.choices.clone();this.menu=new a.Menu;this.element.insert(this.menu.element);d=this.input.getLayout();this.menu.element.setStyle({left:d.get("left")+"px",top:d.get("top")+d.get("margin-box-height")+"px"});this.observers={blur:this._blur.bind(this),keyup:this._keyup.bind(this),keydown:this._keydown.bind(this),selected:this._selected.bind(this)};this.addObservers()},addObservers:function(){this.input.observe("blur",this.observers.blur);this.input.observe("keyup",this.observers.keyup);this.input.observe("keydown",
this.observers.keydown);this.menu.element.observe("ui:menu:selected",this.observers.selected)},_schedule:function(){this._unschedule();this._timeout=this._change.bind(this).delay(this.options.frequency)},_unschedule:function(){this._timeout&&window.clearTimeout(this._timeout)},_keyup:function(){var b=this.input.getValue();if(b){if(b.blank()||b.length<this.options.minCharacters){this.menu.close();this._unschedule();return}b!==this._value&&this._schedule()}else{this.menu.close();this._unschedule()}this._value=
b},_keydown:function(b){if(!a.modifierUsed(b))if(this.menu.isOpen())switch(b.keyCode){case Event.KEY_UP:this.menu.moveHighlight(-1);b.stop();break;case Event.KEY_DOWN:this.menu.moveHighlight(1);b.stop();break;case Event.KEY_TAB:this.menu.selectChoice();break;case Event.KEY_RETURN:this.menu.selectChoice();this.input.blur();b.stop();break;case Event.KEY_ESC:this.input.setValue("");this.input.blur()}},_getInput:function(){return this.input.getValue()},_setInput:function(b){this.input.setValue(b)},_change:function(){this.findChoices()},
findChoices:function(){var b=this._getInput();this.setChoices((this.choices||[]).inject([],function(c,d){d.toLowerCase().include(b.toLowerCase())&&c.push(d);return c}))},setChoices:function(b){this.results=b;this._updateMenu(b)},_updateMenu:function(b){var c=this.options;this.menu.clear();for(var d=RegExp(RegExp.escape(this._value),"i"),e=0,f,g,h;f=b[e];e++){h=c.highlightSubstring?f.replace(d,"<b>$&</b>"):h;g=(new Element("li")).update(h);g.store("ui.autocompleter.value",f);this.menu.addChoice(g)}b.length===
0?this.menu.close():this.menu.open()},_moveMenuChoice:function(b){this.list.down("li");this._selectedIndex=(this._selectedIndex+b).constrain(-1,this.results.length-1);this._highlightMenuChoice()},_highlightMenuChoice:function(b){var c=this.list.select("li");b=Object.isElement(b)?c.indexOf(b):Object.isNumber(b)?b:this._selectedIndex;a.removeClassNames(c,"ui-state-active");if(!(b===-1||b===null)){c[b].addClassName("ui-state-active");this._selectedIndex=b}},_selected:function(b){this._setInput(b.memo.element.retrieve("ui.autocompleter.value"));
this.menu.close()},_blur:function(){this._unschedule();this.menu.close()}});Object.extend(a.Autocompleter,{DEFAULT_OPTIONS:{tokens:[],frequency:0.4,minCharacters:1,highlightSubstring:true,onShow:Prototype.K,onHide:Prototype.K}})})(S2.UI);
document.observe("dom:loaded",function(){function a(i){i._rotation=i._rotation||0;i._scale=i._scale||1;i._panX=i._panX||0;i._panY=i._panY||0;i._pans=[[0,0],[0,0],[0,0]];i._panidx=1}function b(i,j){i.fire("manipulate:update",Object.extend(j,{id:f}))}function c(){function i(p){for(var u=p.length;u--;)s[p[u].identifier]=p[u];p=[];for(k in s)p.push(k);p=p.sort();if((j=(n=p.length>0?p[0]:null)?s[n].target:null)&&j.nodeType==3)j=j.parentNode;v=p.length>1?p[1]:null;if(A==0&&n&&v){q=(s[n].pageX-s[v].pageX).abs();
w=(s[n].pageY-s[v].pageY).abs();j&&a(j);x=Math.sqrt(q*q+w*w);y=Math.atan2(s[v].pageY-s[n].pageY,s[v].pageX-s[n].pageX);A=1}else if(A==1&&!(n&&v)){if(j){p=j;u=r;p._rotation=m;p._scale=u;p._panX=void 0;p._panY=void 0}A=0}}var j,m,r,s={},n=null,v=null,A=0,l,o,q,w,x,y;e.observe("touchstart",function(p){var u=n;i(p.changedTouches);if(u==null&&n){u=j.viewportOffset();l=u.left+(s[n].pageX-u.left);o=u.top+(s[n].pageY-u.top)}p.stop()});e.observe("touchmove",function(p){i(p.changedTouches);if(n&&!v){b(j,{panX:(j._panX||
0)+s[n].pageX-l,panY:(j._panY||0)+s[n].pageY-o,scale:j._scale,rotation:j._rotation});p.stop()}else if(n&&v){var u=s[v].pageX-s[n].pageX,z=s[v].pageY-s[n].pageY,B=(j._panX||0)+s[v].pageX-u/2-l,C=(j._panY||0)+s[v].pageY-z/2-o;r=j._scale*Math.sqrt(u*u+z*z)/x;m=j._rotation+Math.atan2(z,u)-y;b(j,{rotation:m,scale:r,panX:B,panY:C});p.stop()}});["touchcancel","touchend"].each(function(p){e.observe(p,function(u){for(var z=u.changedTouches.length;z--;)delete s[u.changedTouches[z].identifier];i([]);if(j){u=
j;z=r;u._rotation=m;u._scale=z;u._panX=void 0;u._panY=void 0}})})}function d(){var i,j,m,r,s;e.observe("manipulatestart",function(n){n.stop();i=n.element();a(i)});e.observe("manipulatemove",function(n){i=n.element();j=i._rotation+n.rotation;m=i._scale*n.scale;r=i._panX+n.panX;s=i._panY+n.panY;b(i,{rotation:j,scale:m,panX:r,panY:s,clientX:n.clientX,clientY:n.clientY});n.stop()},false);e.observe("manipulateend",function(n){if(i=n.element()){var v=i,A=m,l=r,o=s;v._rotation=j;v._scale=A;v._panX=l;v._panY=
o}v=Math.sqrt(n.panSpeedX*n.panSpeedX+n.panSpeedY*n.panSpeedY);v>25&&i.fire("manipulate:flick",{speed:v,direction:Math.atan2(n.panSpeedY,n.panSpeedX)})});e.observe("mousemove",function(n){n.stop()});e.observe("mousedown",function(n){n.stop()});e.observe("mouseup",function(n){n.stop()})}if(S2.enableMultitouchSupport){var e=$(document.body),f=0;if(navigator.userAgent.match(/SLBrowser/))return d();if(navigator.userAgent.match(/QtLauncher/))return d();if(navigator.userAgent.match(/Starlight/))return d();
try{document.createEvent("ManipulateEvent");return d()}catch(g){}try{document.createEvent("TouchEvent");return c()}catch(h){}return function(){function i(p){var u=n.viewportOffset(),z=p.pageX-u.left-m;p=p.pageY-u.top-r;y=Math.sqrt(z*z+p*p);x=n._scale*y/A;w=n._rotation+Math.atan2(p,z)-l;return{rotation:w,scale:x,panX:n._panX,panY:n._panY}}function j(p){return{rotation:n._rotation,scale:n._scale,panX:n._panX+p.pageX-o,panY:n._panY+p.pageY-q}}var m,r,s=false,n,v,A,l,o,q,w,x,y;e.observe("mousedown",function(p){v=
p.shiftKey?"scale":"pan";if((n=p.element())&&n.fire){f++;s=true;a(n);var u=n.viewportOffset();m=n.offsetWidth/2;r=n.offsetHeight/2;var z=p.pageX-u.left-m,B=p.pageY-u.top-r;A=Math.sqrt(z*z+B*B);l=Math.atan2(B,z);o=u.left+(p.pageX-u.left);q=u.top+(p.pageY-u.top);p.stop()}});e.observe("mousemove",function(p){if(s)b(n,v=="scale"?i(p):j(p))});e.observe("mouseup",function(p){if(s){s=false;if(v=="scale"){p=i(p);b(n,p);n._rotation=p.rotation;n._scale=p.scale}else{b(n,j(p));n._panX=n._panX+p.pageX-o;n._panY=
n._panY+p.pageY-q}}});e.observe("dragstart",function(p){p.stop()})}()}});Element.__scrollTo=Element.scrollTo;Element.addMethods({scrollTo:function(a,b,c){if(arguments.length==1)return Element.__scrollTo(a);(new S2.FX.Scroll(a,Object.extend(c||{},{to:b}))).play();return a}});
Element.addMethods({effect:function(a,b,c){if(Object.isFunction(b))b=new b(a,c);else if(Object.isString(b))b=new (S2.FX[b.capitalize()])(a,c);b.play(a,c);return a},morph:function(a,b,c){c=S2.FX.parseOptions(c);if(!c.queue){c.queue=a.retrieve("S2.FX.Queue");if(!c.queue)a.store("S2.FX.Queue",c.queue=new S2.FX.Queue)}if(!c.position)c.position="end";return a.effect("morph",Object.extend(c,{style:b}))}.optionize(),appear:function(a,b){return a.effect("morph",Object.extend({before:function(){a.show().setStyle({opacity:0})},
style:"opacity:1"},b))},fade:function(a,b){return a.effect("morph",Object.extend({style:"opacity:0",after:a.hide.bind(a)},b))},cloneWithoutIDs:function(a){a=$(a);a=a.cloneNode(true);a.id="";$(a).select("*[id]").each(function(b){b.id=""});return a}});
(function(){Element.addMethods({transform:window.CSSMatrix?function(a,b){a.style.transform="scale("+(b.scale||1)+") rotate("+(b.rotation||0)+"rad)";return a}:window.WebKitCSSMatrix?function(a,b){a.style.webkitTransform="scale("+(b.scale||1)+") rotate("+(b.rotation||0)+"rad)";return a}:Prototype.Browser.Gecko?function(a,b){a.style.MozTransform="scale("+(b.scale||1)+") rotate("+(b.rotation||0)+"rad)";return a}:Prototype.Browser.IE?function(a,b){if(!a._oDims)a._oDims=[a.offsetWidth,a.offsetHeight];var c=
Math.cos(b.rotation||0)*1,d=Math.sin(b.rotation||0)*1;a.style.filter="progid:DXImageTransform.Microsoft.Matrix(sizingMethod='auto expand',M11="+c+",M12="+-d+",M21="+d+",M22="+c+")";a.style.marginLeft=(a._oDims[0]-a.offsetWidth)/2+"px";a.style.marginTop=(a._oDims[1]-a.offsetHeight)/2+"px";return a}:function(a){return a}})})();
S2.viewportOverlay=function(){var a=document.viewport.getDimensions(),b=document.viewport.getScrollOffsets();return(new Element("div")).setStyle({position:"absolute",left:b.left+"px",top:b.top+"px",width:a.width+"px",height:a.height+"px"})};S2.FX.Helpers={fitIntoRectangle:function(a,b,c,d){return a/b<c/d?[(c-a*(d/b))/2,0,a*(d/b),d]:[0,(d-b*(c/a))/2,c,b*(c/a)]}};
S2.FX.Operators.Zoom=Class.create(S2.FX.Operators.Style,{initialize:function($super,b,c,d){var e=document.viewport.getDimensions(),f=document.viewport.getScrollOffsets(),g=c.getDimensions();e=S2.FX.Helpers.fitIntoRectangle(g.width,g.height,e.width-(d.borderWidth||0)*2,e.height-(d.borderWidth||0)*2);Object.extend(d,{style:{left:e[0]+(d.borderWidth||0)+f.left+"px",top:e[1]+(d.borderWidth||0)+f.top+"px",width:e[2]+"px",height:e[3]+"px"}});$super(b,c,d)}});
S2.FX.Zoom=Class.create(S2.FX.Element,{setup:function(){this.clone=this.element.cloneWithoutIDs();this.element.insert({before:this.clone});this.clone.absolutize().setStyle({zIndex:9999});this.overlay=S2.viewportOverlay();this.options.overlayClassName?this.overlay.addClassName(this.options.overlayClassName):this.overlay.setStyle({backgroundColor:"#000",opacity:"0.9"});$$("body")[0].insert(this.overlay);this.animate("zoom",this.clone,{borderWidth:this.options.borderWidth,propertyTransitions:this.options.propertyTransitions||
{}})},teardown:function(){this.clone.observe("click",function(){this.overlay.remove();this.clone.morph("opacity:0",{duration:0.2,after:function(){this.clone.remove()}.bind(this)})}.bind(this))}});
Element.addMethods({shake:function(a,b){S2.Extensions.webkitCSSTransitions=false;a=$(a);var c=parseFloat(a.getStyle("left")||"0"),d={left:c};a.makePositioned();var e={distance:15,duration:0.5};Object.extend(e,b);var f=e.distance;e=parseFloat(e.duration)/10;return a.morph("left:"+(c+f)+"px",{duration:e}).morph("left:"+(c-f)+"px",{duration:e*2}).morph("left:"+(c+f)+"px",{duration:e*2}).morph("left:"+(c-f)+"px",{duration:e*2}).morph("left:"+(c+f)+"px",{duration:e*2}).morph("left:"+c+"px",{duration:e*
2,after:function(){a.undoPositioned().setStyle(d)}})},pulsate:function(){}});
document.observe("dom:loaded",function(){navigator.userAgent.indexOf("Windows")!=-1&&$(document.body).addClassName("win");if(Prototype.Browser.IE){var a=$("back").addClassName("curvyRedraw");curvyCorners({tl:{radius:10},tr:{radius:10},bl:{radius:10},br:{radius:10},antiAlias:true},a);a.style.filter="alpha(opacity=70)"}if(Prototype.Browser.MobileSafari){if($("show_location"))$("show_location").href="http://maps.google.com/maps?f=q&source=s_q&hl=en&geocode=&q=Chemin+de+la+Raye+13,+1024+Ecublens,+Switzerland&sll=46.524693,6.564245&sspn=0.010586,0.019033&ie=UTF8&ll=46.524708,6.564074&spn=0.010586,0.019033&z=16&iwloc=A"}else $("show_location")&&$("show_location").observe("click",
showMap);(new Image).src="/images/embed/map_drop_pin.png";var b=$("subscriber_email"),c=$("email_flash");if(b){var d=$("email_placeholder");$F(b).blank()&&d.show();b.observe("focus",function(){d.hide()});b.observe("blur",function(){$F(b).blank()&&d.show()});d.observe("click",function(){b.focus()});$("new_subscriber").observe("submit",function(e){if(!validateEmail($F(b))){$("email_field_wrap").shake();e.stop()}})}if(c){setTimeout(function(){c.scrollTo();c.pulsate({pulses:3,duration:1.4})},500);c.hasClassName("unsubscribed")&&
setTimeout(function(){c.fade({afterFinish:function(){$("new_subscriber").appear()}})},3E3)}$$("input[type=file]").each(function(e){e.observe("change",function(){e.previous().down(".fake_file_input_value").update(e.value)})});$$("#contact_topics li a.title").each(function(e){ddd(e);e.next(".form_box").hasClassName("errors")&&e.up().addClassName("expanded");e.observe("click",function(f){var g=e.next(".form_box");if(g.visible()){e.up().removeClassName("expanded");g.hide();Prototype.Browser.IE&&curvyCorners.redraw()}else{$$("#contact_topics li .form_box").invoke("hide");
$$("#contact_topics li").invoke("removeClassName","expanded");e.up().addClassName("expanded");g.setStyle({display:"block"});Prototype.Browser.IE&&curvyCorners.redraw();g=e.up().cumulativeOffset().top;scrollTo(0,g-11)}f.stop()})})});function validateEmail(a){return a.match(/^\s*([^@\s]+)@((?:[-a-z0-9]+\.)+[a-z]{2,})\s*$/i)}
function googleMapInitialize(){var a=new google.maps.LatLng(46.51725,6.5621),b={zoom:18,center:new google.maps.LatLng(46.51735,6.5621),mapTypeId:google.maps.MapTypeId.HYBRID};b=new google.maps.Map(document.getElementById("map_wrap"),b);a=new google.maps.Marker({position:a,map:b,title:"Jilion",icon:"/images/embed/map_drop_pin.png"});(new google.maps.InfoWindow({content:'<div id="popbox"><p><a href="http://is.gd/h8yz4">EPFL Innovation Square <br /> PSE-D<br />1015 Lausanne <br /> Switzerland</a></p></div>',
disableAutoPan:true})).open(b,a)}function showMap(a){a.stop();a=$("map_global");if(a.visible())hideMap();else{a.show();a=(window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0)+90;$("map_overlay").setStyle({top:a+"px"});googleMapInitialize();hideGArrow();$("map_background").observe("click",bodyClick)}}
function hideGArrow(){var a=$$("#pane_6 div.gmnoprint");if(a.size()>0){a=a.first();(a=Prototype.Browser.IE?a.select("img")[15]:a.down("img"))?a.remove():setTimeout(hideGArrow,250)}else setTimeout(hideGArrow,250)}function hideMap(){$("map_global").hide()}function bodyClick(a){var b=a.element();if(!(b.match("#map_overlay")||b.up("#map_overlay"))){hideMap();$("map_background").stopObserving("click",bodyClick);a.stop()}}function ddd(){console.log.apply(console,arguments)};
