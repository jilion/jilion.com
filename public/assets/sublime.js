var Prototype={Version:"1.6.1",Browser:function(){var a=navigator.userAgent,b=Object.prototype.toString.call(window.opera)=="[object Opera]";return{IE:!!window.attachEvent&&!b,Opera:b,WebKit:a.indexOf("AppleWebKit/")>-1,Gecko:a.indexOf("Gecko")>-1&&a.indexOf("KHTML")===-1,MobileSafari:/Apple.*Mobile.*Safari/.test(a)}}(),BrowserFeatures:{XPath:!!document.evaluate,SelectorsAPI:!!document.querySelector,ElementExtensions:function(){var a=window.Element||window.HTMLElement;return!!(a&&a.prototype)}(),
SpecificElementExtensions:function(){if(typeof window.HTMLDivElement!=="undefined")return true;var a=document.createElement("div"),b=document.createElement("form"),c=false;if(a.__proto__&&a.__proto__!==b.__proto__)c=true;return c}()},ScriptFragment:"<script[^>]*>([\\S\\s]*?)<\/script>",JSONFilter:/^\/\*-secure-([\s\S]*)\*\/\s*$/,emptyFunction:function(){},K:function(a){return a}};if(Prototype.Browser.MobileSafari)Prototype.BrowserFeatures.SpecificElementExtensions=false;
var Abstract={},Try={these:function(){for(var a,b=0,c=arguments.length;b<c;b++){var d=arguments[b];try{a=d();break}catch(f){}}return a}},Class=function(){function a(){}function b(){function f(){this.initialize.apply(this,arguments)}var j=null,p=$A(arguments);if(Object.isFunction(p[0]))j=p.shift();Object.extend(f,Class.Methods);f.superclass=j;f.subclasses=[];if(j){a.prototype=j.prototype;f.prototype=new a;j.subclasses.push(f)}j=0;for(var u=p.length;j<u;j++)f.addMethods(p[j]);if(!f.prototype.initialize)f.prototype.initialize=
Prototype.emptyFunction;return f.prototype.constructor=f}function c(f){var j=this.superclass&&this.superclass.prototype,p=Object.keys(f);if(d){f.toString!=Object.prototype.toString&&p.push("toString");f.valueOf!=Object.prototype.valueOf&&p.push("valueOf")}for(var u=0,y=p.length;u<y;u++){var D=p[u],A=f[D];if(j&&Object.isFunction(A)&&A.argumentNames()[0]=="$super"){var h=A;A=function(s){return function(){return j[s].apply(this,arguments)}}(D).wrap(h);A.valueOf=h.valueOf.bind(h);A.toString=h.toString.bind(h)}this.prototype[D]=
A}return this}var d=function(){for(var f in{toString:1})if(f==="toString")return false;return true}();return{create:b,Methods:{addMethods:c}}}();
(function(){function a(r,e){for(var i in e)r[i]=e[i];return r}function b(r){try{if(w(r))return"undefined";if(r===null)return"null";return r.inspect?r.inspect():String(r)}catch(e){if(e instanceof RangeError)return"...";throw e;}}function c(r){switch(typeof r){case "undefined":case "function":case "unknown":return;case "boolean":return r.toString()}if(r===null)return"null";if(r.toJSON)return r.toJSON();if(!y(r)){var e=[];for(var i in r){var o=c(r[i]);w(o)||e.push(i.toJSON()+": "+o)}return"{"+e.join(", ")+
"}"}}function d(r){return $H(r).toQueryString()}function f(r){return r&&r.toHTML?r.toHTML():String.interpret(r)}function j(r){var e=[];for(var i in r)e.push(i);return e}function p(r){var e=[];for(var i in r)e.push(r[i]);return e}function u(r){return a({},r)}function y(r){return!!(r&&r.nodeType==1)}function D(r){return B.call(r)=="[object Array]"}function A(r){return r instanceof Hash}function h(r){return typeof r==="function"}function s(r){return B.call(r)=="[object String]"}function x(r){return B.call(r)==
"[object Number]"}function w(r){return typeof r==="undefined"}var B=Object.prototype.toString;if(typeof Array.isArray=="function"&&Array.isArray([])&&!Array.isArray({}))D=Array.isArray;a(Object,{extend:a,inspect:b,toJSON:c,toQueryString:d,toHTML:f,keys:j,values:p,clone:u,isElement:y,isArray:D,isHash:A,isFunction:h,isString:s,isNumber:x,isUndefined:w})})();
Object.extend(Function.prototype,function(){function a(h,s){for(var x=h.length,w=s.length;w--;)h[x+w]=s[w];return h}function b(h,s){h=A.call(h,0);return a(h,s)}function c(){var h=this.toString().match(/^[\s\(]*function[^(]*\(([^)]*)\)/)[1].replace(/\/\/.*?[\r\n]|\/\*(?:.|[\r\n])*?\*\//g,"").replace(/\s+/g,"").split(",");return h.length==1&&!h[0]?[]:h}function d(h){if(arguments.length<2&&Object.isUndefined(arguments[0]))return this;var s=this,x=A.call(arguments,1);return function(){var w=b(x,arguments);
return s.apply(h,w)}}function f(h){var s=this,x=A.call(arguments,1);return function(w){w=a([w||window.event],x);return s.apply(h,w)}}function j(){if(!arguments.length)return this;var h=this,s=A.call(arguments,0);return function(){var x=b(s,arguments);return h.apply(this,x)}}function p(h){var s=this,x=A.call(arguments,1);h*=1E3;return window.setTimeout(function(){return s.apply(s,x)},h)}function u(){return this.delay.apply(this,a([0.01],arguments))}function y(h){var s=this;return function(){var x=
a([s.bind(this)],arguments);return h.apply(this,x)}}function D(){if(this._methodized)return this._methodized;var h=this;return this._methodized=function(){var s=a([this],arguments);return h.apply(null,s)}}var A=Array.prototype.slice;return{argumentNames:c,bind:d,bindAsEventListener:f,curry:j,delay:p,defer:u,wrap:y,methodize:D}}());
Date.prototype.toJSON=function(){return'"'+this.getUTCFullYear()+"-"+(this.getUTCMonth()+1).toPaddedString(2)+"-"+this.getUTCDate().toPaddedString(2)+"T"+this.getUTCHours().toPaddedString(2)+":"+this.getUTCMinutes().toPaddedString(2)+":"+this.getUTCSeconds().toPaddedString(2)+'Z"'};RegExp.prototype.match=RegExp.prototype.test;RegExp.escape=function(a){return String(a).replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")};
var PeriodicalExecuter=Class.create({initialize:function(a,b){this.callback=a;this.frequency=b;this.currentlyExecuting=false;this.registerCallback()},registerCallback:function(){this.timer=setInterval(this.onTimerEvent.bind(this),this.frequency*1E3)},execute:function(){this.callback(this)},stop:function(){if(this.timer){clearInterval(this.timer);this.timer=null}},onTimerEvent:function(){if(!this.currentlyExecuting)try{this.currentlyExecuting=true;this.execute();this.currentlyExecuting=false}catch(a){this.currentlyExecuting=
false;throw a;}}});Object.extend(String,{interpret:function(a){return a==null?"":String(a)},specialChar:{"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r","\\":"\\\\"}});
Object.extend(String.prototype,function(){function a(C){if(Object.isFunction(C))return C;var E=new Template(C);return function(J){return E.evaluate(J)}}function b(C,E){var J="",K=this,L;E=a(E);if(Object.isString(C))C=RegExp.escape(C);if(!(C.length||C.source)){E=E("");return E+K.split("").join(E)+E}for(;K.length>0;)if(L=K.match(C)){J+=K.slice(0,L.index);J+=String.interpret(E(L));K=K.slice(L.index+L[0].length)}else{J+=K;K=""}return J}function c(C,E,J){E=a(E);J=Object.isUndefined(J)?1:J;return this.gsub(C,
function(K){if(--J<0)return K[0];return E(K)})}function d(C,E){this.gsub(C,E);return String(this)}function f(C,E){C=C||30;E=Object.isUndefined(E)?"...":E;return this.length>C?this.slice(0,C-E.length)+E:String(this)}function j(){return this.replace(/^\s+/,"").replace(/\s+$/,"")}function p(){return this.replace(/<\w+(\s+("[^"]*"|'[^']*'|[^>])+)?>|<\/\w+>/gi,"")}function u(){return this.replace(new RegExp(Prototype.ScriptFragment,"img"),"")}function y(){var C=new RegExp(Prototype.ScriptFragment,"img"),
E=new RegExp(Prototype.ScriptFragment,"im");return(this.match(C)||[]).map(function(J){return(J.match(E)||["",""])[1]})}function D(){return this.extractScripts().map(function(C){return eval(C)})}function A(){return this.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function h(){return this.stripTags().replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")}function s(C){var E=this.strip().match(/([^?#]*)(#.*)?$/);if(!E)return{};return E[1].split(C||"&").inject({},function(J,
K){if((K=K.split("="))[0]){var L=decodeURIComponent(K.shift());K=K.length>1?K.join("="):K[0];if(K!=undefined)K=decodeURIComponent(K);if(L in J){Object.isArray(J[L])||(J[L]=[J[L]]);J[L].push(K)}else J[L]=K}return J})}function x(){return this.split("")}function w(){return this.slice(0,this.length-1)+String.fromCharCode(this.charCodeAt(this.length-1)+1)}function B(C){return C<1?"":(new Array(C+1)).join(this)}function r(){return this.replace(/-+(.)?/g,function(C,E){return E?E.toUpperCase():""})}function e(){return this.charAt(0).toUpperCase()+
this.substring(1).toLowerCase()}function i(){return this.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/-/g,"_").toLowerCase()}function o(){return this.replace(/_/g,"-")}function n(C){var E=this.replace(/[\x00-\x1f\\]/g,function(J){if(J in String.specialChar)return String.specialChar[J];return"\\u00"+J.charCodeAt().toPaddedString(2,16)});if(C)return'"'+E.replace(/"/g,'\\"')+'"';return"'"+E.replace(/'/g,"\\'")+"'"}function q(){return this.inspect(true)}
function m(C){return this.replace(C||Prototype.JSONFilter,"$1")}function v(){var C=this;if(C.blank())return false;C=this.replace(/\\./g,"@").replace(/"[^"\\\n\r]*"/g,"");return/^[,:{}\[\]0-9.\-+Eaeflnr-u \n\r\t]*$/.test(C)}function g(C){var E=this.unfilterJSON();try{if(!C||E.isJSON())return eval("("+E+")")}catch(J){}throw new SyntaxError("Badly formed JSON string: "+this.inspect());}function l(C){return this.indexOf(C)>-1}function z(C){return this.lastIndexOf(C,0)===0}function F(C){var E=this.length-
C.length;return E>=0&&this.indexOf(C,E)===E}function G(){return this==""}function H(){return/^\s*$/.test(this)}function I(C,E){return(new Template(this,E)).evaluate(C)}return{gsub:b,sub:c,scan:d,truncate:f,strip:String.prototype.trim||j,stripTags:p,stripScripts:u,extractScripts:y,evalScripts:D,escapeHTML:A,unescapeHTML:h,toQueryParams:s,parseQuery:s,toArray:x,succ:w,times:B,camelize:r,capitalize:e,underscore:i,dasherize:o,inspect:n,toJSON:q,unfilterJSON:m,isJSON:v,evalJSON:g,include:l,startsWith:z,
endsWith:F,empty:G,blank:H,interpolate:I}}());
var Template=Class.create({initialize:function(a,b){this.template=a.toString();this.pattern=b||Template.Pattern},evaluate:function(a){if(a&&Object.isFunction(a.toTemplateReplacements))a=a.toTemplateReplacements();return this.template.gsub(this.pattern,function(b){if(a==null)return b[1]+"";var c=b[1]||"";if(c=="\\")return b[2];var d=a,f=b[3],j=/^([^.[]+|\[((?:.*?[^\\])?)\])(\.|\[|$)/;b=j.exec(f);if(b==null)return c;for(;b!=null;){var p=b[1].startsWith("[")?b[2].replace(/\\\\]/g,"]"):b[1];d=d[p];if(null==
d||""==b[3])break;f=f.substring("["==b[3]?b[1].length:b[0].length);b=j.exec(f)}return c+String.interpret(d)})}});Template.Pattern=/(^|.|\r|\n)(#\{(.*?)\})/;
var $break={},Enumerable=function(){function a(m,v){var g=0;try{this._each(function(z){m.call(v,z,g++)})}catch(l){if(l!=$break)throw l;}return this}function b(m,v,g){var l=-m,z=[],F=this.toArray();if(m<1)return F;for(;(l+=m)<F.length;)z.push(F.slice(l,l+m));return z.collect(v,g)}function c(m,v){m=m||Prototype.K;var g=true;this.each(function(l,z){g=g&&!!m.call(v,l,z);if(!g)throw $break;});return g}function d(m,v){m=m||Prototype.K;var g=false;this.each(function(l,z){if(g=!!m.call(v,l,z))throw $break;
});return g}function f(m,v){m=m||Prototype.K;var g=[];this.each(function(l,z){g.push(m.call(v,l,z))});return g}function j(m,v){var g;this.each(function(l,z){if(m.call(v,l,z)){g=l;throw $break;}});return g}function p(m,v){var g=[];this.each(function(l,z){m.call(v,l,z)&&g.push(l)});return g}function u(m,v,g){v=v||Prototype.K;var l=[];if(Object.isString(m))m=new RegExp(RegExp.escape(m));this.each(function(z,F){m.match(z)&&l.push(v.call(g,z,F))});return l}function y(m){if(Object.isFunction(this.indexOf))if(this.indexOf(m)!=
-1)return true;var v=false;this.each(function(g){if(g==m){v=true;throw $break;}});return v}function D(m,v){v=Object.isUndefined(v)?null:v;return this.eachSlice(m,function(g){for(;g.length<m;)g.push(v);return g})}function A(m,v,g){this.each(function(l,z){m=v.call(g,m,l,z)});return m}function h(m){var v=$A(arguments).slice(1);return this.map(function(g){return g[m].apply(g,v)})}function s(m,v){m=m||Prototype.K;var g;this.each(function(l,z){l=m.call(v,l,z);if(g==null||l>=g)g=l});return g}function x(m,
v){m=m||Prototype.K;var g;this.each(function(l,z){l=m.call(v,l,z);if(g==null||l<g)g=l});return g}function w(m,v){m=m||Prototype.K;var g=[],l=[];this.each(function(z,F){(m.call(v,z,F)?g:l).push(z)});return[g,l]}function B(m){var v=[];this.each(function(g){v.push(g[m])});return v}function r(m,v){var g=[];this.each(function(l,z){m.call(v,l,z)||g.push(l)});return g}function e(m,v){return this.map(function(g,l){return{value:g,criteria:m.call(v,g,l)}}).sort(function(g,l){g=g.criteria;l=l.criteria;return g<
l?-1:g>l?1:0}).pluck("value")}function i(){return this.map()}function o(){var m=Prototype.K,v=$A(arguments);if(Object.isFunction(v.last()))m=v.pop();var g=[this].concat(v).map($A);return this.map(function(l,z){return m(g.pluck(z))})}function n(){return this.toArray().length}function q(){return"#<Enumerable:"+this.toArray().inspect()+">"}return{each:a,eachSlice:b,all:c,every:c,any:d,some:d,collect:f,map:f,detect:j,findAll:p,select:p,filter:p,grep:u,include:y,member:y,inGroupsOf:D,inject:A,invoke:h,
max:s,min:x,partition:w,pluck:B,reject:r,sortBy:e,toArray:i,entries:i,zip:o,size:n,inspect:q,find:j}}();function $A(a){if(!a)return[];if("toArray"in Object(a))return a.toArray();for(var b=a.length||0,c=new Array(b);b--;)c[b]=a[b];return c}function $w(a){if(!Object.isString(a))return[];return(a=a.strip())?a.split(/\s+/):[]}Array.from=$A;
(function(){function a(n){for(var q=0,m=this.length;q<m;q++)n(this[q])}function b(){this.length=0;return this}function c(){return this[0]}function d(){return this[this.length-1]}function f(){return this.select(function(n){return n!=null})}function j(){return this.inject([],function(n,q){if(Object.isArray(q))return n.concat(q.flatten());n.push(q);return n})}function p(){var n=i.call(arguments,0);return this.select(function(q){return!n.include(q)})}function u(n){return(n===false?this.toArray():this)._reverse()}
function y(n){return this.inject([],function(q,m,v){if(0==v||(n?q.last()!=m:!q.include(m)))q.push(m);return q})}function D(n){return this.uniq().findAll(function(q){return n.detect(function(m){return q===m})})}function A(){return i.call(this,0)}function h(){return this.length}function s(){return"["+this.map(Object.inspect).join(", ")+"]"}function x(){var n=[];this.each(function(q){q=Object.toJSON(q);Object.isUndefined(q)||n.push(q)});return"["+n.join(", ")+"]"}function w(n,q){q||(q=0);var m=this.length;
if(q<0)q=m+q;for(;q<m;q++)if(this[q]===n)return q;return-1}function B(n,q){q=isNaN(q)?this.length:(q<0?this.length+q:q)+1;n=this.slice(0,q).reverse().indexOf(n);return n<0?n:q-n-1}function r(){for(var n=i.call(this,0),q,m=0,v=arguments.length;m<v;m++){q=arguments[m];if(Object.isArray(q)&&!("callee"in q))for(var g=0,l=q.length;g<l;g++)n.push(q[g]);else n.push(q)}return n}var e=Array.prototype,i=e.slice,o=e.forEach;o||(o=a);Object.extend(e,Enumerable);if(!e._reverse)e._reverse=e.reverse;Object.extend(e,
{_each:o,clear:b,first:c,last:d,compact:f,flatten:j,without:p,reverse:u,uniq:y,intersect:D,clone:A,toArray:A,size:h,inspect:s,toJSON:x});if(function(){return[].concat(arguments)[0][0]!==1}(1,2))e.concat=r;if(!e.indexOf)e.indexOf=w;if(!e.lastIndexOf)e.lastIndexOf=B})();function $H(a){return new Hash(a)}
var Hash=Class.create(Enumerable,function(){function a(r){this._object=Object.isHash(r)?r.toObject():Object.clone(r)}function b(r){for(var e in this._object){var i=this._object[e],o=[e,i];o.key=e;o.value=i;r(o)}}function c(r,e){return this._object[r]=e}function d(r){if(this._object[r]!==Object.prototype[r])return this._object[r]}function f(r){var e=this._object[r];delete this._object[r];return e}function j(){return Object.clone(this._object)}function p(){return this.pluck("key")}function u(){return this.pluck("value")}
function y(r){var e=this.detect(function(i){return i.value===r});return e&&e.key}function D(r){return this.clone().update(r)}function A(r){return(new Hash(r)).inject(this,function(e,i){e.set(i.key,i.value);return e})}function h(r,e){if(Object.isUndefined(e))return r;return r+"="+encodeURIComponent(String.interpret(e))}function s(){return this.inject([],function(r,e){var i=encodeURIComponent(e.key);if((e=e.value)&&typeof e=="object"){if(Object.isArray(e))return r.concat(e.map(h.curry(i)))}else r.push(h(i,
e));return r}).join("&")}function x(){return"#<Hash:{"+this.map(function(r){return r.map(Object.inspect).join(": ")}).join(", ")+"}>"}function w(){return Object.toJSON(this.toObject())}function B(){return new Hash(this)}return{initialize:a,_each:b,set:c,get:d,unset:f,toObject:j,toTemplateReplacements:j,keys:p,values:u,index:y,merge:D,update:A,toQueryString:s,inspect:x,toJSON:w,clone:B}}());Hash.from=$H;
Object.extend(Number.prototype,function(){function a(){return this.toPaddedString(2,16)}function b(){return this+1}function c(D,A){$R(0,this,true).each(D,A);return this}function d(D,A){A=this.toString(A||10);return"0".times(D-A.length)+A}function f(){return isFinite(this)?this.toString():"null"}function j(){return Math.abs(this)}function p(){return Math.round(this)}function u(){return Math.ceil(this)}function y(){return Math.floor(this)}return{toColorPart:a,succ:b,times:c,toPaddedString:d,toJSON:f,
abs:j,round:p,ceil:u,floor:y}}());function $R(a,b,c){return new ObjectRange(a,b,c)}
var ObjectRange=Class.create(Enumerable,function(){function a(d,f,j){this.start=d;this.end=f;this.exclusive=j}function b(d){for(var f=this.start;this.include(f);){d(f);f=f.succ()}}function c(d){if(d<this.start)return false;if(this.exclusive)return d<this.end;return d<=this.end}return{initialize:a,_each:b,include:c}}()),Ajax={getTransport:function(){return Try.these(function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")})||
false},activeRequestCount:0};Ajax.Responders={responders:[],_each:function(a){this.responders._each(a)},register:function(a){this.include(a)||this.responders.push(a)},unregister:function(a){this.responders=this.responders.without(a)},dispatch:function(a,b,c,d){this.each(function(f){if(Object.isFunction(f[a]))try{f[a].apply(f,[b,c,d])}catch(j){}})}};Object.extend(Ajax.Responders,Enumerable);Ajax.Responders.register({onCreate:function(){Ajax.activeRequestCount++},onComplete:function(){Ajax.activeRequestCount--}});
Ajax.Base=Class.create({initialize:function(a){this.options={method:"post",asynchronous:true,contentType:"application/x-www-form-urlencoded",encoding:"UTF-8",parameters:"",evalJSON:true,evalJS:true};Object.extend(this.options,a||{});this.options.method=this.options.method.toLowerCase();if(Object.isString(this.options.parameters))this.options.parameters=this.options.parameters.toQueryParams();else if(Object.isHash(this.options.parameters))this.options.parameters=this.options.parameters.toObject()}});
Ajax.Request=Class.create(Ajax.Base,{_complete:false,initialize:function($super,b,c){$super(c);this.transport=Ajax.getTransport();this.request(b)},request:function(a){this.url=a;this.method=this.options.method;a=Object.clone(this.options.parameters);if(!["get","post"].include(this.method)){a._method=this.method;this.method="post"}this.parameters=a;if(a=Object.toQueryString(a))if(this.method=="get")this.url+=(this.url.include("?")?"&":"?")+a;else if(/Konqueror|Safari|KHTML/.test(navigator.userAgent))a+=
"&_=";try{var b=new Ajax.Response(this);this.options.onCreate&&this.options.onCreate(b);Ajax.Responders.dispatch("onCreate",this,b);this.transport.open(this.method.toUpperCase(),this.url,this.options.asynchronous);this.options.asynchronous&&this.respondToReadyState.bind(this).defer(1);this.transport.onreadystatechange=this.onStateChange.bind(this);this.setRequestHeaders();this.body=this.method=="post"?this.options.postBody||a:null;this.transport.send(this.body);!this.options.asynchronous&&this.transport.overrideMimeType&&
this.onStateChange()}catch(c){this.dispatchException(c)}},onStateChange:function(){var a=this.transport.readyState;a>1&&!(a==4&&this._complete)&&this.respondToReadyState(this.transport.readyState)},setRequestHeaders:function(){var a={"X-Requested-With":"XMLHttpRequest","X-Prototype-Version":Prototype.Version,Accept:"text/javascript, text/html, application/xml, text/xml, */*"};if(this.method=="post"){a["Content-type"]=this.options.contentType+(this.options.encoding?"; charset="+this.options.encoding:
"");if(this.transport.overrideMimeType&&(navigator.userAgent.match(/Gecko\/(\d{4})/)||[0,2005])[1]<2005)a.Connection="close"}if(typeof this.options.requestHeaders=="object"){var b=this.options.requestHeaders;if(Object.isFunction(b.push))for(var c=0,d=b.length;c<d;c+=2)a[b[c]]=b[c+1];else $H(b).each(function(j){a[j.key]=j.value})}for(var f in a)this.transport.setRequestHeader(f,a[f])},success:function(){var a=this.getStatus();return!a||a>=200&&a<300},getStatus:function(){try{return this.transport.status||
0}catch(a){return 0}},respondToReadyState:function(a){a=Ajax.Request.Events[a];var b=new Ajax.Response(this);if(a=="Complete"){try{this._complete=true;(this.options["on"+b.status]||this.options["on"+(this.success()?"Success":"Failure")]||Prototype.emptyFunction)(b,b.headerJSON)}catch(c){this.dispatchException(c)}var d=b.getHeader("Content-type");if(this.options.evalJS=="force"||this.options.evalJS&&this.isSameOrigin()&&d&&d.match(/^\s*(text|application)\/(x-)?(java|ecma)script(;.*)?\s*$/i))this.evalResponse()}try{(this.options["on"+
a]||Prototype.emptyFunction)(b,b.headerJSON);Ajax.Responders.dispatch("on"+a,this,b,b.headerJSON)}catch(f){this.dispatchException(f)}if(a=="Complete")this.transport.onreadystatechange=Prototype.emptyFunction},isSameOrigin:function(){var a=this.url.match(/^\s*https?:\/\/[^\/]*/);return!a||a[0]=="#{protocol}//#{domain}#{port}".interpolate({protocol:location.protocol,domain:document.domain,port:location.port?":"+location.port:""})},getHeader:function(a){try{return this.transport.getResponseHeader(a)||
null}catch(b){return null}},evalResponse:function(){try{return eval((this.transport.responseText||"").unfilterJSON())}catch(a){this.dispatchException(a)}},dispatchException:function(a){(this.options.onException||Prototype.emptyFunction)(this,a);Ajax.Responders.dispatch("onException",this,a)}});Ajax.Request.Events=["Uninitialized","Loading","Loaded","Interactive","Complete"];
Ajax.Response=Class.create({initialize:function(a){this.request=a;a=this.transport=a.transport;var b=this.readyState=a.readyState;if(b>2&&!Prototype.Browser.IE||b==4){this.status=this.getStatus();this.statusText=this.getStatusText();this.responseText=String.interpret(a.responseText);this.headerJSON=this._getHeaderJSON()}if(b==4){a=a.responseXML;this.responseXML=Object.isUndefined(a)?null:a;this.responseJSON=this._getResponseJSON()}},status:0,statusText:"",getStatus:Ajax.Request.prototype.getStatus,
getStatusText:function(){try{return this.transport.statusText||""}catch(a){return""}},getHeader:Ajax.Request.prototype.getHeader,getAllHeaders:function(){try{return this.getAllResponseHeaders()}catch(a){return null}},getResponseHeader:function(a){return this.transport.getResponseHeader(a)},getAllResponseHeaders:function(){return this.transport.getAllResponseHeaders()},_getHeaderJSON:function(){var a=this.getHeader("X-JSON");if(!a)return null;a=decodeURIComponent(escape(a));try{return a.evalJSON(this.request.options.sanitizeJSON||
!this.request.isSameOrigin())}catch(b){this.request.dispatchException(b)}},_getResponseJSON:function(){var a=this.request.options;if(!a.evalJSON||a.evalJSON!="force"&&!(this.getHeader("Content-type")||"").include("application/json")||this.responseText.blank())return null;try{return this.responseText.evalJSON(a.sanitizeJSON||!this.request.isSameOrigin())}catch(b){this.request.dispatchException(b)}}});
Ajax.Updater=Class.create(Ajax.Request,{initialize:function($super,b,c,d){this.container={success:b.success||b,failure:b.failure||(b.success?null:b)};d=Object.clone(d);var f=d.onComplete;d.onComplete=function(j,p){this.updateContent(j.responseText);Object.isFunction(f)&&f(j,p)}.bind(this);$super(c,d)},updateContent:function(a){var b=this.container[this.success()?"success":"failure"],c=this.options;c.evalScripts||(a=a.stripScripts());if(b=$(b))if(c.insertion)if(Object.isString(c.insertion)){var d=
{};d[c.insertion]=a;b.insert(d)}else c.insertion(b,a);else b.update(a)}});
Ajax.PeriodicalUpdater=Class.create(Ajax.Base,{initialize:function($super,b,c,d){$super(d);this.onComplete=this.options.onComplete;this.frequency=this.options.frequency||2;this.decay=this.options.decay||1;this.updater={};this.container=b;this.url=c;this.start()},start:function(){this.options.onComplete=this.updateComplete.bind(this);this.onTimerEvent()},stop:function(){this.updater.options.onComplete=undefined;clearTimeout(this.timer);(this.onComplete||Prototype.emptyFunction).apply(this,arguments)},
updateComplete:function(a){if(this.options.decay){this.decay=a.responseText==this.lastText?this.decay*this.options.decay:1;this.lastText=a.responseText}this.timer=this.onTimerEvent.bind(this).delay(this.decay*this.frequency)},onTimerEvent:function(){this.updater=new Ajax.Updater(this.container,this.url,this.options)}});
function $(a){if(arguments.length>1){for(var b=0,c=[],d=arguments.length;b<d;b++)c.push($(arguments[b]));return c}if(Object.isString(a))a=document.getElementById(a);return Element.extend(a)}if(Prototype.BrowserFeatures.XPath)document._getElementsByXPath=function(a,b){var c=[];a=document.evaluate(a,$(b)||document,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null);b=0;for(var d=a.snapshotLength;b<d;b++)c.push(Element.extend(a.snapshotItem(b)));return c};if(!window.Node)var Node={};
Node.ELEMENT_NODE||Object.extend(Node,{ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12});
(function(a){var b=function(){var d=document.createElement("form"),f=document.createElement("input"),j=document.documentElement;f.setAttribute("name","test");d.appendChild(f);j.appendChild(d);f=d.elements?typeof d.elements.test=="undefined":null;j.removeChild(d);return f}(),c=a.Element;a.Element=function(d,f){f=f||{};d=d.toLowerCase();var j=Element.cache;if(b&&f.name){d="<"+d+' name="'+f.name+'">';delete f.name;return Element.writeAttribute(document.createElement(d),f)}j[d]||(j[d]=Element.extend(document.createElement(d)));
return Element.writeAttribute(j[d].cloneNode(false),f)};Object.extend(a.Element,c||{});if(c)a.Element.prototype=c.prototype})(this);Element.cache={};Element.idCounter=1;
Element.Methods={visible:function(a){return $(a).style.display!="none"},toggle:function(a){a=$(a);Element[Element.visible(a)?"hide":"show"](a);return a},hide:function(a){a=$(a);a.style.display="none";return a},show:function(a){a=$(a);a.style.display="";return a},remove:function(a){a=$(a);a.parentNode.removeChild(a);return a},update:function(){function a(f,j){f=$(f);if(j&&j.toElement)j=j.toElement();if(Object.isElement(j))return f.update().insert(j);j=Object.toHTML(j);var p=f.tagName.toUpperCase();
if(p==="SCRIPT"&&d){f.text=j;return f}if(b||c)if(p in Element._insertionTranslations.tags){for(;f.firstChild;)f.removeChild(f.firstChild);Element._getContentFromAnonymousElement(p,j.stripScripts()).each(function(u){f.appendChild(u)})}else f.innerHTML=j.stripScripts();else f.innerHTML=j.stripScripts();j.evalScripts.bind(j).defer();return f}var b=function(){var f=document.createElement("select"),j=true;f.innerHTML='<option value="test">test</option>';if(f.options&&f.options[0])j=f.options[0].nodeName.toUpperCase()!==
"OPTION";return j}(),c=function(){try{var f=document.createElement("table");if(f&&f.tBodies){f.innerHTML="<tbody><tr><td>test</td></tr></tbody>";return typeof f.tBodies[0]=="undefined"}}catch(j){return true}}(),d=function(){var f=document.createElement("script"),j=false;try{f.appendChild(document.createTextNode(""));j=!f.firstChild||f.firstChild&&f.firstChild.nodeType!==3}catch(p){j=true}return j}();return a}(),replace:function(a,b){a=$(a);if(b&&b.toElement)b=b.toElement();else if(!Object.isElement(b)){b=
Object.toHTML(b);var c=a.ownerDocument.createRange();c.selectNode(a);b.evalScripts.bind(b).defer();b=c.createContextualFragment(b.stripScripts())}a.parentNode.replaceChild(b,a);return a},insert:function(a,b){a=$(a);if(Object.isString(b)||Object.isNumber(b)||Object.isElement(b)||b&&(b.toElement||b.toHTML))b={bottom:b};var c,d,f;for(var j in b){c=b[j];j=j.toLowerCase();d=Element._insertionTranslations[j];if(c&&c.toElement)c=c.toElement();if(Object.isElement(c))d(a,c);else{c=Object.toHTML(c);f=(j=="before"||
j=="after"?a.parentNode:a).tagName.toUpperCase();f=Element._getContentFromAnonymousElement(f,c.stripScripts());if(j=="top"||j=="after")f.reverse();f.each(d.curry(a));c.evalScripts.bind(c).defer()}}return a},wrap:function(a,b,c){a=$(a);if(Object.isElement(b))$(b).writeAttribute(c||{});else b=Object.isString(b)?new Element(b,c):new Element("div",b);a.parentNode&&a.parentNode.replaceChild(b,a);b.appendChild(a);return b},inspect:function(a){a=$(a);var b="<"+a.tagName.toLowerCase();$H({id:"id",className:"class"}).each(function(c){var d=
c.first();c=c.last();if(d=(a[d]||"").toString())b+=" "+c+"="+d.inspect(true)});return b+">"},recursivelyCollect:function(a,b,c){a=$(a);c=c||-1;for(var d=[];a=a[b];){a.nodeType==1&&d.push(Element.extend(a));if(d.length==c)break}return d},ancestors:function(a){return Element.recursivelyCollect(a,"parentNode")},descendants:function(a){return Element.select(a,"*")},firstDescendant:function(a){for(a=$(a).firstChild;a&&a.nodeType!=1;)a=a.nextSibling;return $(a)},immediateDescendants:function(a){var b=[];
for(a=$(a).firstChild;a;){a.nodeType===1&&b.push(Element.extend(a));a=a.nextSibling}return b},previousSiblings:function(a){return Element.recursivelyCollect(a,"previousSibling")},nextSiblings:function(a){return Element.recursivelyCollect(a,"nextSibling")},siblings:function(a){a=$(a);return Element.previousSiblings(a).reverse().concat(Element.nextSiblings(a))},match:function(a,b){a=$(a);if(Object.isString(b))return Prototype.Selector.match(a,b);return b.match(a)},up:function(a,b,c){a=$(a);if(arguments.length==
1)return $(a.parentNode);var d=Element.ancestors(a);return Object.isNumber(b)?d[b]:Prototype.Selector.find(d,b,c)},down:function(a,b,c){a=$(a);if(arguments.length==1)return Element.firstDescendant(a);return Object.isNumber(b)?Element.descendants(a)[b]:Element.select(a,b)[c||0]},previous:function(a,b,c){a=$(a);if(Object.isNumber(b)){c=b;b=false}Object.isNumber(c)||(c=0);return b?Prototype.Selector.find(a.previousSiblings(),b,c):a.recursivelyCollect("previousSibling",c+1)[c]},next:function(a,b,c){a=
$(a);if(Object.isNumber(b)){c=b;b=false}Object.isNumber(c)||(c=0);if(b)return Prototype.Selector.find(a.nextSiblings(),b,c);else{Object.isNumber(c);return a.recursivelyCollect("nextSibling",c+1)[c]}},select:function(a){a=$(a);var b=Array.prototype.slice.call(arguments,1).join(", ");return Prototype.Selector.select(b,a)},adjacent:function(a){a=$(a);var b=Array.prototype.slice.call(arguments,1).join(", ");return Prototype.Selector.select(b,a.parentNode).without(a)},identify:function(a){a=$(a);var b=
Element.readAttribute(a,"id");if(b)return b;do b="anonymous_element_"+Element.idCounter++;while($(b));Element.writeAttribute(a,"id",b);return b},readAttribute:function(a,b){a=$(a);if(Prototype.Browser.IE){var c=Element._attributeTranslations.read;if(c.values[b])return c.values[b](a,b);if(c.names[b])b=c.names[b];if(b.include(":"))return!a.attributes||!a.attributes[b]?null:a.attributes[b].value}return a.getAttribute(b)},writeAttribute:function(a,b,c){a=$(a);var d={},f=Element._attributeTranslations.write;
if(typeof b=="object")d=b;else d[b]=Object.isUndefined(c)?true:c;for(var j in d){b=f.names[j]||j;c=d[j];if(f.values[j])b=f.values[j](a,c);if(c===false||c===null)a.removeAttribute(b);else c===true?a.setAttribute(b,b):a.setAttribute(b,c)}return a},getHeight:function(a){return Element.getDimensions(a).height},getWidth:function(a){return Element.getDimensions(a).width},classNames:function(a){return new Element.ClassNames(a)},hasClassName:function(a,b){if(a=$(a)){a=a.className;return a.length>0&&(a==b||
(new RegExp("(^|\\s)"+b+"(\\s|$)")).test(a))}},addClassName:function(a,b){if(a=$(a)){Element.hasClassName(a,b)||(a.className+=(a.className?" ":"")+b);return a}},removeClassName:function(a,b){if(a=$(a)){a.className=a.className.replace(new RegExp("(^|\\s+)"+b+"(\\s+|$)")," ").strip();return a}},toggleClassName:function(a,b){if(a=$(a))return Element[Element.hasClassName(a,b)?"removeClassName":"addClassName"](a,b)},cleanWhitespace:function(a){a=$(a);for(var b=a.firstChild;b;){var c=b.nextSibling;b.nodeType==
3&&!/\S/.test(b.nodeValue)&&a.removeChild(b);b=c}return a},empty:function(a){return $(a).innerHTML.blank()},descendantOf:function(a,b){a=$(a);b=$(b);if(a.compareDocumentPosition)return(a.compareDocumentPosition(b)&8)===8;if(b.contains)return b.contains(a)&&b!==a;for(;a=a.parentNode;)if(a==b)return true;return false},scrollTo:function(a){a=$(a);var b=Element.cumulativeOffset(a);window.scrollTo(b[0],b[1]);return a},getStyle:function(a,b){a=$(a);b=b=="float"?"cssFloat":b.camelize();var c=a.style[b];
if(!c||c=="auto")c=(a=document.defaultView.getComputedStyle(a,null))?a[b]:null;if(b=="opacity")return c?parseFloat(c):1;return c=="auto"?null:c},getOpacity:function(a){return $(a).getStyle("opacity")},setStyle:function(a,b){a=$(a);var c=a.style;if(Object.isString(b)){a.style.cssText+=";"+b;return b.include("opacity")?a.setOpacity(b.match(/opacity:\s*(\d?\.?\d*)/)[1]):a}for(var d in b)if(d=="opacity")a.setOpacity(b[d]);else c[d=="float"||d=="cssFloat"?Object.isUndefined(c.styleFloat)?"cssFloat":"styleFloat":
d]=b[d];return a},setOpacity:function(a,b){a=$(a);a.style.opacity=b==1||b===""?"":b<1.0E-5?0:b;return a},getDimensions:function(a){a=$(a);var b=Element.getStyle(a,"display");if(b!="none"&&b!=null)return{width:a.offsetWidth,height:a.offsetHeight};b=a.style;var c=b.visibility,d=b.position,f=b.display;b.visibility="hidden";if(d!="fixed")b.position="absolute";b.display="block";var j=a.clientWidth;a=a.clientHeight;b.display=f;b.position=d;b.visibility=c;return{width:j,height:a}},makePositioned:function(a){a=
$(a);var b=Element.getStyle(a,"position");if(b=="static"||!b){a._madePositioned=true;a.style.position="relative";if(Prototype.Browser.Opera){a.style.top=0;a.style.left=0}}return a},undoPositioned:function(a){a=$(a);if(a._madePositioned){a._madePositioned=undefined;a.style.position=a.style.top=a.style.left=a.style.bottom=a.style.right=""}return a},makeClipping:function(a){a=$(a);if(a._overflow)return a;a._overflow=Element.getStyle(a,"overflow")||"auto";if(a._overflow!=="hidden")a.style.overflow="hidden";
return a},undoClipping:function(a){a=$(a);if(!a._overflow)return a;a.style.overflow=a._overflow=="auto"?"":a._overflow;a._overflow=null;return a},cumulativeOffset:function(a){var b=0,c=0;if(a.parentNode){do{b+=a.offsetTop||0;c+=a.offsetLeft||0;a=a.offsetParent}while(a)}return Element._returnOffset(c,b)},positionedOffset:function(a){var b=0,c=0;do{b+=a.offsetTop||0;c+=a.offsetLeft||0;if(a=a.offsetParent){if(a.tagName.toUpperCase()=="BODY")break;if(Element.getStyle(a,"position")!=="static")break}}while(a);
return Element._returnOffset(c,b)},absolutize:function(a){a=$(a);if(Element.getStyle(a,"position")=="absolute")return a;var b=Element.positionedOffset(a),c=b[1];b=b[0];var d=a.clientWidth,f=a.clientHeight;a._originalLeft=b-parseFloat(a.style.left||0);a._originalTop=c-parseFloat(a.style.top||0);a._originalWidth=a.style.width;a._originalHeight=a.style.height;a.style.position="absolute";a.style.top=c+"px";a.style.left=b+"px";a.style.width=d+"px";a.style.height=f+"px";return a},relativize:function(a){a=
$(a);if(Element.getStyle(a,"position")=="relative")return a;a.style.position="relative";var b=parseFloat(a.style.top||0)-(a._originalTop||0),c=parseFloat(a.style.left||0)-(a._originalLeft||0);a.style.top=b+"px";a.style.left=c+"px";a.style.height=a._originalHeight;a.style.width=a._originalWidth;return a},cumulativeScrollOffset:function(a){var b=0,c=0;do{b+=a.scrollTop||0;c+=a.scrollLeft||0;a=a.parentNode}while(a);return Element._returnOffset(c,b)},getOffsetParent:function(a){if(a.offsetParent)return $(a.offsetParent);
if(a==document.body)return $(a);for(;(a=a.parentNode)&&a!=document.body;)if(Element.getStyle(a,"position")!="static")return $(a);return $(document.body)},viewportOffset:function(a){var b=0,c=0,d=a;do{b+=d.offsetTop||0;c+=d.offsetLeft||0;if(d.offsetParent==document.body&&Element.getStyle(d,"position")=="absolute")break}while(d=d.offsetParent);d=a;do if(!Prototype.Browser.Opera||d.tagName&&d.tagName.toUpperCase()=="BODY"){b-=d.scrollTop||0;c-=d.scrollLeft||0}while(d=d.parentNode);return Element._returnOffset(c,
b)},clonePosition:function(a,b,c){c=Object.extend({setLeft:true,setTop:true,setWidth:true,setHeight:true,offsetTop:0,offsetLeft:0},c||{});b=$(b);var d=Element.viewportOffset(b),f=[0,0],j=null;a=$(a);if(Element.getStyle(a,"position")=="absolute"){j=Element.getOffsetParent(a);f=Element.viewportOffset(j)}if(j==document.body){f[0]-=document.body.offsetLeft;f[1]-=document.body.offsetTop}if(c.setLeft)a.style.left=d[0]-f[0]+c.offsetLeft+"px";if(c.setTop)a.style.top=d[1]-f[1]+c.offsetTop+"px";if(c.setWidth)a.style.width=
b.offsetWidth+"px";if(c.setHeight)a.style.height=b.offsetHeight+"px";return a}};Object.extend(Element.Methods,{getElementsBySelector:Element.Methods.select,childElements:Element.Methods.immediateDescendants});Element._attributeTranslations={write:{names:{className:"class",htmlFor:"for"},values:{}}};
if(Prototype.Browser.Opera){Element.Methods.getStyle=Element.Methods.getStyle.wrap(function(a,b,c){switch(c){case "left":case "top":case "right":case "bottom":if(a(b,"position")==="static")return null;case "height":case "width":if(!Element.visible(b))return null;var d=parseInt(a(b,c),10);if(d!==b["offset"+c.capitalize()])return d+"px";return(c==="height"?["border-top-width","padding-top","padding-bottom","border-bottom-width"]:["border-left-width","padding-left","padding-right","border-right-width"]).inject(d,
function(f,j){j=a(b,j);return j===null?f:f-parseInt(j,10)})+"px";default:return a(b,c)}});Element.Methods.readAttribute=Element.Methods.readAttribute.wrap(function(a,b,c){if(c==="title")return b.title;return a(b,c)})}else if(Prototype.Browser.IE){Element.Methods.getOffsetParent=Element.Methods.getOffsetParent.wrap(function(a,b){b=$(b);if(!b.parentNode)return $(document.body);var c=b.getStyle("position");if(c!=="static")return a(b);b.setStyle({position:"relative"});a=a(b);b.setStyle({position:c});
return a});$w("positionedOffset viewportOffset").each(function(a){Element.Methods[a]=Element.Methods[a].wrap(function(b,c){c=$(c);if(!c.parentNode)return Element._returnOffset(0,0);var d=c.getStyle("position");if(d!=="static")return b(c);var f=c.getOffsetParent();f&&f.getStyle("position")==="fixed"&&f.setStyle({zoom:1});c.setStyle({position:"relative"});b=b(c);c.setStyle({position:d});return b})});Element.Methods.getStyle=function(a,b){a=$(a);b=b=="float"||b=="cssFloat"?"styleFloat":b.camelize();
var c=a.style[b];if(!c&&a.currentStyle)c=a.currentStyle[b];if(b=="opacity"){if(c=(a.getStyle("filter")||"").match(/alpha\(opacity=(.*)\)/))if(c[1])return parseFloat(c[1])/100;return 1}if(c=="auto"){if((b=="width"||b=="height")&&a.getStyle("display")!="none")return a["offset"+b.capitalize()]+"px";return null}return c};Element.Methods.setOpacity=function(a,b){function c(j){return j.replace(/alpha\([^\)]*\)/gi,"")}a=$(a);var d=a.currentStyle;if(d&&!d.hasLayout||!d&&a.style.zoom=="normal")a.style.zoom=
1;d=a.getStyle("filter");var f=a.style;if(b==1||b===""){(d=c(d))?(f.filter=d):f.removeAttribute("filter");return a}else if(b<1.0E-5)b=0;f.filter=c(d)+"alpha(opacity="+b*100+")";return a};Element._attributeTranslations=function(){var a="className",b="for",c=document.createElement("div");c.setAttribute(a,"x");if(c.className!=="x"){c.setAttribute("class","x");if(c.className==="x")a="class"}c=null;c=document.createElement("label");c.setAttribute(b,"x");if(c.htmlFor!=="x"){c.setAttribute("htmlFor","x");
if(c.htmlFor==="x")b="htmlFor"}c=null;return{read:{names:{"class":a,className:a,"for":b,htmlFor:b},values:{_getAttr:function(d,f){return d.getAttribute(f)},_getAttr2:function(d,f){return d.getAttribute(f,2)},_getAttrNode:function(d,f){return(d=d.getAttributeNode(f))?d.value:""},_getEv:function(){var d=document.createElement("div"),f;d.onclick=Prototype.emptyFunction;d=d.getAttribute("onclick");if(String(d).indexOf("{")>-1)f=function(j,p){p=j.getAttribute(p);if(!p)return null;p=p.toString();p=p.split("{")[1];
p=p.split("}")[0];return p.strip()};else if(d==="")f=function(j,p){p=j.getAttribute(p);if(!p)return null;return p.strip()};d=null;return f}(),_flag:function(d,f){return $(d).hasAttribute(f)?f:null},style:function(d){return d.style.cssText.toLowerCase()},title:function(d){return d.title}}}}}();Element._attributeTranslations.write={names:Object.extend({cellpadding:"cellPadding",cellspacing:"cellSpacing"},Element._attributeTranslations.read.names),values:{checked:function(a,b){a.checked=!!b},style:function(a,
b){a.style.cssText=b?b:""}}};Element._attributeTranslations.has={};$w("colSpan rowSpan vAlign dateTime accessKey tabIndex encType maxLength readOnly longDesc frameBorder").each(function(a){Element._attributeTranslations.write.names[a.toLowerCase()]=a;Element._attributeTranslations.has[a.toLowerCase()]=a});(function(a){Object.extend(a,{href:a._getAttr2,src:a._getAttr2,type:a._getAttr,action:a._getAttrNode,disabled:a._flag,checked:a._flag,readonly:a._flag,multiple:a._flag,onload:a._getEv,onunload:a._getEv,
onclick:a._getEv,ondblclick:a._getEv,onmousedown:a._getEv,onmouseup:a._getEv,onmouseover:a._getEv,onmousemove:a._getEv,onmouseout:a._getEv,onfocus:a._getEv,onblur:a._getEv,onkeypress:a._getEv,onkeydown:a._getEv,onkeyup:a._getEv,onsubmit:a._getEv,onreset:a._getEv,onselect:a._getEv,onchange:a._getEv})})(Element._attributeTranslations.read.values);Prototype.BrowserFeatures.ElementExtensions&&function(){function a(b){b=b.getElementsByTagName("*");for(var c=[],d=0,f;f=b[d];d++)f.tagName!=="!"&&c.push(f);
return c}Element.Methods.down=function(b,c,d){b=$(b);if(arguments.length==1)return b.firstDescendant();return Object.isNumber(c)?a(b)[c]:Element.select(b,c)[d||0]}}()}else if(Prototype.Browser.Gecko&&/rv:1\.8\.0/.test(navigator.userAgent))Element.Methods.setOpacity=function(a,b){a=$(a);a.style.opacity=b==1?0.999999:b===""?"":b<1.0E-5?0:b;return a};else if(Prototype.Browser.WebKit){Element.Methods.setOpacity=function(a,b){a=$(a);a.style.opacity=b==1||b===""?"":b<1.0E-5?0:b;if(b==1)if(a.tagName.toUpperCase()==
"IMG"&&a.width){a.width++;a.width--}else try{var c=document.createTextNode(" ");a.appendChild(c);a.removeChild(c)}catch(d){}return a};Element.Methods.cumulativeOffset=function(a){var b=0,c=0;do{b+=a.offsetTop||0;c+=a.offsetLeft||0;if(a.offsetParent==document.body)if(Element.getStyle(a,"position")=="absolute")break;a=a.offsetParent}while(a);return Element._returnOffset(c,b)}}
if("outerHTML"in document.documentElement)Element.Methods.replace=function(a,b){a=$(a);if(b&&b.toElement)b=b.toElement();if(Object.isElement(b)){a.parentNode.replaceChild(b,a);return a}b=Object.toHTML(b);var c=a.parentNode,d=c.tagName.toUpperCase();if(Element._insertionTranslations.tags[d]){var f=a.next();d=Element._getContentFromAnonymousElement(d,b.stripScripts());c.removeChild(a);f?d.each(function(j){c.insertBefore(j,f)}):d.each(function(j){c.appendChild(j)})}else a.outerHTML=b.stripScripts();
b.evalScripts.bind(b).defer();return a};Element._returnOffset=function(a,b){var c=[a,b];c.left=a;c.top=b;return c};Element._getContentFromAnonymousElement=function(a,b){var c=new Element("div");if(a=Element._insertionTranslations.tags[a]){c.innerHTML=a[0]+b+a[1];for(b=a[2];b--;)c=c.firstChild}else c.innerHTML=b;return $A(c.childNodes)};
Element._insertionTranslations={before:function(a,b){a.parentNode.insertBefore(b,a)},top:function(a,b){a.insertBefore(b,a.firstChild)},bottom:function(a,b){a.appendChild(b)},after:function(a,b){a.parentNode.insertBefore(b,a.nextSibling)},tags:{TABLE:["<table>","</table>",1],TBODY:["<table><tbody>","</tbody></table>",2],TR:["<table><tbody><tr>","</tr></tbody></table>",3],TD:["<table><tbody><tr><td>","</td></tr></tbody></table>",4],SELECT:["<select>","</select>",1]}};
(function(){var a=Element._insertionTranslations.tags;Object.extend(a,{THEAD:a.TBODY,TFOOT:a.TBODY,TH:a.TD})})();Element.Methods.Simulated={hasAttribute:function(a,b){b=Element._attributeTranslations.has[b]||b;a=$(a).getAttributeNode(b);return!!(a&&a.specified)}};Element.Methods.ByTag={};Object.extend(Element,Element.Methods);
(function(a){if(!Prototype.BrowserFeatures.ElementExtensions&&a.__proto__){window.HTMLElement={};window.HTMLElement.prototype=a.__proto__;Prototype.BrowserFeatures.ElementExtensions=true}})(document.createElement("div"));
Element.extend=function(){function a(j){if(typeof window.Element!="undefined"){var p=window.Element.prototype;if(p){var u="_"+(Math.random()+"").slice(2);j=document.createElement(j);p[u]="x";j=j[u]!=="x";delete p[u];return j}}return false}function b(j,p){for(var u in p){var y=p[u];if(Object.isFunction(y)&&!(u in j))j[u]=y.methodize()}}var c=a("object");if(Prototype.BrowserFeatures.SpecificElementExtensions){if(c)return function(j){if(j&&typeof j._extendedByPrototype=="undefined"){var p=j.tagName;
if(p&&/^(?:object|applet|embed)$/i.test(p)){b(j,Element.Methods);b(j,Element.Methods.Simulated);b(j,Element.Methods.ByTag[p.toUpperCase()])}}return j};return Prototype.K}var d={},f=Element.Methods.ByTag;c=Object.extend(function(j){if(!j||typeof j._extendedByPrototype!="undefined"||j.nodeType!=1||j==window)return j;var p=Object.clone(d),u=j.tagName.toUpperCase();f[u]&&Object.extend(p,f[u]);b(j,p);j._extendedByPrototype=Prototype.emptyFunction;return j},{refresh:function(){if(!Prototype.BrowserFeatures.ElementExtensions){Object.extend(d,
Element.Methods);Object.extend(d,Element.Methods.Simulated)}}});c.refresh();return c}();Element.hasAttribute=document.documentElement.hasAttribute?function(a,b){return a.hasAttribute(b)}:Element.Methods.Simulated.hasAttribute;
Element.addMethods=function(a){function b(y){y=y.toUpperCase();Element.Methods.ByTag[y]||(Element.Methods.ByTag[y]={});Object.extend(Element.Methods.ByTag[y],a)}function c(y,D,A){A=A||false;for(var h in y){var s=y[h];if(Object.isFunction(s))if(!A||!(h in D))D[h]=s.methodize()}}function d(y){var D,A={OPTGROUP:"OptGroup",TEXTAREA:"TextArea",P:"Paragraph",FIELDSET:"FieldSet",UL:"UList",OL:"OList",DL:"DList",DIR:"Directory",H1:"Heading",H2:"Heading",H3:"Heading",H4:"Heading",H5:"Heading",H6:"Heading",
Q:"Quote",INS:"Mod",DEL:"Mod",A:"Anchor",IMG:"Image",CAPTION:"TableCaption",COL:"TableCol",COLGROUP:"TableCol",THEAD:"TableSection",TFOOT:"TableSection",TBODY:"TableSection",TR:"TableRow",TH:"TableCell",TD:"TableCell",FRAMESET:"FrameSet",IFRAME:"IFrame"};if(A[y])D="HTML"+A[y]+"Element";if(window[D])return window[D];D="HTML"+y+"Element";if(window[D])return window[D];D="HTML"+y.capitalize()+"Element";if(window[D])return window[D];y=document.createElement(y);return y.__proto__||y.constructor.prototype}
var f=Prototype.BrowserFeatures,j=Element.Methods.ByTag;if(!a){Object.extend(Form,Form.Methods);Object.extend(Form.Element,Form.Element.Methods);Object.extend(Element.Methods.ByTag,{FORM:Object.clone(Form.Methods),INPUT:Object.clone(Form.Element.Methods),SELECT:Object.clone(Form.Element.Methods),TEXTAREA:Object.clone(Form.Element.Methods)})}if(arguments.length==2){var p=a;a=arguments[1]}if(p)Object.isArray(p)?p.each(b):b(p);else Object.extend(Element.Methods,a||{});p=window.HTMLElement?HTMLElement.prototype:
Element.prototype;if(f.ElementExtensions){c(Element.Methods,p);c(Element.Methods.Simulated,p,true)}if(f.SpecificElementExtensions)for(var u in Element.Methods.ByTag){f=d(u);Object.isUndefined(f)||c(j[u],f.prototype)}Object.extend(Element,Element.Methods);delete Element.ByTag;Element.extend.refresh&&Element.extend.refresh();Element.cache={}};
document.viewport={getDimensions:function(){return{width:this.getWidth(),height:this.getHeight()}},getScrollOffsets:function(){return Element._returnOffset(window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft,window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop)}};
(function(a){function b(){if(d.WebKit&&!f.evaluate)return document;if(d.Opera&&window.parseFloat(window.opera.version())<9.5)return document.body;return document.documentElement}function c(u){j||(j=b());p[u]="client"+u;a["get"+u]=function(){return j[p[u]]};return a["get"+u]()}var d=Prototype.Browser,f=document,j,p={};a.getWidth=c.curry("Width");a.getHeight=c.curry("Height")})(document.viewport);Element.Storage={UID:1};
Element.addMethods({getStorage:function(a){if(a=$(a)){if(a===window)a=0;else{if(typeof a._prototypeUID==="undefined")a._prototypeUID=[Element.Storage.UID++];a=a._prototypeUID[0]}Element.Storage[a]||(Element.Storage[a]=$H());return Element.Storage[a]}},store:function(a,b,c){if(a=$(a)){arguments.length===2?Element.getStorage(a).update(b):Element.getStorage(a).set(b,c);return a}},retrieve:function(a,b,c){if(a=$(a)){a=Element.getStorage(a);var d=a.get(b);if(Object.isUndefined(d)){a.set(b,c);d=c}return d}},
clone:function(a,b){if(a=$(a)){a=a.cloneNode(b);a._prototypeUID=void 0;if(b){b=Element.select(a,"*");for(var c=b.length;c--;)b[c]._prototypeUID=void 0}return Element.extend(a)}}});Prototype._original_property=window.Sizzle;
(function(){function a(e,i,o,n,q,m){q=e=="previousSibling"&&!m;for(var v=0,g=n.length;v<g;v++){var l=n[v];if(l){if(q&&l.nodeType===1){l.sizcache=o;l.sizset=v}l=l[e];for(var z=false;l;){if(l.sizcache===o){z=n[l.sizset];break}if(l.nodeType===1&&!m){l.sizcache=o;l.sizset=v}if(l.nodeName===i){z=l;break}l=l[e]}n[v]=z}}}function b(e,i,o,n,q,m){q=e=="previousSibling"&&!m;for(var v=0,g=n.length;v<g;v++){var l=n[v];if(l){if(q&&l.nodeType===1){l.sizcache=o;l.sizset=v}l=l[e];for(var z=false;l;){if(l.sizcache===
o){z=n[l.sizset];break}if(l.nodeType===1){if(!m){l.sizcache=o;l.sizset=v}if(typeof i!=="string"){if(l===i){z=true;break}}else if(u.filter(i,[l]).length>0){z=l;break}}l=l[e]}n[v]=z}}}var c=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^[\]]*\]|['"][^'"]*['"]|[^[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,d=0,f=Object.prototype.toString,j=false,p=true;[0,0].sort(function(){p=false;return 0});var u=function(e,i,o,n){o=o||[];var q=i=i||document;if(i.nodeType!==1&&i.nodeType!==9)return[];
if(!e||typeof e!=="string")return o;for(var m=[],v,g,l,z,F=true,G=B(i),H=e;(c.exec(""),v=c.exec(H))!==null;){H=v[3];m.push(v[1]);if(v[2]){z=v[3];break}}if(m.length>1&&D.exec(e))if(m.length===2&&y.relative[m[0]])g=r(m[0]+m[1],i);else for(g=y.relative[m[0]]?[i]:u(m.shift(),i);m.length;){e=m.shift();if(y.relative[e])e+=m.shift();g=r(e,g)}else{if(!n&&m.length>1&&i.nodeType===9&&!G&&y.match.ID.test(m[0])&&!y.match.ID.test(m[m.length-1])){v=u.find(m.shift(),i,G);i=v.expr?u.filter(v.expr,v.set)[0]:v.set[0]}if(i){v=
n?{expr:m.pop(),set:h(n)}:u.find(m.pop(),m.length===1&&(m[0]==="~"||m[0]==="+")&&i.parentNode?i.parentNode:i,G);g=v.expr?u.filter(v.expr,v.set):v.set;if(m.length>0)l=h(g);else F=false;for(;m.length;){var I=m.pop();v=I;if(y.relative[I])v=m.pop();else I="";if(v==null)v=i;y.relative[I](l,v,G)}}else l=[]}l||(l=g);if(!l)throw"Syntax error, unrecognized expression: "+(I||e);if(f.call(l)==="[object Array]")if(F)if(i&&i.nodeType===1)for(e=0;l[e]!=null;e++){if(l[e]&&(l[e]===true||l[e].nodeType===1&&w(i,l[e])))o.push(g[e])}else for(e=
0;l[e]!=null;e++)l[e]&&l[e].nodeType===1&&o.push(g[e]);else o.push.apply(o,l);else h(l,o);if(z){u(z,q,o,n);u.uniqueSort(o)}return o};u.uniqueSort=function(e){if(x){j=p;e.sort(x);if(j)for(var i=1;i<e.length;i++)e[i]===e[i-1]&&e.splice(i--,1)}return e};u.matches=function(e,i){return u(e,null,null,i)};u.find=function(e,i,o){var n,q;if(!e)return[];for(var m=0,v=y.order.length;m<v;m++){var g=y.order[m];if(q=y.leftMatch[g].exec(e)){var l=q[1];q.splice(1,1);if(l.substr(l.length-1)!=="\\"){q[1]=(q[1]||"").replace(/\\/g,
"");n=y.find[g](q,i,o);if(n!=null){e=e.replace(y.match[g],"");break}}}}n||(n=i.getElementsByTagName("*"));return{set:n,expr:e}};u.filter=function(e,i,o,n){for(var q=e,m=[],v=i,g,l,z=i&&i[0]&&B(i[0]);e&&i.length;){for(var F in y.filter)if((g=y.match[F].exec(e))!=null){var G=y.filter[F],H,I;l=false;if(v==m)m=[];if(y.preFilter[F])if(g=y.preFilter[F](g,v,o,m,n,z)){if(g===true)continue}else l=H=true;if(g)for(var C=0;(I=v[C])!=null;C++)if(I){H=G(I,g,C,v);var E=n^!!H;if(o&&H!=null)if(E)l=true;else v[C]=
false;else if(E){m.push(I);l=true}}if(H!==undefined){o||(v=m);e=e.replace(y.match[F],"");if(!l)return[];break}}if(e==q)if(l==null)throw"Syntax error, unrecognized expression: "+e;else break;q=e}return v};var y=u.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF-]|\\.)+)\s*(?:(\S?=)\s*(['"]*)(.*?)\3|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*-]|\\.)+)/,
CHILD:/:(only|nth|last|first)-child(?:\((even|odd|[\dn+-]*)\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF-]|\\.)+)(?:\((['"]*)((?:\([^\)]+\)|[^\2\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(e){return e.getAttribute("href")}},relative:{"+":function(e,i,o){var n=typeof i==="string",q=n&&!/\W/.test(i);n=n&&!q;if(q&&!o)i=i.toUpperCase();o=0;q=e.length;for(var m;o<q;o++)if(m=e[o]){for(;(m=m.previousSibling)&&
m.nodeType!==1;);e[o]=n||m&&m.nodeName===i?m||false:m===i}n&&u.filter(i,e,true)},">":function(e,i,o){var n=typeof i==="string";if(n&&!/\W/.test(i)){i=o?i:i.toUpperCase();o=0;for(var q=e.length;o<q;o++){var m=e[o];if(m){n=m.parentNode;e[o]=n.nodeName===i?n:false}}}else{o=0;for(q=e.length;o<q;o++)if(m=e[o])e[o]=n?m.parentNode:m.parentNode===i;n&&u.filter(i,e,true)}},"":function(e,i,o){var n=d++,q=b;if(!/\W/.test(i)){var m=i=o?i:i.toUpperCase();q=a}q("parentNode",i,n,e,m,o)},"~":function(e,i,o){var n=
d++,q=b;if(typeof i==="string"&&!/\W/.test(i)){var m=i=o?i:i.toUpperCase();q=a}q("previousSibling",i,n,e,m,o)}},find:{ID:function(e,i,o){if(typeof i.getElementById!=="undefined"&&!o)return(e=i.getElementById(e[1]))?[e]:[]},NAME:function(e,i){if(typeof i.getElementsByName!=="undefined"){var o=[];i=i.getElementsByName(e[1]);for(var n=0,q=i.length;n<q;n++)i[n].getAttribute("name")===e[1]&&o.push(i[n]);return o.length===0?null:o}},TAG:function(e,i){return i.getElementsByTagName(e[1])}},preFilter:{CLASS:function(e,
i,o,n,q,m){e=" "+e[1].replace(/\\/g,"")+" ";if(m)return e;m=0;for(var v;(v=i[m])!=null;m++)if(v)if(q^(v.className&&(" "+v.className+" ").indexOf(e)>=0))o||n.push(v);else if(o)i[m]=false;return false},ID:function(e){return e[1].replace(/\\/g,"")},TAG:function(e,i){for(var o=0;i[o]===false;o++);return i[o]&&B(i[o])?e[1]:e[1].toUpperCase()},CHILD:function(e){if(e[1]=="nth"){var i=/(-?)(\d*)n((?:\+|-)?\d*)/.exec(e[2]=="even"&&"2n"||e[2]=="odd"&&"2n+1"||!/\D/.test(e[2])&&"0n+"+e[2]||e[2]);e[2]=i[1]+(i[2]||
1)-0;e[3]=i[3]-0}e[0]=d++;return e},ATTR:function(e,i,o,n,q,m){i=e[1].replace(/\\/g,"");if(!m&&y.attrMap[i])e[1]=y.attrMap[i];if(e[2]==="~=")e[4]=" "+e[4]+" ";return e},PSEUDO:function(e,i,o,n,q){if(e[1]==="not")if((c.exec(e[3])||"").length>1||/^\w/.test(e[3]))e[3]=u(e[3],null,null,i);else{e=u.filter(e[3],i,o,true^q);o||n.push.apply(n,e);return false}else if(y.match.POS.test(e[0])||y.match.CHILD.test(e[0]))return true;return e},POS:function(e){e.unshift(true);return e}},filters:{enabled:function(e){return e.disabled===
false&&e.type!=="hidden"},disabled:function(e){return e.disabled===true},checked:function(e){return e.checked===true},selected:function(e){return e.selected===true},parent:function(e){return!!e.firstChild},empty:function(e){return!e.firstChild},has:function(e,i,o){return!!u(o[3],e).length},header:function(e){return/h\d/i.test(e.nodeName)},text:function(e){return"text"===e.type},radio:function(e){return"radio"===e.type},checkbox:function(e){return"checkbox"===e.type},file:function(e){return"file"===
e.type},password:function(e){return"password"===e.type},submit:function(e){return"submit"===e.type},image:function(e){return"image"===e.type},reset:function(e){return"reset"===e.type},button:function(e){return"button"===e.type||e.nodeName.toUpperCase()==="BUTTON"},input:function(e){return/input|select|textarea|button/i.test(e.nodeName)}},setFilters:{first:function(e,i){return i===0},last:function(e,i,o,n){return i===n.length-1},even:function(e,i){return i%2===0},odd:function(e,i){return i%2===1},
lt:function(e,i,o){return i<o[3]-0},gt:function(e,i,o){return i>o[3]-0},nth:function(e,i,o){return o[3]-0==i},eq:function(e,i,o){return o[3]-0==i}},filter:{PSEUDO:function(e,i,o,n){var q=i[1],m=y.filters[q];if(m)return m(e,o,i,n);else if(q==="contains")return(e.textContent||e.innerText||"").indexOf(i[3])>=0;else if(q==="not"){i=i[3];o=0;for(n=i.length;o<n;o++)if(i[o]===e)return false;return true}},CHILD:function(e,i){var o=i[1],n=e;switch(o){case "only":case "first":for(;n=n.previousSibling;)if(n.nodeType===
1)return false;if(o=="first")return true;n=e;case "last":for(;n=n.nextSibling;)if(n.nodeType===1)return false;return true;case "nth":o=i[2];var q=i[3];if(o==1&&q==0)return true;i=i[0];var m=e.parentNode;if(m&&(m.sizcache!==i||!e.nodeIndex)){var v=0;for(n=m.firstChild;n;n=n.nextSibling)if(n.nodeType===1)n.nodeIndex=++v;m.sizcache=i}e=e.nodeIndex-q;return o==0?e==0:e%o==0&&e/o>=0}},ID:function(e,i){return e.nodeType===1&&e.getAttribute("id")===i},TAG:function(e,i){return i==="*"&&e.nodeType===1||e.nodeName===
i},CLASS:function(e,i){return(" "+(e.className||e.getAttribute("class"))+" ").indexOf(i)>-1},ATTR:function(e,i){var o=i[1];e=y.attrHandle[o]?y.attrHandle[o](e):e[o]!=null?e[o]:e.getAttribute(o);o=e+"";var n=i[2];i=i[4];return e==null?n==="!=":n==="="?o===i:n==="*="?o.indexOf(i)>=0:n==="~="?(" "+o+" ").indexOf(i)>=0:!i?o&&e!==false:n==="!="?o!=i:n==="^="?o.indexOf(i)===0:n==="$="?o.substr(o.length-i.length)===i:n==="|="?o===i||o.substr(0,i.length+1)===i+"-":false},POS:function(e,i,o,n){var q=y.setFilters[i[2]];
if(q)return q(e,o,i,n)}}},D=y.match.POS;for(var A in y.match){y.match[A]=new RegExp(y.match[A].source+/(?![^\[]*\])(?![^\(]*\))/.source);y.leftMatch[A]=new RegExp(/(^(?:.|\r|\n)*?)/.source+y.match[A].source)}var h=function(e,i){e=Array.prototype.slice.call(e,0);if(i){i.push.apply(i,e);return i}return e};try{Array.prototype.slice.call(document.documentElement.childNodes,0)}catch(s){h=function(e,i){i=i||[];if(f.call(e)==="[object Array]")Array.prototype.push.apply(i,e);else if(typeof e.length==="number")for(var o=
0,n=e.length;o<n;o++)i.push(e[o]);else for(o=0;e[o];o++)i.push(e[o]);return i}}var x;if(document.documentElement.compareDocumentPosition)x=function(e,i){if(!e.compareDocumentPosition||!i.compareDocumentPosition){if(e==i)j=true;return 0}e=e.compareDocumentPosition(i)&4?-1:e===i?0:1;if(e===0)j=true;return e};else if("sourceIndex"in document.documentElement)x=function(e,i){if(!e.sourceIndex||!i.sourceIndex){if(e==i)j=true;return 0}e=e.sourceIndex-i.sourceIndex;if(e===0)j=true;return e};else if(document.createRange)x=
function(e,i){if(!e.ownerDocument||!i.ownerDocument){if(e==i)j=true;return 0}var o=e.ownerDocument.createRange(),n=i.ownerDocument.createRange();o.setStart(e,0);o.setEnd(e,0);n.setStart(i,0);n.setEnd(i,0);e=o.compareBoundaryPoints(Range.START_TO_END,n);if(e===0)j=true;return e};(function(){var e=document.createElement("div"),i="script"+(new Date).getTime();e.innerHTML="<a name='"+i+"'/>";var o=document.documentElement;o.insertBefore(e,o.firstChild);if(document.getElementById(i)){y.find.ID=function(n,
q,m){if(typeof q.getElementById!=="undefined"&&!m)return(q=q.getElementById(n[1]))?q.id===n[1]||typeof q.getAttributeNode!=="undefined"&&q.getAttributeNode("id").nodeValue===n[1]?[q]:undefined:[]};y.filter.ID=function(n,q){var m=typeof n.getAttributeNode!=="undefined"&&n.getAttributeNode("id");return n.nodeType===1&&m&&m.nodeValue===q}}o.removeChild(e);o=e=null})();(function(){var e=document.createElement("div");e.appendChild(document.createComment(""));if(e.getElementsByTagName("*").length>0)y.find.TAG=
function(i,o){o=o.getElementsByTagName(i[1]);if(i[1]==="*"){i=[];for(var n=0;o[n];n++)o[n].nodeType===1&&i.push(o[n]);o=i}return o};e.innerHTML="<a href='#'></a>";if(e.firstChild&&typeof e.firstChild.getAttribute!=="undefined"&&e.firstChild.getAttribute("href")!=="#")y.attrHandle.href=function(i){return i.getAttribute("href",2)};e=null})();document.querySelectorAll&&function(){var e=u,i=document.createElement("div");i.innerHTML="<p class='TEST'></p>";if(!(i.querySelectorAll&&i.querySelectorAll(".TEST").length===
0)){u=function(n,q,m,v){q=q||document;if(!v&&q.nodeType===9&&!B(q))try{return h(q.querySelectorAll(n),m)}catch(g){}return e(n,q,m,v)};for(var o in e)u[o]=e[o];i=null}}();document.getElementsByClassName&&document.documentElement.getElementsByClassName&&function(){var e=document.createElement("div");e.innerHTML="<div class='test e'></div><div class='test'></div>";if(e.getElementsByClassName("e").length!==0){e.lastChild.className="e";if(e.getElementsByClassName("e").length!==1){y.order.splice(1,0,"CLASS");
y.find.CLASS=function(i,o,n){if(typeof o.getElementsByClassName!=="undefined"&&!n)return o.getElementsByClassName(i[1])};e=null}}}();var w=document.compareDocumentPosition?function(e,i){return e.compareDocumentPosition(i)&16}:function(e,i){return e!==i&&(e.contains?e.contains(i):true)},B=function(e){return e.nodeType===9&&e.documentElement.nodeName!=="HTML"||!!e.ownerDocument&&e.ownerDocument.documentElement.nodeName!=="HTML"},r=function(e,i){var o=[],n="",q;for(i=i.nodeType?[i]:i;q=y.match.PSEUDO.exec(e);){n+=
q[0];e=e.replace(y.match.PSEUDO,"")}e=y.relative[e]?e+"*":e;q=0;for(var m=i.length;q<m;q++)u(e,i[q],o);return u.filter(n,o)};window.Sizzle=u})();Prototype.Selector=function(a){function b(f){for(var j=0,p=f.length;j<p;j++)Element.extend(f[j]);return f}function c(f,j){return b(a(f,j||document))}function d(f,j){return a.matches(j,[f]).length==1}return{engine:a,select:c,match:d}}(Sizzle);window.Sizzle=Prototype._original_property;delete Prototype._original_property;
window.$$=function(){var a=$A(arguments).join(", ");return Prototype.Selector.select(a,document)};if(!Prototype.Selector.find)Prototype.Selector.find=function(a,b,c){if(Object.isUndefined(c))c=0;var d=Prototype.Selector.match,f=a.length,j=0,p;for(p=0;p<f;p++)if(d(a[p],b)&&c==j++)return Element.extend(a[p])};
var Form={reset:function(a){a=$(a);a.reset();return a},serializeElements:function(a,b){if(typeof b!="object")b={hash:!!b};else if(Object.isUndefined(b.hash))b.hash=true;var c,d,f=false,j=b.submit;a=a.inject({},function(p,u){if(!u.disabled&&u.name){c=u.name;d=$(u).getValue();if(d!=null&&u.type!="file"&&(u.type!="submit"||!f&&j!==false&&(!j||c==j)&&(f=true)))if(c in p){Object.isArray(p[c])||(p[c]=[p[c]]);p[c].push(d)}else p[c]=d}return p});return b.hash?a:Object.toQueryString(a)}};
Form.Methods={serialize:function(a,b){return Form.serializeElements(Form.getElements(a),b)},getElements:function(a){a=$(a).getElementsByTagName("*");for(var b,c=[],d=Form.Element.Serializers,f=0;b=a[f];f++)c.push(b);return c.inject([],function(j,p){d[p.tagName.toLowerCase()]&&j.push(Element.extend(p));return j})},getInputs:function(a,b,c){a=$(a);a=a.getElementsByTagName("input");if(!b&&!c)return $A(a).map(Element.extend);for(var d=0,f=[],j=a.length;d<j;d++){var p=a[d];b&&p.type!=b||c&&p.name!=c||
f.push(Element.extend(p))}return f},disable:function(a){a=$(a);Form.getElements(a).invoke("disable");return a},enable:function(a){a=$(a);Form.getElements(a).invoke("enable");return a},findFirstElement:function(a){a=$(a).getElements().findAll(function(c){return"hidden"!=c.type&&!c.disabled});var b=a.findAll(function(c){return c.hasAttribute("tabIndex")&&c.tabIndex>=0}).sortBy(function(c){return c.tabIndex}).first();return b?b:a.find(function(c){return/^(?:input|select|textarea)$/i.test(c.tagName)})},
focusFirstElement:function(a){a=$(a);a.findFirstElement().activate();return a},request:function(a,b){a=$(a);b=Object.clone(b||{});var c=b.parameters,d=a.readAttribute("action")||"";if(d.blank())d=window.location.href;b.parameters=a.serialize(true);if(c){if(Object.isString(c))c=c.toQueryParams();Object.extend(b.parameters,c)}if(a.hasAttribute("method")&&!b.method)b.method=a.method;return new Ajax.Request(d,b)}};
Form.Element={focus:function(a){$(a).focus();return a},select:function(a){$(a).select();return a}};
Form.Element.Methods={serialize:function(a){a=$(a);if(!a.disabled&&a.name){var b=a.getValue();if(b!=undefined){var c={};c[a.name]=b;return Object.toQueryString(c)}}return""},getValue:function(a){a=$(a);var b=a.tagName.toLowerCase();return Form.Element.Serializers[b](a)},setValue:function(a,b){a=$(a);var c=a.tagName.toLowerCase();Form.Element.Serializers[c](a,b);return a},clear:function(a){$(a).value="";return a},present:function(a){return $(a).value!=""},activate:function(a){a=$(a);try{a.focus();
if(a.select&&(a.tagName.toLowerCase()!="input"||!/^(?:button|reset|submit)$/i.test(a.type)))a.select()}catch(b){}return a},disable:function(a){a=$(a);a.disabled=true;return a},enable:function(a){a=$(a);a.disabled=false;return a}};var Field=Form.Element,$F=Form.Element.Methods.getValue;
Form.Element.Serializers={input:function(a,b){switch(a.type.toLowerCase()){case "checkbox":case "radio":return Form.Element.Serializers.inputSelector(a,b);default:return Form.Element.Serializers.textarea(a,b)}},inputSelector:function(a,b){if(Object.isUndefined(b))return a.checked?a.value:null;else a.checked=!!b},textarea:function(a,b){if(Object.isUndefined(b))return a.value;else a.value=b},select:function(a,b){if(Object.isUndefined(b))return this[a.type=="select-one"?"selectOne":"selectMany"](a);
else for(var c,d,f=!Object.isArray(b),j=0,p=a.length;j<p;j++){c=a.options[j];d=this.optionValue(c);if(f){if(d==b){c.selected=true;return}}else c.selected=b.include(d)}},selectOne:function(a){var b=a.selectedIndex;return b>=0?this.optionValue(a.options[b]):null},selectMany:function(a){var b,c=a.length;if(!c)return null;var d=0;for(b=[];d<c;d++){var f=a.options[d];f.selected&&b.push(this.optionValue(f))}return b},optionValue:function(a){return Element.extend(a).hasAttribute("value")?a.value:a.text}};
Abstract.TimedObserver=Class.create(PeriodicalExecuter,{initialize:function($super,b,c,d){$super(d,c);this.element=$(b);this.lastValue=this.getValue()},execute:function(){var a=this.getValue();if(Object.isString(this.lastValue)&&Object.isString(a)?this.lastValue!=a:String(this.lastValue)!=String(a)){this.callback(this.element,a);this.lastValue=a}}});Form.Element.Observer=Class.create(Abstract.TimedObserver,{getValue:function(){return Form.Element.getValue(this.element)}});
Form.Observer=Class.create(Abstract.TimedObserver,{getValue:function(){return Form.serialize(this.element)}});
Abstract.EventObserver=Class.create({initialize:function(a,b){this.element=$(a);this.callback=b;this.lastValue=this.getValue();this.element.tagName.toLowerCase()=="form"?this.registerFormCallbacks():this.registerCallback(this.element)},onElementEvent:function(){var a=this.getValue();if(this.lastValue!=a){this.callback(this.element,a);this.lastValue=a}},registerFormCallbacks:function(){Form.getElements(this.element).each(this.registerCallback,this)},registerCallback:function(a){if(a.type)switch(a.type.toLowerCase()){case "checkbox":case "radio":Event.observe(a,
"click",this.onElementEvent.bind(this));break;default:Event.observe(a,"change",this.onElementEvent.bind(this));break}}});Form.Element.EventObserver=Class.create(Abstract.EventObserver,{getValue:function(){return Form.Element.getValue(this.element)}});Form.EventObserver=Class.create(Abstract.EventObserver,{getValue:function(){return Form.serialize(this.element)}});
(function(){function a(g){return e(g,0)}function b(g){return e(g,1)}function c(g){return e(g,2)}function d(g){g=w.extend(g);var l=g.target,z=g.type;if((g=g.currentTarget)&&g.tagName)if(z==="load"||z==="error"||z==="click"&&g.tagName.toLowerCase()==="input"&&g.type==="radio")l=g;if(l.nodeType==Node.TEXT_NODE)l=l.parentNode;return Element.extend(l)}function f(g,l){g=w.element(g);if(!l)return g;for(;g;){if(Prototype.Selector.match(g,l))return Element.extend(g);g=g.parentNode}}function j(g){return{x:p(g),
y:u(g)}}function p(g){var l=document.documentElement,z=document.body||{scrollLeft:0};return g.pageX||g.clientX+(l.scrollLeft||z.scrollLeft)-(l.clientLeft||0)}function u(g){var l=document.documentElement,z=document.body||{scrollTop:0};return g.pageY||g.clientY+(l.scrollTop||z.scrollTop)-(l.clientTop||0)}function y(g){w.extend(g);g.preventDefault();g.stopPropagation();g.stopped=true}function D(g,l,z){var F=Element.retrieve(g,"prototype_event_registry");if(Object.isUndefined(F)){q.push(g);F=Element.retrieve(g,
"prototype_event_registry",$H())}var G=F.get(l);if(Object.isUndefined(G)){G=[];F.set(l,G)}if(G.pluck("handler").include(z))return false;var H;if(l.include(":"))H=function(I){if(Object.isUndefined(I.eventName))return false;if(I.eventName!==l)return false;w.extend(I,g);z.call(g,I)};else if(!r&&(l==="mouseenter"||l==="mouseleave")){if(l==="mouseenter"||l==="mouseleave")H=function(I){w.extend(I,g);for(var C=I.relatedTarget;C&&C!==g;)try{C=C.parentNode}catch(E){C=g}C!==g&&z.call(g,I)}}else H=function(I){w.extend(I,
g);z.call(g,I)};H.handler=z;G.push(H);return H}function A(){for(var g=0,l=q.length;g<l;g++){w.stopObserving(q[g]);q[g]=null}}function h(g,l,z){g=$(g);z=D(g,l,z);if(!z)return g;if(l.include(":"))if(g.addEventListener)g.addEventListener("dataavailable",z,false);else{g.attachEvent("ondataavailable",z);g.attachEvent("onfilterchange",z)}else{l=m(l);g.addEventListener?g.addEventListener(l,z,false):g.attachEvent("on"+l,z)}return g}function s(g,l,z){g=$(g);var F=Element.retrieve(g,"prototype_event_registry");
if(!F)return g;if(!l){F.each(function(C){s(g,C.key)});return g}var G=F.get(l);if(!G)return g;if(!z){G.each(function(C){s(g,l,C.handler)});return g}var H=G.find(function(C){return C.handler===z});if(!H)return g;if(l.include(":"))if(g.removeEventListener)g.removeEventListener("dataavailable",H,false);else{g.detachEvent("ondataavailable",H);g.detachEvent("onfilterchange",H)}else{var I=m(l);g.removeEventListener?g.removeEventListener(I,H,false):g.detachEvent("on"+I,H)}F.set(l,G.without(H));return g}function x(g,
l,z,F){g=$(g);if(Object.isUndefined(F))F=true;if(g==document&&document.createEvent&&!g.dispatchEvent)g=document.documentElement;var G;if(document.createEvent){G=document.createEvent("HTMLEvents");G.initEvent("dataavailable",true,true)}else{G=document.createEventObject();G.eventType=F?"ondataavailable":"onfilterchange"}G.eventName=l;G.memo=z||{};document.createEvent?g.dispatchEvent(G):g.fireEvent(G.eventType,G);return w.extend(G)}var w={KEY_BACKSPACE:8,KEY_TAB:9,KEY_RETURN:13,KEY_ESC:27,KEY_LEFT:37,
KEY_UP:38,KEY_RIGHT:39,KEY_DOWN:40,KEY_DELETE:46,KEY_HOME:36,KEY_END:35,KEY_PAGEUP:33,KEY_PAGEDOWN:34,KEY_INSERT:45,cache:{}},B=document.documentElement,r="onmouseenter"in B&&"onmouseleave"in B,e;if(Prototype.Browser.IE){var i={0:1,1:4,2:2};e=function(g,l){return g.button===i[l]}}else e=Prototype.Browser.WebKit?function(g,l){switch(l){case 0:return g.which==1&&!g.metaKey;case 1:return g.which==1&&g.metaKey;default:return false}}:function(g,l){return g.which?g.which===l+1:g.button===l};w.Methods={isLeftClick:a,
isMiddleClick:b,isRightClick:c,element:d,findElement:f,pointer:j,pointerX:p,pointerY:u,stop:y};var o=Object.keys(w.Methods).inject({},function(g,l){g[l]=w.Methods[l].methodize();return g});if(Prototype.Browser.IE){function n(g){switch(g.type){case "mouseover":g=g.fromElement;break;case "mouseout":g=g.toElement;break;default:return null}return Element.extend(g)}Object.extend(o,{stopPropagation:function(){this.cancelBubble=true},preventDefault:function(){this.returnValue=false},inspect:function(){return"[object Event]"}});
w.extend=function(g,l){if(!g)return false;if(g._extendedByPrototype)return g;g._extendedByPrototype=Prototype.emptyFunction;var z=w.pointer(g);Object.extend(g,{target:g.srcElement||l,relatedTarget:n(g),pageX:z.x,pageY:z.y});return Object.extend(g,o)}}else{w.prototype=window.Event.prototype||document.createEvent("HTMLEvents").__proto__;Object.extend(w.prototype,o);w.extend=Prototype.K}var q=[];Prototype.Browser.IE&&window.attachEvent("onunload",A);Prototype.Browser.WebKit&&window.addEventListener("unload",
Prototype.emptyFunction,false);var m=Prototype.K,v={mouseenter:"mouseover",mouseleave:"mouseout"};r||(m=function(g){return v[g]||g});Object.extend(w,w.Methods);Object.extend(w,{fire:x,observe:h,stopObserving:s});Element.addMethods({fire:x,observe:h,stopObserving:s});Object.extend(document,{fire:x.methodize(),observe:h.methodize(),stopObserving:s.methodize(),loaded:false});if(window.Event)Object.extend(window.Event,w);else window.Event=w})();
(function(){function a(){if(!document.loaded){d&&window.clearTimeout(d);document.loaded=true;document.fire("dom:loaded")}}function b(){if(document.readyState==="complete"){document.stopObserving("readystatechange",b);a()}}function c(){try{document.documentElement.doScroll("left")}catch(f){d=c.defer();return}a()}var d;if(document.addEventListener)document.addEventListener("DOMContentLoaded",a,false);else{document.observe("readystatechange",b);if(window==top)d=c.defer()}Event.observe(window,"load",
a)})();Element.addMethods();Hash.toQueryString=Object.toQueryString;var Toggle={display:Element.toggle};Element.Methods.childOf=Element.Methods.descendantOf;
var Insertion={Before:function(a,b){return Element.insert(a,{before:b})},Top:function(a,b){return Element.insert(a,{top:b})},Bottom:function(a,b){return Element.insert(a,{bottom:b})},After:function(a,b){return Element.insert(a,{after:b})}},$continue=new Error('"throw $continue" is deprecated, use "return" instead'),Position={includeScrollOffsets:false,prepare:function(){this.deltaX=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0;this.deltaY=window.pageYOffset||
document.documentElement.scrollTop||document.body.scrollTop||0},within:function(a,b,c){if(this.includeScrollOffsets)return this.withinIncludingScrolloffsets(a,b,c);this.xcomp=b;this.ycomp=c;this.offset=Element.cumulativeOffset(a);return c>=this.offset[1]&&c<this.offset[1]+a.offsetHeight&&b>=this.offset[0]&&b<this.offset[0]+a.offsetWidth},withinIncludingScrolloffsets:function(a,b,c){var d=Element.cumulativeScrollOffset(a);this.xcomp=b+d[0]-this.deltaX;this.ycomp=c+d[1]-this.deltaY;this.offset=Element.cumulativeOffset(a);
return this.ycomp>=this.offset[1]&&this.ycomp<this.offset[1]+a.offsetHeight&&this.xcomp>=this.offset[0]&&this.xcomp<this.offset[0]+a.offsetWidth},overlap:function(a,b){if(!a)return 0;if(a=="vertical")return(this.offset[1]+b.offsetHeight-this.ycomp)/b.offsetHeight;if(a=="horizontal")return(this.offset[0]+b.offsetWidth-this.xcomp)/b.offsetWidth},cumulativeOffset:Element.Methods.cumulativeOffset,positionedOffset:Element.Methods.positionedOffset,absolutize:function(a){Position.prepare();return Element.absolutize(a)},
relativize:function(a){Position.prepare();return Element.relativize(a)},realOffset:Element.Methods.cumulativeScrollOffset,offsetParent:Element.Methods.getOffsetParent,page:Element.Methods.viewportOffset,clone:function(a,b,c){c=c||{};return Element.clonePosition(b,a,c)}};
if(!document.getElementsByClassName)document.getElementsByClassName=function(a){function b(c){return c.blank()?null:"[contains(concat(' ', @class, ' '), ' "+c+" ')]"}a.getElementsByClassName=Prototype.BrowserFeatures.XPath?function(c,d){d=d.toString().strip();return(d=/\s/.test(d)?$w(d).map(b).join(""):b(d))?document._getElementsByXPath(".//*"+d,c):[]}:function(c,d){d=d.toString().strip();var f=[],j=/\s/.test(d)?$w(d):null;if(!j&&!d)return f;c=$(c).getElementsByTagName("*");d=" "+d+" ";for(var p=
0,u,y;u=c[p];p++)if(u.className&&(y=" "+u.className+" ")&&(y.include(d)||j&&j.all(function(D){return!D.toString().blank()&&y.include(" "+D+" ")})))f.push(Element.extend(u));return f};return function(c,d){return $(d||document.body).getElementsByClassName(c)}}(Element.Methods);Element.ClassNames=Class.create();
Element.ClassNames.prototype={initialize:function(a){this.element=$(a)},_each:function(a){this.element.className.split(/\s+/).select(function(b){return b.length>0})._each(a)},set:function(a){this.element.className=a},add:function(a){this.include(a)||this.set($A(this).concat(a).join(" "))},remove:function(a){this.include(a)&&this.set($A(this).without(a).join(" "))},toString:function(){return $A(this).join(" ")}};Object.extend(Element.ClassNames.prototype,Enumerable);
(function(){window.Selector=Class.create({initialize:function(a){this.expression=a.strip()},findElements:function(a){return Prototype.Selector.select(this.expression,a)},match:function(a){return Prototype.Selector.match(a,this.expression)},toString:function(){return this.expression},inspect:function(){return"#<Selector: "+this.expression+">"}});Object.extend(Selector,{matchElements:Prototype.Selector.filter,findElement:function(a,b,c){c=c||0;for(var d=0,f,j=0,p=a.length;j<p;j++){f=a[j];if(Prototype.Selector.match(f,
b)&&c===d++)return Element.extend(f)}},findChildElements:function(a,b){b=b.toArray().join(", ");return Prototype.Selector.select(b,a||document)}})})();var S2={Version:"2.0.0_a5",Extensions:{}};Function.prototype.optionize=function(){var a=this,b=a.argumentNames(),c=this.length-1,d=function(){var f=$A(arguments),j=typeof f.last()==="object"?f.pop():{},p=[];if(c>0)p=(f.length>0?f:[null]).inGroupsOf(c).flatten().concat(j);return a.apply(this,p)};d.argumentNames=function(){return b};return d};
Function.ABSTRACT=function(){throw"Abstract method. Implement in subclass.";};Object.extend(Number.prototype,{constrain:function(a,b){var c=a<b?a:b;a=a<b?b:a;b=Number(this);if(b<c)b=c;if(b>a)b=a;return b},nearer:function(a,b){var c=Number(this),d=Math.abs(c-a);c=Math.abs(c-b);return d<c?a:b},tween:function(a,b){return this+(a-this)*b}});Object.propertize=function(a,b){return Object.isString(a)?b[a]:a};
S2.CSS={PROPERTY_MAP:{backgroundColor:"color",borderBottomColor:"color",borderBottomWidth:"length",borderLeftColor:"color",borderLeftWidth:"length",borderRightColor:"color",borderRightWidth:"length",borderSpacing:"length",borderTopColor:"color",borderTopWidth:"length",bottom:"length",color:"color",fontSize:"length",fontWeight:"integer",height:"length",left:"length",letterSpacing:"length",lineHeight:"length",marginBottom:"length",marginLeft:"length",marginRight:"length",marginTop:"length",maxHeight:"length",
maxWidth:"length",minHeight:"length",minWidth:"length",opacity:"number",outlineColor:"color",outlineOffset:"length",outlineWidth:"length",paddingBottom:"length",paddingLeft:"length",paddingRight:"length",paddingTop:"length",right:"length",textIndent:"length",top:"length",width:"length",wordSpacing:"length",zIndex:"integer",zoom:"number"},LENGTH:/^(([\+\-]?[0-9\.]+)(em|ex|px|in|cm|mm|pt|pc|\%))|0$/,NUMBER:/([\+-]*\d+\.?\d*)/,__parseStyleElement:document.createElement("div"),parseStyle:function(a){S2.CSS.__parseStyleElement.innerHTML=
'<div style="'+a+'"></div>';var b=S2.CSS.__parseStyleElement.childNodes[0].style,c={};S2.CSS.NUMERIC_PROPERTIES.each(function(d){if(b[d])c[d]=b[d]});S2.CSS.COLOR_PROPERTIES.each(function(d){if(b[d])c[d]=S2.CSS.colorFromString(b[d])});if(Prototype.Browser.IE&&a.include("opacity"))c.opacity=a.match(/opacity:\s*((?:0|1)?(?:\.\d*)?)/)[1];return c},normalizeColor:function(a){if(!a||a=="rgba(0, 0, 0, 0)"||a=="transparent")a="#ffffff";a=S2.CSS.colorFromString(a);return[parseInt(a.slice(1,3),16),parseInt(a.slice(3,
5),16),parseInt(a.slice(5,7),16)]},colorFromString:function(a,b){var c="#",d;if(a.slice(0,4)=="rgb("){a=a.slice(4,a.length-1).split(",");for(d=3;d--;)c+=parseInt(a[2-d]).toColorPart()}else if(a.slice(0,1)=="#"){if(a.length==4)for(d=1;d<4;d++)c+=(a.charAt(d)+a.charAt(d)).toLowerCase();if(a.length==7)c=a.toLowerCase()}return c.length==7?c:b||c},interpolateColor:function(a,b,c){a=S2.CSS.normalizeColor(a);b=S2.CSS.normalizeColor(b);return"#"+[0,1,2].map(function(d){return Math.max(Math.min(a[d].tween(b[d],
c).round(),255),0).toColorPart()}).join("")},interpolateNumber:function(a,b,c){return 1*(a||0).tween(b,c).toFixed(3)},interpolateLength:function(a,b,c){if(!a||parseFloat(a)===0)a="0"+b.gsub(S2.CSS.NUMBER,"");b.scan(S2.CSS.NUMBER,function(d){b=1*d[1]});return a.gsub(S2.CSS.NUMBER,function(d){return(1*parseFloat(d[1]).tween(b,c).toFixed(3)).toString()})},interpolateInteger:function(a,b,c){return parseInt(a).tween(b,c).round()},interpolate:function(a,b,c,d){return S2.CSS["interpolate"+S2.CSS.PROPERTY_MAP[a.camelize()].capitalize()](b,
c,d)},ElementMethods:{getStyles:function(a){var b=document.defaultView.getComputedStyle($(a),null);return S2.CSS.PROPERTIES.inject({},function(c,d){c[d]=b[d];return c})}}};S2.CSS.PROPERTIES=[];for(property in S2.CSS.PROPERTY_MAP)S2.CSS.PROPERTIES.push(property);S2.CSS.NUMERIC_PROPERTIES=S2.CSS.PROPERTIES.findAll(function(a){return!a.endsWith("olor")});S2.CSS.COLOR_PROPERTIES=S2.CSS.PROPERTIES.findAll(function(a){return a.endsWith("olor")});
if(!(document.defaultView&&document.defaultView.getComputedStyle))S2.CSS.ElementMethods.getStyles=function(a){a=$(a);var b=a.currentStyle,c;c=S2.CSS.PROPERTIES.inject({},function(d,f){d[f]=b[f];return d});if(!c.opacity)c.opacity=a.getOpacity();return c};Element.addMethods(S2.CSS.ElementMethods);
S2.FX=function(){function a(u){j[(p+=u)>0?"start":"stop"]()}function b(){d.invoke("render",j.getTimestamp())}function c(u){if(!f){d.push(f=new S2.FX.Queue);S2.FX.DefaultOptions.queue=f;j=u||new S2.FX.Heartbeat;document.observe("effect:heartbeat",b).observe("effect:queued",a.curry(1)).observe("effect:dequeued",a.curry(-1))}}var d=[],f,j,p=0;return{initialize:c,getQueues:function(){return d},addQueue:function(u){d.push(u)},getHeartbeat:function(){return j},setHeartbeat:function(u){j=u}}}();
Object.extend(S2.FX,{DefaultOptions:{transition:"sinusoidal",position:"parallel",fps:60,duration:0.2},elementDoesNotExistError:{name:"ElementDoesNotExistError",message:"The specified DOM element does not exist, but is required for this effect to operate"},parseOptions:function(a){if(Object.isNumber(a))a={duration:a};else if(Object.isFunction(a))a={after:a};else if(Object.isString(a))a={duration:a=="slow"?1:a=="fast"?0.1:0.2};return a||{}}});
S2.FX.Base=Class.create({initialize:function(a){S2.FX.initialize();this.updateWithoutWrappers=this.update;a&&a.queue&&!S2.FX.getQueues().include(a.queue)&&S2.FX.addQueue(a.queue);this.setOptions(a);this.duration=this.options.duration*1E3;this.state="idle";["after","before"].each(function(b){this[b]=function(c){c(this);return this}},this)},setOptions:function(a){a=S2.FX.parseOptions(a);if(!this.options){this.options=Object.extend(Object.extend({},S2.FX.DefaultOptions),a);if(a.tween)this.options.transition=
a.tween}if(this.options.beforeUpdate||this.options.afterUpdate)this.update=this.updateWithoutWrappers.wrap(function(b,c){this.options.beforeUpdate&&this.options.beforeUpdate(this,c);b(c);this.options.afterUpdate&&this.options.afterUpdate(this,c)}.bind(this));if(this.options.transition===false)this.options.transition=S2.FX.Transitions.linear;this.options.transition=Object.propertize(this.options.transition,S2.FX.Transitions)},play:function(a){this.setOptions(a);this.frameCount=0;this.options.queue.add(this);
this.maxFrames=this.options.fps*this.duration/1E3;return this},render:function(a){if(a>=this.startsAt){if(this.state=="idle"){this.options.before&&this.options.before(this);this.setup&&this.setup();this.state="running";this.update(this.options.transition(0));this.frameCount++;return this}if(a>=this.endsAt&&this.state!="finished"){this.update(this.options.transition(1));this.teardown&&this.teardown();this.options.after&&this.options.after(this);this.state="finished"}else if(this.state=="running"){a=
1-(this.endsAt-a)/this.duration;if((this.maxFrames*a).floor()>this.frameCount){this.update(this.options.transition(a));this.frameCount++}}}return this},cancel:function(a){if(!this.state!="running"){this.teardown&&this.teardown();a&&this.options.after&&this.options.after(this);this.state="finished"}},finish:function(){if(!this.state!="running"){this.update(this.options.transition(1));this.cancel(true)}},inspect:function(){return"#<S2.FX:"+[this.state,this.startsAt,this.endsAt].inspect()+">"}});
S2.FX.Element=Class.create(S2.FX.Base,{initialize:function($super,b,c){if(!(this.element=$(b)))throw S2.FX.elementDoesNotExistError;this.operators=[];return $super(c)},animate:function(){var a=$A(arguments),b=a.shift();b=b.charAt(0).toUpperCase()+b.substring(1);this.operators.push(new S2.FX.Operators[b](this,a[0],a[1]||{}))},play:function($super,b,c){if(b)this.element=$(b);return $super(c)},update:function(a){this.operators.invoke("render",a)}});
S2.FX.Heartbeat=Class.create({initialize:function(a){this.options=Object.extend({framerate:Prototype.Browser.MobileSafari?20:60},a);this.beat=this.beat.bind(this)},start:function(){if(!this.heartbeatInterval){this.heartbeatInterval=setInterval(this.beat,1E3/this.options.framerate);this.updateTimestamp()}},stop:function(){if(this.heartbeatInterval){clearInterval(this.heartbeatInterval);this.timestamp=this.heartbeatInterval=null}},beat:function(){this.updateTimestamp();document.fire("effect:heartbeat")},
getTimestamp:function(){return this.timestamp||this.generateTimestamp()},generateTimestamp:function(){return(new Date).getTime()},updateTimestamp:function(){this.timestamp=this.generateTimestamp()}});
S2.FX.Queue=function(){return function(){function a(){return p}function b(){return p.length>0}function c(u){j(u);p.push(u);document.fire("effect:queued",this);return this}function d(u){p=p.without(u);delete u;document.fire("effect:dequeued",this);return this}function f(u){p.invoke("render",u);p.select(function(y){return y.state=="finished"}).each(d);return this}function j(u){var y=u.options.position||"parallel",D=S2.FX.getHeartbeat().getTimestamp();if(y=="end")D=p.without(u).pluck("endsAt").max()||
D;u.startsAt=D+(u.options.delay||0)*1E3;u.endsAt=u.startsAt+(u.options.duration||1)*1E3}var p=[];Object.extend(this,{getEffects:a,active:b,add:c,remove:d,render:f})}}();S2.FX.Attribute=Class.create(S2.FX.Base,{initialize:function($super,b,c,d,f,j){b=Object.isString(b)?$(b):b;this.method=Object.isFunction(j)?j.bind(b):Object.isFunction(b[j])?b[j].bind(b):function(p){b[j]=p};this.to=d;this.from=c;return $super(f)},update:function(a){this.method(this.from.tween(this.to,a))}});
S2.FX.Style=Class.create(S2.FX.Element,{setup:function(){this.animate("style",this.element,{style:this.options.style})}});S2.FX.Operators={};
S2.FX.Operators.Base=Class.create({initialize:function(a,b,c){this.effect=a;this.object=b;this.options=Object.extend({transition:Prototype.K},c)},inspect:function(){return"#<S2.FX.Operators.Base:"+this.lastValue+">"},setup:function(){},valueAt:function(){},applyValue:function(){},render:function(a){a=this.valueAt(this.options.transition(a));this.applyValue(a);this.lastValue=a}});
S2.FX.Operators.Style=Class.create(S2.FX.Operators.Base,{initialize:function($super,b,c,d){$super(b,c,d);this.element=$(this.object);this.style=Object.isString(this.options.style)?S2.CSS.parseStyle(this.options.style):this.options.style;this.tweens=[];for(var f in this.style){b=f.underscore().dasherize();c=this.element.getStyle(b);d=this.style[f];if(c!=d)this.tweens.push([b,S2.CSS.interpolate.curry(b,c,d),f in this.options.propertyTransitions?Object.propertize(this.options.propertyTransitions[f],
S2.FX.Transitions):Prototype.K])}},valueAt:function(a){return this.tweens.map(function(b){return b[0]+":"+b[1](b[2](a))}).join(";")},applyValue:function(a){if(this.currentStyle!=a){this.element.setStyle(a);this.currentStyle=a}}});
S2.FX.Morph=Class.create(S2.FX.Element,{setup:function(){if(this.options.change)this.setupWrappers();else if(this.options.style)this.animate("style",this.destinationElement||this.element,{style:this.options.style,propertyTransitions:this.options.propertyTransitions||{}})},teardown:function(){this.options.change&&this.teardownWrappers()},setupWrappers:function(){var a=this.element.getStyle("float"),b,c,d,f;this.transitionElement=(new Element("div")).setStyle({position:"relative",overflow:"hidden",
"float":a});this.element.setStyle({"float":"none"}).insert({before:this.transitionElement});this.sourceElementWrapper=this.element.cloneWithoutIDs().wrap("div");this.destinationElementWrapper=this.element.wrap("div");this.transitionElement.insert(this.sourceElementWrapper).insert(this.destinationElementWrapper);a=this.sourceElementWrapper.getHeight();b=this.sourceElementWrapper.getWidth();this.options.change();c=this.destinationElementWrapper.getHeight();d=this.destinationElementWrapper.getWidth();
this.outerWrapper=new Element("div");this.transitionElement.insert({before:this.outerWrapper});this.outerWrapper.setStyle({overflow:"hidden",height:a+"px",width:b+"px"}).appendChild(this.transitionElement);f=Math.max(c,a);maxWidth=Math.max(d,b);this.transitionElement.setStyle({height:a+"px",width:b+"px"});this.sourceElementWrapper.setStyle({position:"absolute",height:f+"px",width:maxWidth+"px",top:0,left:0});this.destinationElementWrapper.setStyle({position:"absolute",height:f+"px",width:maxWidth+
"px",top:0,left:0,opacity:0,zIndex:2E3});this.outerWrapper.insert({before:this.transitionElement}).remove();this.animate("style",this.transitionElement,{style:"height:"+c+"px; width:"+d+"px"});this.animate("style",this.destinationElementWrapper,{style:"opacity: 1.0"})},teardownWrappers:function(){var a=this.destinationElementWrapper.down();a&&this.transitionElement.insert({before:a});this.transitionElement.remove()}});
S2.FX.Parallel=Class.create(S2.FX.Base,{initialize:function($super,b,c){this.effects=b||[];return $super(c||{})},setup:function(){this.effects.invoke("setup")},update:function(a){this.effects.invoke("update",a)}});S2.FX.Operators.Scroll=Class.create(S2.FX.Operators.Base,{initialize:function($super,b,c,d){$super(b,c,d);this.start=c.scrollTop;this.end=this.options.scrollTo},valueAt:function(a){return this.start+(this.end-this.start)*a},applyValue:function(a){this.object.scrollTop=a.round()}});
S2.FX.Scroll=Class.create(S2.FX.Element,{setup:function(){this.animate("scroll",this.element,{scrollTo:this.options.to})}});
S2.FX.SlideDown=Class.create(S2.FX.Element,{setup:function(){var a=this.destinationElement||this.element,b=a.getLayout();b={height:b.get("height")+"px",paddingTop:b.get("padding-top")+"px",paddingBottom:b.get("padding-bottom")+"px"};a.setStyle({height:"0",paddingTop:"0",paddingBottom:"0",overflow:"hidden"}).show();this.animate("style",a,{style:b,propertyTransitions:{}})},teardown:function(){(this.destinationElement||this.element).setStyle({height:"",paddingTop:"",paddingBottom:"",overflow:"visible"})}});
S2.FX.SlideUp=Class.create(S2.FX.Morph,{setup:function(){var a=this.destinationElement||this.element;a.getLayout();a.setStyle({overflow:"hidden"});this.animate("style",a,{style:{height:"0px",paddingTop:"0px",paddingBottom:"0px"},propertyTransitions:{}})},teardown:function(){(this.destinationElement||this.element).setStyle({height:"",paddingTop:"",paddingBottom:"",overflow:"visible"}).hide()}});
S2.FX.Transitions={linear:Prototype.K,sinusoidal:function(a){return-Math.cos(a*Math.PI)/2+0.5},reverse:function(a){return 1-a},mirror:function(a,b){b=b||S2.FX.Transitions.sinusoidal;return a<0.5?b(a*2):b(1-(a-0.5)*2)},flicker:function(a){a+=(Math.random()-0.5)/5;return S2.FX.Transitions.sinusoidal(a<0?0:a>1?1:a)},wobble:function(a){return-Math.cos(a*Math.PI*9*a)/2+0.5},pulse:function(a,b){return-Math.cos(a*((b||5)-0.5)*2*Math.PI)/2+0.5},blink:function(a,b){return Math.round(a*(b||5))%2},spring:function(a){return 1-
Math.cos(a*4.5*Math.PI)*Math.exp(-a*6)},none:Prototype.K.curry(0),full:Prototype.K.curry(1)};
(function(){function a(b,c,d,f,j,p){function u(n){return((w*n+B)*n+r)*n}function y(n){return((e*n+i)*n+o)*n}function D(n){return(3*w*n+2*B)*n+r}function A(n){return 1/(200*n)}function h(n,q){return y(x(n,q))}function s(n){return n>=0?n:0-n}function x(n,q){var m,v,g,l;g=n;for(v=0;v<8;v++){l=u(g)-n;if(s(l)<q)return g;m=D(g);if(s(m)<1.0E-6)break;g-=l/m}m=0;v=1;g=n;if(g<m)return m;if(g>v)return v;for(;m<v;){l=u(g);if(s(l-n)<q)return g;if(n>l)m=g;else v=g;g=(v-m)*0.5+m}return g}var w=0,B=0,r=0,e=0,i=0,
o=0;r=3*c;B=3*(f-c)-r;w=1-r-B;o=3*d;i=3*(j-d)-o;e=1-o-i;return h(b,A(p))}S2.FX.cubicBezierTransition=function(b,c,d,f){return function(j){return a(j,b,c,d,f,1)}}})();S2.FX.Transitions.webkitCubic=S2.FX.cubicBezierTransition(0.25,0.1,0.25,1);S2.FX.Transitions.webkitEaseInOut=S2.FX.cubicBezierTransition(0.42,0,0.58,1);
Object.extend(S2.FX.Transitions,{easeInQuad:function(a){return Math.pow(a,2)},easeOutQuad:function(a){return-(Math.pow(a-1,2)-1)},easeInOutQuad:function(a){if((a/=0.5)<1)return 0.5*Math.pow(a,2);return-0.5*((a-=2)*a-2)},easeInCubic:function(a){return Math.pow(a,3)},easeOutCubic:function(a){return Math.pow(a-1,3)+1},easeInOutCubic:function(a){if((a/=0.5)<1)return 0.5*Math.pow(a,3);return 0.5*(Math.pow(a-2,3)+2)},easeInQuart:function(a){return Math.pow(a,4)},easeOutQuart:function(a){return-(Math.pow(a-
1,4)-1)},easeInOutQuart:function(a){if((a/=0.5)<1)return 0.5*Math.pow(a,4);return-0.5*((a-=2)*Math.pow(a,3)-2)},easeInQuint:function(a){return Math.pow(a,5)},easeOutQuint:function(a){return Math.pow(a-1,5)+1},easeInOutQuint:function(a){if((a/=0.5)<1)return 0.5*Math.pow(a,5);return 0.5*(Math.pow(a-2,5)+2)},easeInSine:function(a){return-Math.cos(a*(Math.PI/2))+1},easeOutSine:function(a){return Math.sin(a*(Math.PI/2))},easeInOutSine:function(a){return-0.5*(Math.cos(Math.PI*a)-1)},easeInExpo:function(a){return a==
0?0:Math.pow(2,10*(a-1))},easeOutExpo:function(a){return a==1?1:-Math.pow(2,-10*a)+1},easeInOutExpo:function(a){if(a==0)return 0;if(a==1)return 1;if((a/=0.5)<1)return 0.5*Math.pow(2,10*(a-1));return 0.5*(-Math.pow(2,-10*--a)+2)},easeInCirc:function(a){return-(Math.sqrt(1-a*a)-1)},easeOutCirc:function(a){return Math.sqrt(1-Math.pow(a-1,2))},easeInOutCirc:function(a){if((a/=0.5)<1)return-0.5*(Math.sqrt(1-a*a)-1);return 0.5*(Math.sqrt(1-(a-=2)*a)+1)},easeOutBounce:function(a){return a<1/2.75?7.5625*
a*a:a<2/2.75?7.5625*(a-=1.5/2.75)*a+0.75:a<2.5/2.75?7.5625*(a-=2.25/2.75)*a+0.9375:7.5625*(a-=2.625/2.75)*a+0.984375},easeInBack:function(a){return a*a*(2.70158*a-1.70158)},easeOutBack:function(a){return(a-=1)*a*(2.70158*a+1.70158)+1},easeInOutBack:function(a){var b=1.70158;if((a/=0.5)<1)return 0.5*a*a*(((b*=1.525)+1)*a-b);return 0.5*((a-=2)*a*(((b*=1.525)+1)*a+b)+2)},elastic:function(a){return-1*Math.pow(4,-8*a)*Math.sin((a*6-1)*2*Math.PI/2)+1},swingFromTo:function(a){var b=1.70158;return(a/=0.5)<
1?0.5*a*a*(((b*=1.525)+1)*a-b):0.5*((a-=2)*a*(((b*=1.525)+1)*a+b)+2)},swingFrom:function(a){return a*a*(2.70158*a-1.70158)},swingTo:function(a){return(a-=1)*a*(2.70158*a+1.70158)+1},bounce:function(a){return a<1/2.75?7.5625*a*a:a<2/2.75?7.5625*(a-=1.5/2.75)*a+0.75:a<2.5/2.75?7.5625*(a-=2.25/2.75)*a+0.9375:7.5625*(a-=2.625/2.75)*a+0.984375},bouncePast:function(a){return a<1/2.75?7.5625*a*a:a<2/2.75?2-(7.5625*(a-=1.5/2.75)*a+0.75):a<2.5/2.75?2-(7.5625*(a-=2.25/2.75)*a+0.9375):2-(7.5625*(a-=2.625/2.75)*
a+0.984375)},easeFromTo:function(a){if((a/=0.5)<1)return 0.5*Math.pow(a,4);return-0.5*((a-=2)*Math.pow(a,3)-2)},easeFrom:function(a){return Math.pow(a,4)},easeTo:function(a){return Math.pow(a,0.25)}});Prototype.BrowserFeatures.WebkitCSSTransitions=false;S2.Extensions.webkitCSSTransitions=false;
(function(){try{document.createEvent("WebKitTransitionEvent")}catch(a){return}Prototype.BrowserFeatures.WebkitCSSTransitions=true;S2.Extensions.webkitCSSTransitions=true;if(Prototype.BrowserFeatures.WebkitCSSTransitions){$w("webkitBorderTopLeftRadius webkitBorderTopRightRadius webkitBorderBottomLeftRadius webkitBorderBottomRightRadius webkitBackgroundSize").each(function(b){S2.CSS.PROPERTIES.push(b)});S2.CSS.NUMERIC_PROPERTIES=S2.CSS.PROPERTIES.findAll(function(b){return!b.endsWith("olor")});S2.FX.Operators.WebkitCssTransition=
Class.create(S2.FX.Operators.Base,{initialize:function($super,c,d,f){$super(c,d,f);this.element=$(this.object);if(Object.isString(this.options.style))if(this.options.style.include(":"))this.style=$H(S2.CSS.parseStyle(this.options.style));else{this.element.addClassName(f.style);this.style=$H(this.element.getStyles());this.element.removeClassName(f.style);var j=this.element.getStyles();this.style=this.style.reject(function(p){return p.value==j[p.key]})}else this.style=$H(this.options.style);this.properties=
[];this.targetStyle="";this.style.each(function(p){var u=p[0].underscore().dasherize();p=p[1];this.element.getStyle(u);if(u.startsWith("webkit"))u="-"+u;this.properties.push(u);this.targetStyle+=";"+u+":"+p},this)},render:function(){this.element.style.webkitTransitionProperty=this.properties.join(",");this.element.style.webkitTransitionDuration=(this.effect.duration/1E3).toFixed(3)+"s";for(t in S2.FX.Operators.WebkitCssTransition.TIMING_MAP)if(S2.FX.Transitions[t]===this.effect.options.transition)this.element.style.webkitTransitionTimingFunction=
S2.FX.Operators.WebkitCssTransition.TIMING_MAP[t];this.element.setStyle(this.targetStyle);this.render=Prototype.emptyFunction}});S2.FX.Operators.WebkitCssTransition.TIMING_MAP={linear:"linear",sinusoidal:"ease-in-out"};timingFunctionForTransition=function(b){var c=null;for(t in S2.FX.Operators.WebkitCssTransition.TIMING_MAP)if(S2.FX.Transitions[t]===b)c=S2.FX.Operators.WebkitCssTransition.TIMING_MAP[t];return c};isWebkitCSSTransitionCompatible=function(b){return S2.Extensions.webkitCSSTransitions&&
(b.options.engine||"")!="javascript"&&timingFunctionForTransition(b.options.transition)&&!b.options.propertyTransitions};S2.FX.Morph=Class.create(S2.FX.Morph,{setup:function(){if(this.options.change)this.setupWrappers();else if(this.options.style){this.engine=isWebkitCSSTransitionCompatible(this)?"webkit":"javascript";this.animate(this.engine=="webkit"?"webkitCssTransition":"style",this.destinationElement||this.element,{style:this.options.style,propertyTransitions:this.options.propertyTransitions||
{}})}},render:function($super,c){if(this.engine=="webkit"){if(this.options.before)this.element.beforeStartEffect=this.options.before;if(this.options.after){this.element.afterFinishEffect=this.options.after;delete this.options.after}this.element._effect=this}return $super(c)}});Element.addMethods({morph:function(b,c,d){if(Object.isNumber(d))d={duration:d};return b.effect("morph",Object.extend(d,{style:c}))}.optionize()});S2.FX.webkitTransitionStartEvent=document.observe("webkitTransitionStart",function(b){if((b=
b.element())&&b.beforeStartEffect){b.beforeStartEffect();b.beforeStartEffect=null}});S2.FX.webkitTransitionEndEvent=document.observe("webkitTransitionEnd",function(b){var c=b.element();if(c){(function(){c.style.webkitTransitionDuration=""}).defer();if(c.afterFinishEffect){c.afterFinishEffect();c.afterFinishEffect=null}}})}})();
(function(){function a(h){h=h.match(/^(\d+)%?$/i);if(!h)return null;return Number(h[1])/100}function b(h,s){if(Object.isElement(h)){element=h;h=element.getStyle(s)}if(h===null)return null;if(/^\d+(px)?$/i.test(h))return window.parseInt(h,10);if(/\d/.test(h)&&element.runtimeStyle){s=element.style.left;var x=element.runtimeStyle.left;element.runtimeStyle.left=element.currentStyle.left;element.style.left=h||0;h=element.style.pixelLeft;element.style.left=s;element.runtimeStyle.left=x;return h}if(h.include("%")){h=
a(h);if(s.include("left")||s.include("right")||s.include("width"))x=$(element.parentNode).measure("width");else if(s.include("top")||s.include("bottom")||s.include("height"))x=$(element.parentNode).measure("height");return x*h}return 0}function c(h){for(;h&&h.parentNode;){if(h.getStyle("display")==="none")return false;h=$(h.parentNode)}return true}function d(h){return new Element.Layout(h)}function f(h,s){return $(h).getLayout().get(s)}function j(h){var s=0,x=0;do{s+=h.offsetTop||0;x+=h.offsetLeft||
0;h=h.offsetParent}while(h);return new Element.Offset(x,s)}function p(h){var s=h.getLayout(),x=0,w=0;do{x+=h.offsetTop||0;w+=h.offsetLeft||0;if(h=h.offsetParent){if(D(h))break;if(Element.getStyle(h,"position")!=="static")break}}while(h);w-=s.get("margin-top");x-=s.get("margin-left");return new Element.Offset(w,x)}function u(h){var s=0,x=0;do{s+=h.scrollTop||0;x+=h.scrollLeft||0;h=h.parentNode}while(h);return new Element.Offset(x,s)}function y(h){var s=0,x=0,w=h;do{s+=w.offsetTop||0;x+=w.offsetLeft||
0;if(w.offsetParent==document.body&&Element.getStyle(w,"position")=="absolute")break}while(w=w.offsetParent);w=h;h=w.tagName;var B=Prototype.Browser.Opera;do if(!B||h&&h.toUpperCase()==="BODY"){s-=w.scrollTop||0;x-=w.scrollLeft||0}while(w=w.parentNode);return new Element.Offset(x,s)}function D(h){return $w("BODY HTML").include(h.nodeName.toUpperCase())}var A=Prototype.K;if("currentStyle"in document.documentElement)A=function(h){if(!h.currentStyle.hasLayout)h.style.zoom=1;return h};Element.Layout=
Class.create(Hash,{initialize:function($super,s,x){$super();this.element=$(s);if(x){this._preComputing=true;this._begin()}Element.Layout.PROPERTIES.each(function(w){x?this._compute(w):this._set(w,null)},this);if(x){this._end();this._preComputing=false}},_set:function(h,s){return Hash.prototype.set.call(this,h,s)},set:function(){throw"Properties of Element.Layout are read-only.";},get:function($super,s){var x=$super(s);return x===null?this._compute(s):x},_begin:function(){if(!this._prepared){var h=
this.element;if(!c(h)){h.store("prototype_original_styles",{position:h.style.position||"",width:h.style.width||"",visibility:h.style.visibility||"",display:h.style.display||""});var s=h.getStyle("position"),x=h.getStyle("width");h.setStyle({position:"absolute",visibility:"hidden",display:"block"});var w=h.getStyle("width");s=x&&w===x?window.parseInt(x,10):x&&(s==="absolute"||s==="fixed")?window.parseInt(x,10):$(h.parentNode).getLayout().get("width")-this.get("margin-left")-this.get("border-left")-
this.get("padding-left")-this.get("padding-right")-this.get("border-right")-this.get("margin-right");h.setStyle({width:s+"px"})}this._prepared=true}},_end:function(){var h=this.element,s=h.retrieve("prototype_original_styles");h.store("prototype_original_styles",null);h.setStyle(s);this._prepared=false},_compute:function(h){var s=Element.Layout.COMPUTATIONS;if(!(h in s))throw"Property not found.";s=s[h].call(this,this.element);this._set(h,s);return s}});Object.extend(Element.Layout,{PROPERTIES:$w("height width top left right bottom border-left border-right border-top border-bottom padding-left padding-right padding-top padding-bottom margin-top margin-bottom margin-left margin-right padding-box-width padding-box-height border-box-width border-box-height margin-box-width margin-box-height"),
COMPOSITE_PROPERTIES:$w("padding-box-width padding-box-height margin-box-width margin-box-height border-box-width border-box-height"),COMPUTATIONS:{height:function(){this._preComputing||this._begin();var h=this.get("border-box-height");if(h<=0)return 0;var s=this.get("border-top"),x=this.get("border-bottom"),w=this.get("padding-top"),B=this.get("padding-bottom");this._preComputing||this._end();return h-s-x-w-B},width:function(){this._preComputing||this._begin();var h=this.get("border-box-width");
if(h<=0)return 0;var s=this.get("border-left"),x=this.get("border-right"),w=this.get("padding-left"),B=this.get("padding-right");this._preComputing||this._end();return h-s-x-w-B},"padding-box-height":function(){var h=this.get("height"),s=this.get("padding-top"),x=this.get("padding-bottom");return h+s+x},"padding-box-width":function(){var h=this.get("width"),s=this.get("padding-left"),x=this.get("padding-right");return h+s+x},"border-box-height":function(h){return h.offsetHeight},"border-box-width":function(h){return h.offsetWidth},
"margin-box-height":function(){var h=this.get("border-box-height"),s=this.get("margin-top"),x=this.get("margin-bottom");if(h<=0)return 0;return h+s+x},"margin-box-width":function(){var h=this.get("border-box-width"),s=this.get("margin-left"),x=this.get("margin-right");if(h<=0)return 0;return h+s+x},top:function(h){return h.positionedOffset().top},bottom:function(h){var s=h.positionedOffset();h=h.getOffsetParent().measure("height");var x=this.get("border-box-height");return h-x-s.top},left:function(h){return h.positionedOffset().left},
right:function(h){var s=h.positionedOffset();h=h.getOffsetParent().measure("width");var x=this.get("border-box-width");return h-x-s.left},"padding-top":function(h){return b(h,"paddingTop")},"padding-bottom":function(h){return b(h,"paddingBottom")},"padding-left":function(h){return b(h,"paddingLeft")},"padding-right":function(h){return b(h,"paddingRight")},"border-top":function(h){return Object.isNumber(h.clientTop)?h.clientTop:b(h,"borderTopWidth")},"border-bottom":function(h){return Object.isNumber(h.clientBottom)?
h.clientBottom:b(h,"borderBottomWidth")},"border-left":function(h){return Object.isNumber(h.clientLeft)?h.clientLeft:b(h,"borderLeftWidth")},"border-right":function(h){return Object.isNumber(h.clientRight)?h.clientRight:b(h,"borderRightWidth")},"margin-top":function(h){return b(h,"marginTop")},"margin-bottom":function(h){return b(h,"marginBottom")},"margin-left":function(h){return b(h,"marginLeft")},"margin-right":function(h){return b(h,"marginRight")}}});"getBoundingClientRect"in document.documentElement&&
Object.extend(Element.Layout.COMPUTATIONS,{right:function(h){var s=A(h.getOffsetParent());h=h.getBoundingClientRect();return(s.getBoundingClientRect().right-h.right).round()},bottom:function(h){var s=A(h.getOffsetParent());h=h.getBoundingClientRect();return(s.getBoundingClientRect().bottom-h.bottom).round()}});Element.Offset=Class.create({initialize:function(h,s){this.left=h.round();this.top=s.round();this[0]=this.left;this[1]=this.top},relativeTo:function(h){return new Element.Offset(this.left-h.left,
this.top-h.top)},inspect:function(){return"#<Element.Offset left: #{left} top: #{top}>".interpolate(this)},toString:function(){return"[#{left}, #{top}]".interpolate(this)},toArray:function(){return[this.left,this.top]}});Element.addMethods({getLayout:d,measure:f,cumulativeOffset:j,positionedOffset:p,cumulativeScrollOffset:u,viewportOffset:y});"getBoundingClientRect"in document.documentElement&&Element.addMethods({viewportOffset:function(h){h=$(h);h=h.getBoundingClientRect();return new Element.Offset(h.left,
h.top)},positionedOffset:function(h){h=$(h);var s=h.getOffsetParent();if(s.nodeName.toUpperCase()==="HTML")return p(h);var x=h.viewportOffset();s=D(s)?y(s):s.viewportOffset();x=x.relativeTo(s);s=h.getLayout();h=x.top-s.get("margin-top");x=x.left-s.get("margin-left");return new Element.Offset(x,h)}})})();S2.UI={};Object.deepExtend=function(a,b){for(var c in b)if(b[c]&&b[c].constructor&&b[c].constructor===Object){a[c]=a[c]||{};arguments.callee(a[c],b[c])}else a[c]=b[c];return a};S2.UI.Mixin={};
S2.UI.Mixin.Configurable={setOptions:function(a){if(!this.options){this.options={};var b=this.constructor;if(b.superclass){for(var c=[],d=b;d=d.superclass;)c.push(d);c=c.reverse();d=0;for(var f=c.length;d<f;d++)Object.deepExtend(this.options,c[d].DEFAULT_OPTIONS||{})}Object.deepExtend(this.options,b.DEFAULT_OPTIONS||{})}return Object.deepExtend(this.options,a||{})}};
S2.UI.Mixin.Trackable={register:function(){var a=this.constructor;if(!a.instances)a.instances=[];a.instances.include(this)||a.instances.push(this);Object.isFunction(a.onRegister)&&a.onRegister.call(a,this)},unregister:function(){var a=this.constructor;a.instances=a.instances.without(this);Object.isFunction(a.onRegister)&&a.onUnregister.call(a,this)}};
S2.UI.Mixin.Shim={__SHIM_TEMPLATE:new Template("<iframe frameborder='0' tabindex='-1' src='javascript:false;' style='display:block;position:absolute;z-index:-1;overflow:hidden; filter:Alpha(Opacity=\"0\");top:expression(((parseInt(this.parentNode.currentStyle.borderTopWidth)||0)*-1)+'px');left:expression(((parseInt(this.parentNode.currentStyle.borderLeftWidth)||0)*-1)+'px');width:expression(this.parentNode.offsetWidth+'px');height:expression(this.parentNode.offsetHeight+'px');' id='#{0}'></iframe>"),createShim:function(a){if(this.__shim_isie6=
Prototype.Browser.IE&&/6.0/.test(navigator.userAgent))if(a=$(a||this.element)){this.__shimmed=a;var b=a.identify()+"_iframeshim",c=$(b);c&&c.remove();a.insert({top:this.__SHIM_TEMPLATE.evaluate([b])});this.__shim_id=b}},adjustShim:function(){if(this.__shim_isie6){var a=this.__shimmed.down("iframe#"+this.__shim_id),b=this.__shimmed;a&&a.setStyle({width:b.offsetWidth+"px",height:b.offsetHeight+"px"})}},destroyShim:function(){if(this.__shim_isie6){var a=this.__shimmed.down("iframe#"+this.__shim_id);
a&&a.remove();this.__shimmed=null}}};
Object.extend(S2.UI,{addClassNames:function(a,b){if(Object.isElement(a))a=[a];if(Object.isString(b))b=b.split(" ");for(var c,d,f=0,j;j=a[f];f++)for(c=0;d=b[c];c++)j.addClassName(d);return a},removeClassNames:function(a,b){if(Object.isElement(a))a=[a];if(Object.isString(b))b=b.split(" ");for(var c,d,f=0,j;j=a[f];f++)for(c=0;d=b[c];c++)j.removeClassName(d)},FOCUSABLE_ELEMENTS:$w("input select textarea button object"),isFocusable:function(a){var b=a.nodeName.toLowerCase(),c=a.readAttribute("tabIndex"),
d=false;d=S2.UI.FOCUSABLE_ELEMENTS.include(b)?!a.disabled:$w("a area").include(b)?a.href||c&&!isNaN(c):c&&!isNaN(c);return!!d&&S2.UI.isVisible(a)},findFocusables:function(a){return $(a).descendants().select(S2.UI.isFocusable)},isVisible:function(a){for(a=$(a);a&&a.parentNode;){var b=a.getStyle("display"),c=a.getStyle("visibility");if(b==="none"||c==="hidden")return false;a=$(a.parentNode)}return true},makeVisible:function(a,b){if(Object.isElement(a))a=[a];b=b?"visible":"hidden";for(var c=0,d;d=a[c];c++)d.setStyle({visibility:b});
return a},modifierUsed:function(a){return a.metaKey||a.ctrlKey||a.altKey}});
(function(){function a(c){var d=Event.element(c);if(d)for(var f=0,j;j=b[f];f++)if(d===j||d.descendantOf(j)){Event.stop(c);break}}var b=[];if(document.attachEvent)document.onselectstart=a.bindAsEventListener(window);else document.observe("mousedown",a);Object.extend(S2.UI,{enableTextSelection:function(c){c.setStyle({"-moz-user-select":"","-webkit-user-select":""});b=b.without(c);return c},disableTextSelection:function(c){c.setStyle({"-moz-user-select":"none","-webkit-user-select":"none"});b.include(c)||
b.push(c);return c}})})();
S2.UI.Behavior=Class.create(S2.UI.Mixin.Configurable,{initialize:function(a,b){function c(j){return j.startsWith("on")||j.include("/on")}this.element=a;this.setOptions(b);Object.extend(this,b);this._observers={};var d;for(var f in this)if(c(f)){b=f.split("/");a=b.length===2?this[b.first()]||this.element:this.element;b=b.last();d=this._observers[b]=this[f].bind(this);a.observe(b.substring(2),d)}},destroy:function(){var a=this.options.proxy||this.element,b;for(var c in this._observers){b=this._observers[c];
a.stopObserving(c.substring(2),b)}}});
Object.extend(S2.UI,{addBehavior:function(a,b,c){var d=arguments.callee;if(Object.isArray(a))a.each(function(j){d(j,b,c)});else if(Object.isArray(b))b.each(function(j){d(a,j,c)});else{var f=new b(a,c||{});$(a).retrieve("ui.behaviors",[]).push(f)}},removeBehavior:function(a,b){var c=arguments.callee;if(Object.isArray(a))a.each(function(u){c(u,b)});else if(Object.isArray(b))b.each(function(u){c(a,u)});else{for(var d=$(a).retrieve("ui.behaviors",[]),f=[],j=0,p;p=d[j];j++)if(!(!p instanceof b)){p.destroy();
f.push(p)}$(a).set("ui.behaviors",d.without(f))}},getBehavior:function(a,b){a=$(a);a=a.retrieve("ui.behaviors",[]);for(var c=0,d=a.length,f;c<d;c++){f=a[c];if(f.constructor===b)return f}return null}});
S2.UI.Behavior.Drag=Class.create(S2.UI.Behavior,{initialize:function($super,b,c){this.__onmousemove=this._onmousemove.bind(this);$super(b,c);this.element.addClassName("ui-draggable")},destroy:function($super){this.element.removeClassName("ui-draggable");$super()},"handle/onmousedown":function(a){var b=this.element;this._startPointer=a.pointer();this._startPosition={left:window.parseInt(b.getStyle("left"),10),top:window.parseInt(b.getStyle("top"),10)};document.observe("mousemove",this.__onmousemove)},
"handle/onmouseup":function(){this._startPosition=this._startPointer=null;document.stopObserving("mousemove",this.__onmousemove)},_onmousemove:function(a){a=a.pointer();if(this._startPointer){a={x:a.x-this._startPointer.x,y:a.y-this._startPointer.y};this.element.setStyle({left:this._startPosition.left+a.x+"px",top:this._startPosition.top+a.y+"px"})}}});
S2.UI.Behavior.Focus=Class.create(S2.UI.Behavior,{onfocus:function(){this.element.hasClassName("ui-state-disabled")||this.element.addClassName("ui-state-focus")},onblur:function(){this.element.hasClassName("ui-state-disabled")||this.element.removeClassName("ui-state-focus")}});
S2.UI.Behavior.Hover=Class.create(S2.UI.Behavior,{onmouseenter:function(){this.element.hasClassName("ui-state-disabled")||this.element.addClassName("ui-state-hover")},onmouseleave:function(){this.element.hasClassName("ui-state-disabled")||this.element.removeClassName("ui-state-hover")}});S2.UI.Behavior.Resize=Class.create(S2.UI.Behavior,{initialize:function(){}});
S2.UI.Behavior.Down=Class.create(S2.UI.Behavior,{onmousedown:function(){this._down=true;this.element.hasClassName("ui-state-disabled")||this.element.addClassName("ui-state-down")},onmouseup:function(){this._down=false;this.element.hasClassName("ui-state-disabled")||this.element.removeClassName("ui-state-down")},onmouseleave:function(a){return this.onmouseup(a)},onmouseenter:function(a){if(this._down)return this.onmousedown(a)}});
(function(a){a.Base=Class.create(a.Mixin.Configurable,{NAME:"S2.UI.Base",addObservers:Function.ABSTRACT,removeObservers:Function.ABSTRACT,destroy:function(){this.removeObservers()},toElement:function(){return this.element},inspect:function(){return"#<#{NAME}>".interpolate(this)}})})(S2.UI);Object.extend(Event,{KEY_SPACE:32});
(function(a){a.Accordion=Class.create(a.Base,{NAME:"S2.UI.Accordion",initialize:function(b,c){this.element=$(b);var d=this.setOptions(c);a.addClassNames(this.element,"ui-accordion ui-widget ui-helper-reset");if(this.element.nodeName.toUpperCase()==="UL"){b=this.element.childElements().grep(new Selector("li"));a.addClassNames(b,"ui-accordion-li-fix")}this.headers=this.element.select(d.headerSelector);if(!(!this.headers||this.headers.length===0)){a.addClassNames(this.headers,"ui-accordion-header ui-helper-reset ui-state-default ui-corner-all");
a.addBehavior(this.headers,[a.Behavior.Hover,a.Behavior.Focus]);this.content=this.headers.map(function(f){return f.next()});a.addClassNames(this.content,"ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom");this.headers.each(function(f){var j=new Element("span");a.addClassNames(j,"ui-icon "+d.icons.header);f.insert({top:j})});this._markActive(d.active||this.headers.first(),false);this.element.writeAttribute({role:"tablist","aria-multiselectable":d.multiple.toString()});this.headers.invoke("writeAttribute",
"role","tab");this.content.invoke("writeAttribute","role","tabpanel");this.headers.map(function(f){return f.down("a")}).invoke("observe","click",function(f){f.preventDefault()});this.observers={click:this.click.bind(this),keypress:this.keypress.bind(this)};this.addObservers()}},addObservers:function(){this.headers.invoke("observe","click",this.observers.click);Prototype.Browser.WebKit?this.headers.invoke("observe","keydown",this.observers.keypress):this.headers.invoke("observe","keypress",this.observers.keypress)},
click:function(b){(b=b.findElement(this.options.headerSelector))&&this.headers.include(b)&&this._toggleActive(b)},keypress:function(b){if(!(b.shiftKey||b.metaKey||b.altKey||b.ctrlKey)){var c=b.findElement(this.options.headerSelector);switch(b.keyCode===0?b.charCode:b.keyCode){case Event.KEY_SPACE:this._toggleActive(c);b.stop();return;case Event.KEY_DOWN:case Event.KEY_RIGHT:this._focusHeader(c,1);b.stop();return;case Event.KEY_UP:case Event.KEY_LEFT:this._focusHeader(c,-1);b.stop();return;case Event.KEY_HOME:this._focusHeader(this.headers.first());
b.stop();return;case Event.KEY_END:this._focusHeader(this.headers.last());b.stop();return}}},_focusHeader:function(b,c){if(Object.isNumber(c)){var d=this.headers.indexOf(b);d+=c;if(d>this.headers.length-1)d=this.headers.length-1;else if(d<0)d=0;b=this.headers[d]}(function(){b.down("a").focus()}).defer()},_toggleActive:function(b){if(b.hasClassName("ui-state-active")){if(this.options.multiple){this._removeActive(b);this._activatePanel(null,b.next(),true)}}else this._markActive(b)},_removeActive:function(b){var c=
this.options;a.removeClassNames(b,"ui-state-active ui-corner-top");a.addClassNames(b,"ui-state-default ui-corner-all");b.writeAttribute("aria-expanded","false");b=b.down(".ui-icon");b.removeClassName(c.icons.headerSelected);b.addClassName(c.icons.header)},_markActive:function(b,c){if(Object.isUndefined(c))c=true;var d=this.options,f=null;if(!d.multiple){f=this.element.down(".ui-accordion-content-active");this.headers.each(this._removeActive.bind(this))}if(b){a.removeClassNames(b,"ui-state-default ui-corner-all");
a.addClassNames(b,"ui-state-active ui-corner-top");b.writeAttribute("aria-expanded","true");this._activatePanel(b.next(),f,c);c=b.down(".ui-icon");c.removeClassName(d.icons.header);c.addClassName(d.icons.headerSelected);return b}},_activatePanel:function(b,c,d){if(d)this.options.transition(b,c);else{c&&c.removeClassName("ui-accordion-content-active");b&&b.addClassName("ui-accordion-content-active")}}});Object.extend(a.Accordion,{DEFAULT_OPTIONS:{multiple:false,headerSelector:"h3",icons:{header:"ui-icon-triangle-1-e",
headerSelected:"ui-icon-triangle-1-s"},transition:function(b,c){var d=[],f;if(c){f=new S2.FX.SlideUp(c,{duration:0.2,after:function(){c.removeClassName("ui-accordion-content-active")}});d.push(f)}if(b){f=new S2.FX.SlideDown(b,{duration:0.2,before:function(){b.addClassName("ui-accordion-content-active")}});d.push(f)}d.invoke("play")}}})})(S2.UI);
(function(a){a.Button=Class.create(a.Base,{NAME:"S2.UI.Button",initialize:function(b,c){this.element=$(b);this.element.store("ui.button",this);b=this.setOptions(c);a.addClassNames(this.element,"ui-state-default ui-corner-all");a.addBehavior(this.element,[a.Behavior.Hover,a.Behavior.Focus,a.Behavior.Down]);b.primary&&this.element.addClassName("ui-priority-primary");this.element.writeAttribute("role","button");this.enabled=true;this.setEnabled(this.element.disabled===true||!this.element.hasClassName("ui-state-disabled"))},
setEnabled:function(b){if(this.enabled!==b){(this.enabled=b)?this.element.removeClassName("ui-state-disabled"):this.element.addClassName("ui-state-disabled");this.element.disabled=!b}},toElement:function(){return this.element},toHTML:function(){return this.element.toHTML()},toString:function(){return this.element.toHTML()},inspect:function(){return this.element.inspect()}});Object.extend(a.Button,{DEFAULT_OPTIONS:{primary:false}})})(S2.UI);
(function(a){a.Tabs=Class.create(a.Base,{NAME:"S2.UI.Tabs",initialize:function(b,c){this.element=$(b);a.addClassNames(this.element,"ui-widget ui-widget-content ui-tabs ui-corner-all");this.setOptions(c);b=this.options;this.anchors=[];this.panels=[];this.list=this.element.down("ul");this.list.cleanWhitespace();this.nav=this.list;a.addClassNames(this.nav,"ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all");this.tabs=this.list.select("li");a.addClassNames(this.tabs,"ui-state-default ui-corner-top");
a.addBehavior(this.tabs,[a.Behavior.Hover,a.Behavior.Down]);this.element.writeAttribute({role:"tablist","aria-multiselectable":"false"});this.tabs.each(function(f){var j=f.down("a");if(j){var p=j.readAttribute("href");if(p.include("#")){p=p.split("#").last();p=$(p);f.writeAttribute("tabIndex","0");if(p){p.store("ui.tab",f);f.store("ui.panel",p);this.anchors.push(j);this.panels.push(p)}}}},this);this.anchors.invoke("writeAttribute","role","tab");this.panels.invoke("writeAttribute","role","tabpanel");
this.tabs.first().addClassName("ui-position-first");this.tabs.last().addClassName("ui-position-last");a.addClassNames(this.panels,"ui-tabs-panel ui-tabs-hide ui-widget-content ui-corner-bottom");this.observers={onKeyPress:this.onKeyPress.bind(this),onTabClick:this.onTabClick.bind(this)};this.addObservers();c=window.location.hash.substring(1);var d;c.empty()||(d=$(c));this.setSelectedTab(d&&this.panels.include(d)?d.retrieve("ui.tab"):b.selectedTab?$(b.selectedTab):this.tabs.first())},addObservers:function(){this.anchors.invoke("observe",
"click",this.observers.onTabClick);this.tabs.invoke("observe","keypress",this.observers.onKeyPress)},_setSelected:function(b){b=$(b);var c=b.retrieve("ui.tab"),d=this.list.down(".ui-tabs-selected"),f=d?d.retrieve("ui.panel"):null;a.removeClassNames(this.tabs,"ui-tabs-selected ui-state-active");a.addClassNames(this.tabs,"ui-state-default");c.removeClassName("ui-state-default").addClassName("ui-tabs-selected ui-state-active");this.element.fire("ui:tabs:change",{from:{tab:d,panel:f},to:{tab:c,panel:b}});
this.options.panel.transition(f,b)},setSelectedTab:function(b){this.setSelectedPanel(b.retrieve("ui.panel"))},setSelectedPanel:function(b){this._setSelected(b.readAttribute("id"))},onTabClick:function(b){b.stop();b.findElement("a");this.setSelectedTab(b.findElement("li"))},onKeyPress:function(b){if(!a.modifierUsed(b)){var c=b.findElement("li");switch(b.keyCode||b.charCode){case Event.KEY_SPACE:case Event.KEY_RETURN:this.setSelectedTab(c);b.stop();return;case Event.KEY_UP:case Event.KEY_LEFT:this._focusTab(c,
-1);return;case Event.KEY_DOWN:case Event.KEY_RIGHT:this._focusTab(c,1);return}}},_focusTab:function(b,c){if(Object.isNumber(c)){var d=this.tabs.indexOf(b);d+=c;if(d>this.tabs.length-1)d=this.tabs.length-1;else if(d<0)d=0;b=this.tabs[d]}(function(){b.focus()}).defer()}});Object.extend(a.Tabs,{DEFAULT_OPTIONS:{panel:{transition:function(b,c){b&&b.addClassName("ui-tabs-hide");c.removeClassName("ui-tabs-hide")}}}})})(S2.UI);
(function(a){a.Overlay=Class.create(a.Base,a.Mixin.Trackable,a.Mixin.Shim,{NAME:"S2.UI.Overlay",initialize:function(b){this.setOptions(b);this.element=new Element("div",{"class":"ui-widget-overlay"});this.register();this.createShim();this.adjustShim();this.constructor.onResize()},destroy:function(){this.element.remove();this.unregister()},toElement:function(){return this.element}});Object.extend(a.Overlay,{onRegister:function(){if(this.instances.length===1){this._resizeObserver=this._resizeObserver||
this.onResize.bind(this);Event.observe(window,"resize",this._resizeObserver);Event.observe(window,"scroll",this._resizeObserver)}},onUnregister:function(){if(this.instances.length===0){Event.stopObserving(window,"resize",this._resizeObserver);Event.stopObserving(window,"scroll",this._resizeObserver)}},onResize:function(){var b=document.viewport.getDimensions(),c=document.viewport.getScrollOffsets();this.instances.each(function(d){d.element.setStyle({width:b.width+"px",height:b.height+"px",left:c.left+
"px",top:c.top+"px"})});(function(){this.instances.invoke("adjustShim")}).bind(this).defer()}})})(S2.UI);
(function(a){a.Dialog=Class.create(a.Base,{NAME:"S2.UI.Dialog",initialize:function(b,c){if(Object.isElement(b))b=$(b);else{c=b;b=null}c=this.setOptions(c);this.element=b||new Element("div");a.addClassNames(this.element,"ui-dialog ui-widget ui-widget-content ui-corner-all");this.element.hide().setStyle({position:"absolute",overflow:"hidden",zIndex:c.zIndex,outline:"0"});this.element.writeAttribute({tabIndex:"-1",role:"dialog"});this.content=c.content?Object.isElement(c.content)?c.content:(new Element("div")).update(c.content):
new Element("div");a.addClassNames(this.content,"ui-dialog-content ui-widget-content");this.element.insert(this.content);this.titleBar=this.options.titleBar||new Element("div");a.addClassNames(this.titleBar,"ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix");this.element.insert({top:this.titleBar});this.closeButton=new Element("a",{href:"#"});a.addClassNames(this.closeButton,"ui-dialog-titlebar-close ui-corner-all");new a.Button(this.closeButton);this.closeButton.observe("mousedown",
Event.stop);this.closeButton.observe("click",function(d){d.stop();this.close(false)}.bind(this));this.titleBar.insert(this.closeButton);this.closeText=new Element("span");a.addClassNames(this.closeText,"ui-icon ui-icon-closethick");this.closeButton.insert(this.closeText);this.titleText=new Element("span",{"class":"ui-dialog-title"});this.titleText.update(this.options.title).identify();this.element.writeAttribute("aria-labelledby",this.titleText.readAttribute("id"));this.titleBar.insert({top:this.titleText});
a.disableTextSelection(this.element);this.options.draggable&&a.addBehavior(this.element,a.Behavior.Drag,{handle:this.titleBar});(b=this.options.buttons)&&b.length&&this._createButtons();this.observers={keypress:this.keypress.bind(this)}},toElement:function(){return this.element},_createButtons:function(){var b=this.options.buttons;this.buttonPane&&this.buttonPane.remove();this.buttonPane=new Element("div");a.addClassNames(this.buttonPane,"ui-dialog-buttonpane ui-widget-content ui-helper-clearfix");
b.each(function(c){var d=new Element("button",{type:"button"});a.addClassNames(d,"ui-state-default ui-corner-all");c.primary&&d.addClassName("ui-priority-primary");c.secondary&&d.addClassName("ui-priority-secondary");d.update(c.label);new a.Button(d);d.observe("click",c.action.bind(this,this));this.buttonPane.insert(d)},this);this.element.insert(this.buttonPane)},_position:function(){var b=document.viewport.getDimensions(),c=this.element;c={width:parseInt(c.getStyle("width"),10),height:parseInt(c.getStyle("height"),
10)};b={left:(b.width/2-c.width/2).round(),top:(b.height/2-c.height/2).round()};c=document.viewport.getScrollOffsets();b.left+=c.left;b.top+=c.top;this.element.setStyle({left:b.left+"px",top:b.top+"px"})},open:function(){if(!this._isOpen)if(!this.element.fire("ui:dialog:before:open",{dialog:this}).stopped){var b=this.options;this.overlay=b.modal?new a.Overlay:null;$(document.body).insert(this.overlay);$(document.body).insert(this.element);this.element.show();this._position();this.focusables=a.findFocusables(this.element);
b.submitForms||this.content.select("form").invoke("observe","submit",Event.stop);var c=this.focusables.without(this.closeButton),d=b.focus;b=false;if(d==="first"){c.first().focus();b=true}else if(d==="last"){c.last().focus();b=true}else if(Object.isElement(d)){d.focus();b=true}else if(this.buttonPane)if(d=this.buttonPane.down(".ui-priority-primary")){d.focus();b=true}!b&&c.length>0&&c.first().focus();Event.observe(window,"keydown",this.observers.keypress);this._isOpen=true;this.element.fire("ui:dialog:after:open",
{dialog:this});return this}},close:function(b){b=!!b;if(!this.element.fire("ui:dialog:before:close",{dialog:this}).stopped){this.overlay&&this.overlay.destroy();this.element.hide();this._isOpen=false;Event.stopObserving(window,"keydown",this.observers.keypress);b={dialog:this,success:b};var c=this.content.down("form");c&&Object.extend(b,{form:c.serialize({hash:true})});this.element.fire("ui:dialog:after:close",b);a.enableTextSelection(this.element,true);return this}},keypress:function(b){if(!a.modifierUsed(b)){var c=
this.focusables,d=this.options;if(b.keyCode===Event.KEY_ESC)d.closeOnEscape&&this.close(false);else if(b.keyCode===Event.KEY_RETURN)this.close(true);else if(b.keyCode===Event.KEY_TAB)if(this.options.modal)if(c){var f;d=b.findElement();d=c.indexOf(d);if(f=d===-1?c.first():b.shiftKey?d===0?c.last():c[d-1]:d===c.length-1?c.first():c[d+1]){b.stop();(function(){f.focus()}).defer()}}}}});Object.extend(a.Dialog,{DEFAULT_OPTIONS:{zIndex:1E3,title:"Dialog",content:null,modal:true,focus:"auto",submitForms:false,
closeOnEscape:true,draggable:true,resizable:false,buttons:[{label:"OK",primary:true,action:function(b){b.close(true)}}]}})})(S2.UI);
(function(a){a.Slider=Class.create(a.Base,{NAME:"S2.UI.Slider",initialize:function(b,c){this.element=$(b);b=this.setOptions(c);a.addClassNames(this.element,"ui-slider ui-widget ui-widget-content ui-corner-all");this.orientation=b.orientation;this.element.addClassName("ui-slider-"+this.orientation);this._computeTrackLength();c=b.value.initial;Object.isArray(c)||(c=[c]);this.values=c;this.handles=[];this.values.each(function(f,j){f=new Element("a",{href:"#"});f.store("ui.slider.handle",j);this.handles.push(f);
this.element.insert(f)},this);a.addClassNames(this.handles,"ui-slider-handle ui-state-default ui-corner-all");this.handles.invoke("writeAttribute","tabIndex","0");this.activeHandle=this.handles.first();this.handles.invoke("observe","click",Event.stop);a.addBehavior(this.handles,[a.Behavior.Hover,a.Behavior.Focus]);this.observers={focus:this.focus.bind(this),blur:this.blur.bind(this),keydown:this.keydown.bind(this),keyup:this.keyup.bind(this),mousedown:this.mousedown.bind(this),mouseup:this.mouseup.bind(this),
mousemove:this.mousemove.bind(this),rangeMouseDown:this.rangeMouseDown.bind(this),rangeMouseMove:this.rangeMouseMove.bind(this),rangeMouseUp:this.rangeMouseUp.bind(this)};c=b.value;if(c.step!==null){this._possibleValues=[];for(var d=c.min;d<c.max;d+=c.step)this._possibleValues.push(d);this._possibleValues.push(c.max);this.keyboardStep=c.step}else if(b.possibleValues){this._possibleValues=b.possibleValues.clone();this.keyboardStep=null}else this.keyboardStep=(c.max-c.min)/100;this.range=null;if(b.range&&
this.values.length===2){this.restricted=true;this.range=new Element("div",{"class":"ui-slider-range"});this.element.insert(this.range);this.range.addClassName("ui-widget-header")}this._computeTrackLength();this._computeHandleLength();this.disabled=this.dragging=this.active=false;this.addObservers();this.values.each(this.setValue,this);this.initialized=true},addObservers:function(){this.element.observe("mousedown",this.observers.mousedown);this.range&&this.range.observe("mousedown",this.observers.rangeMouseDown);
this.handles.invoke("observe","keydown",this.observers.keydown);this.handles.invoke("observe","keyup",this.observers.keyup)},_computeTrackLength:function(){var b;if(this.orientation==="vertical"){b=this.element.offsetHeight;b=b!==0?b:window.parseInt(this.element.getStyle("height"),10)}else{b=this.element.offsetWidth;b=b!==0?b:window.parseInt(this.element.getStyle("width"),10)}return this._trackLength=b},_computeHandleLength:function(){var b=this.handles.first(),c;if(b){if(this.orientation==="vertical"){c=
b.offsetHeight;b=c!==0?c:window.parseInt(b.getStyle("height"),10)}else{c=b.offsetWidth;b=c!==0?c:window.parseInt(b.getStyle("width"),10)}return this._handleLength=b}},_nextValue:function(b,c){return this.options.possibleValues?this._possibleValues[this._possibleValues.indexOf(b)+c]:b+this.keyboardStep*c},keydown:function(b){if(!this.options.disabled){var c=b.findElement(),d=c.retrieve("ui.slider.handle"),f=this.options;if(Object.isNumber(d))if([Event.KEY_HOME,Event.KEY_END,Event.KEY_UP,Event.KEY_DOWN,
Event.KEY_LEFT,Event.KEY_RIGHT].include(b.keyCode)){c.addClassName("ui-state-active");var j;c=j=this.values[d];switch(b.keyCode){case Event.KEY_HOME:j=f.value.min;break;case Event.KEY_END:j=f.value.max;break;case Event.KEY_UP:case Event.KEY_RIGHT:if(c===f.value.max)return;j=this._nextValue(c,1);break;case Event.KEY_DOWN:case Event.KEY_LEFT:if(c===f.value.min)return;j=this._nextValue(c,-1);break}this.dragging=true;this.setValue(j,d);if(!Prototype.Browser.WebKit){d=this._timer?0.1:1;this._timer=arguments.callee.bind(this).delay(d,
b)}}}},keyup:function(b){this.dragging=false;if(this._timer){window.clearTimeout(this._timer);this._timer=null}this._updateFinished();b.findElement().removeClassName("ui-state-active")},setValue:function(b,c){if(!this.activeHandle){this.activeHandle=this.handles[c||0];this._updateStyles()}c=c||this.activeHandle.retrieve("ui.slider.handle")||0;if(this.initialized&&this.restricted){if(c>0&&b<this.values[c-1])b=this.values[c-1];if(c<this.handles.length-1&&b>this.values[c+1])b=this.values[c+1]}b=this._getNearestValue(b);
this.values[c]=b;var d={};d[this.orientation==="vertical"?"top":"left"]=this._valueToPx(b)+"px";this.handles[c].setStyle(d);this._drawRange();!this.dragging&&!this.undoing&&!this.initialized&&this._updateFinished();if(this.initialized){this.element.fire("ui:slider:value:changing",{slider:this,values:this.values});this.options.onSlide(this.values,this)}return this},_getNearestValue:function(b){var c=this.options.value;if(b<c.min)b=c.min;if(b>c.max)b=c.max;if(this._possibleValues){var d;for(c=0;c<this._possibleValues.length;c++){d=
this._possibleValues[c];if(d===b)return b;if(d>b)break}b=b.nearer(this._possibleValues[c-1],d)}return b},_valueToPx:function(b){var c=this.options.value,d=(this._trackLength-this._handleLength/2)/(c.max-c.min);d*=b-c.min;if(this.orientation==="vertical")d=this._trackLength-d-this._handleLength;return Math.round(d)},mousedown:function(b){var c=this.options;if(!(!b.isLeftClick()||c.disabled)){b.stop();this._oldValues=this.values.clone();this.active=true;var d=b.findElement();c=b.pointer();if(d===this.element){b=
this.element.cumulativeOffset();this.setValue(this._pxToValue({x:Math.round(c.x-b.left+this._handleLength/4),y:Math.round(c.y-b.top+this._handleLength/4)}));handle=this.activeHandle=this.activeHandle||this.handles.first()}else{handle=b.findElement(".ui-slider-handle");if(!handle)return;this.activeHandle=handle}this._updateStyles();b=handle.cumulativeOffset();this._offsets={x:c.x-b.left,y:c.y-b.top};document.observe("mousemove",this.observers.mousemove);document.observe("mouseup",this.observers.mouseup)}},
mouseup:function(b){if(this.active&&this.dragging){this._updateFinished();b.stop()}this.active=this.dragging=false;this.activeHandle=null;this._updateStyles();document.stopObserving("mousemove",this.observers.mousemove);document.stopObserving("mouseup",this.observers.mouseup)},mousemove:function(b){if(this.active){b.stop();this.dragging=true;this._draw(b);Prototype.Browser.WebKit&&window.scrollBy(0,0)}},rangeMouseDown:function(b){b=b.pointer();var c=this.element.cumulativeOffset();b={x:Math.round(b.x-
c.left),y:Math.round(b.y-c.top)};this._rangeInitialValues=this.values.clone();this._rangePseudoValue=this._pxToValue(b);document.observe("mousemove",this.observers.rangeMouseMove);document.observe("mouseup",this.observers.rangeMouseUp)},rangeMouseMove:function(b){this.dragging=true;b.stop();var c=this.options;b=b.pointer();var d=this.element.cumulativeOffset(),f=this._pxToValue({x:Math.round(b.x-d.left),y:Math.round(b.y-d.top)})-this._rangePseudoValue;b=this._rangeInitialValues.map(function(j){return j+
f});if(b[0]<c.value.min){f=c.value.min-this._rangeInitialValues[0];b=this._rangeInitialValues.map(function(j){return j+f})}else if(b[1]>c.value.max){f=c.value.max-this._rangeInitialValues[1];b=this._rangeInitialValues.map(function(j){return j+f})}b.each(this.setValue,this)},rangeMouseUp:function(){this.dragging=false;document.stopObserving("mousemove",this.observers.rangeMouseMove);document.stopObserving("mouseup",this.observers.rangeMouseUp);this._updateFinished()},_draw:function(b){b=b.pointer();
var c=this.element.cumulativeOffset();b.x-=this._offsets.x+c.left;b.y-=this._offsets.y+c.top;this.setValue(this._pxToValue(b))},_pxToValue:function(b){var c=this.options;b=(this.orientation==="horizontal"?b.x:b.y)/(this._trackLength-this._handleLength)*(c.value.max-c.value.min)+c.value.min;if(this.orientation==="vertical")b=c.value.max-(b-c.value.min);return b},undo:function(){if(this._oldValues){this.values=this._oldValues.clone();this.undoing=true;this._oldValues.each(this.setValue,this);this.undoing=
false}},_updateFinished:function(){if(this.element.fire("ui:slider:value:changed",{slider:this,values:this.values}).stopped)this.undo();else{this.activeHandle=null;this._updateStyles();this.options.onChange(this.values,this)}},_updateStyles:function(){a.removeClassNames(this.handles,"ui-state-active");this.activeHandle&&this.activeHandle.addClassName("ui-state-active")},_drawRange:function(){if(this.range){var b=this.values.map(this._valueToPx,this);this.orientation==="vertical"?this.range.setStyle({top:b[1]+
"px",height:b[0]-b[1]+"px"}):this.range.setStyle({left:b[0]+"px",width:b[1]-b[0]+"px"})}},focus:function(b){if(!this.options.disabled){b=b.findElement();this.element.select(".ui-state-focus").invoke("removeClassName","ui-state-focus");b.addClassName("ui-state-focus")}},blur:function(b){b.findElement().removeClassName("ui-state-focus")}});Object.extend(a.Slider,{DEFAULT_OPTIONS:{range:false,disabled:false,value:{min:0,max:100,initial:0,step:null},possibleValues:null,orientation:"horizontal",onSlide:Prototype.emptyFunction,
onChange:Prototype.emptyFunction}})})(S2.UI);
(function(a){a.ProgressBar=Class.create(a.Base,{NAME:"S2.UI.ProgressBar",initialize:function(b,c){this.element=$(b);b=this.setOptions(c);a.addClassNames(this.element,"ui-progressbar ui-widget ui-widget-content ui-corner-all");this.element.writeAttribute({role:"progressbar","aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":0});this.valueElement=new Element("div",{"class":"ui-progressbar-value ui-widget-header ui-corner-left"});this.value=b.value.initial;this._refreshValue();this.element.insert(this.valueElement);
this.element.store(this.NAME,this)},destroy:function(){a.removeClassNames(this.element,"ui-progressbar ui-widget ui-widget-content ui-corner-all");a.removeAttributes(this.element,"role aria-valuemin aria-valuemax aria-valuenow");this.element.getData().unset(this.NAME)},getValue:function(){var b=this.value,c=this.options.value;if(b<c.min)b=c.min;if(b>c.max)b=c.max;return b},setValue:function(b){this._oldValue=this.getValue();this.value=b;this._refreshValue();return this},undo:function(){this.undoing=
true;this.setValue(this._oldValue);this.undoing=false;return this},_refreshValue:function(){var b=this.getValue();if(!this.undoing)if(this.element.fire("ui:progressbar:value:changed",{progressBar:this,value:b}).stopped){this.undo();return}b===this.options.value.max?this.valueElement.addClassName("ui-corner-right"):this.valueElement.removeClassName("ui-corner-right");var c="width: #{0}px".interpolate([window.parseInt(this.element.getStyle("width"),10)*b/100]);a.makeVisible(this.valueElement,b>this.options.value.min);
this.valueElement.morph(c,{duration:0.7,transition:"linear"});this.element.writeAttribute("aria-valuenow",b)}});Object.extend(a.ProgressBar,{DEFAULT_OPTIONS:{value:{min:0,max:100,initial:0}}})})(S2.UI);
(function(a){a.Menu=Class.create(a.Base,a.Mixin.Shim,{NAME:"S2.UI.Menu",initialize:function(b){this.element=$(b);if(!this.element){this.element=new Element("ul",{"class":"ui-helper-hidden"});this.close()}this.activeId=this.element.identify()+"_active";b=this.setOptions();a.addClassNames(this.element,"ui-widget ui-widget-content ui-menu ui-corner-"+b.corner);this.choices=this.element.select("li");this._highlightedIndex=-1;this.element.writeAttribute({role:"menu","aria-activedescendant":this.activeId});
this.choices.invoke("writeAttribute","role","menuitem");this.observers={mouseover:this._mouseover.bind(this),click:this._click.bind(this)};this.addObservers();this._shown=false;this.createShim()},addObservers:function(){this.element.observe("mouseover",this.observers.mouseover);this.element.observe("mousedown",this.observers.click)},removeObservers:function(){this.element.stopObserving("mouseover",this.observers.mouseover);this.element.stopObserving("mousedown",this.observers.click)},clear:function(){this.element.select("li").invoke("remove");
this.choices=[];return this},addChoice:function(b){var c;if(Object.isElement(b))if(b.tagName.toUpperCase()==="LI")c=b;else{c=new Element("li");c.insert(b)}else{c=new Element("li");c.update(b)}c.addClassName("ui-menu-item");c.writeAttribute("role","menuitem");this.element.insert(c);this.choices=this.element.select("li");return c},_mouseover:function(b){(b=b.findElement("li"))&&this.highlightChoice(b)},_click:function(b){(b=b.findElement("li"))&&this.selectChoice(b)},moveHighlight:function(b){this._highlightedIndex=
(this._highlightedIndex+b).constrain(-1,this.choices.length-1);this.highlightChoice();return this},highlightChoice:function(b){var c=this.choices;b=Object.isElement(b)?c.indexOf(b):Object.isNumber(b)?b:this._highlightedIndex;a.removeClassNames(this.choices,"ui-state-active");if(b!==-1){this.choices[b].addClassName("ui-state-active");this._highlightedIndex=b;(c=this.element.down("#"+this.activeId))&&c.writeAttribute("id","");this.choices[b].writeAttribute("id",this.activeId)}},selectChoice:function(b){if(Object.isNumber(b))b=
this.choices[b];else b||(b=this.choices[this._highlightedIndex]);this.element.fire("ui:menu:selected",{instance:this,element:b}).stopped||this.close();return this},open:function(){this.element.fire("ui:menu:opened",{instance:this});this.element.removeClassName("ui-helper-hidden");this._highlightedIndex=-1;Prototype.Browser.IE&&this.adjustShim()},close:function(){this.element.fire("ui:menu:closed",{instance:this});this.element.addClassName("ui-helper-hidden");return this},isOpen:function(){return!this.element.hasClassName("ui-helper-hidden")}});
Object.extend(a.Menu,{DEFAULT_OPTIONS:{corner:"all"}})})(S2.UI);
(function(a){a.Autocompleter=Class.create(a.Base,{NAME:"S2.UI.Autocompleter",initialize:function(b,c){this.element=$(b);b=this.setOptions(c);a.addClassNames(this.element,"ui-widget ui-autocompleter");this.input=this.element.down('input[type="text"]');if(!this.input){this.input=new Element("input",{type:"text"});this.element.insert(this.input)}this.input.insert({before:this.button});this.input.setAttribute("autocomplete","off");this.name=b.parameterName||this.input.readAttribute("name");if(b.choices)this.choices=
b.choices.clone();this.menu=new a.Menu;this.element.insert(this.menu.element);b=this.input.getLayout();this.menu.element.setStyle({left:b.get("left")+"px",top:b.get("top")+b.get("margin-box-height")+"px"});this.observers={blur:this._blur.bind(this),keyup:this._keyup.bind(this),keydown:this._keydown.bind(this),selected:this._selected.bind(this)};this.addObservers()},addObservers:function(){this.input.observe("blur",this.observers.blur);this.input.observe("keyup",this.observers.keyup);this.input.observe("keydown",
this.observers.keydown);this.menu.element.observe("ui:menu:selected",this.observers.selected)},_schedule:function(){this._unschedule();this._timeout=this._change.bind(this).delay(this.options.frequency)},_unschedule:function(){this._timeout&&window.clearTimeout(this._timeout)},_keyup:function(){var b=this.input.getValue();if(b){if(b.blank()||b.length<this.options.minCharacters){this.menu.close();this._unschedule();return}b!==this._value&&this._schedule()}else{this.menu.close();this._unschedule()}this._value=
b},_keydown:function(b){if(!a.modifierUsed(b))if(this.menu.isOpen())switch(b.keyCode){case Event.KEY_UP:this.menu.moveHighlight(-1);b.stop();break;case Event.KEY_DOWN:this.menu.moveHighlight(1);b.stop();break;case Event.KEY_TAB:this.menu.selectChoice();break;case Event.KEY_RETURN:this.menu.selectChoice();this.input.blur();b.stop();break;case Event.KEY_ESC:this.input.setValue("");this.input.blur();break}},_getInput:function(){return this.input.getValue()},_setInput:function(b){this.input.setValue(b)},
_change:function(){this.findChoices()},findChoices:function(){var b=this._getInput();this.setChoices((this.choices||[]).inject([],function(c,d){d.toLowerCase().include(b.toLowerCase())&&c.push(d);return c}))},setChoices:function(b){this.results=b;this._updateMenu(b)},_updateMenu:function(b){var c=this.options;this.menu.clear();for(var d=new RegExp(RegExp.escape(this._value),"i"),f=0,j,p,u;j=b[f];f++){u=c.highlightSubstring?j.replace(d,"<b>$&</b>"):u;p=(new Element("li")).update(u);p.store("ui.autocompleter.value",
j);this.menu.addChoice(p)}b.length===0?this.menu.close():this.menu.open()},_moveMenuChoice:function(b){this.list.down("li");this._selectedIndex=(this._selectedIndex+b).constrain(-1,this.results.length-1);this._highlightMenuChoice()},_highlightMenuChoice:function(b){var c=this.list.select("li");b=Object.isElement(b)?c.indexOf(b):Object.isNumber(b)?b:this._selectedIndex;a.removeClassNames(c,"ui-state-active");if(!(b===-1||b===null)){c[b].addClassName("ui-state-active");this._selectedIndex=b}},_selected:function(b){this._setInput(b.memo.element.retrieve("ui.autocompleter.value"));
this.menu.close()},_blur:function(){this._unschedule();this.menu.close()}});Object.extend(a.Autocompleter,{DEFAULT_OPTIONS:{tokens:[],frequency:0.4,minCharacters:1,highlightSubstring:true,onShow:Prototype.K,onHide:Prototype.K}})})(S2.UI);
document.observe("dom:loaded",function(){function a(A){A._rotation=A._rotation||0;A._scale=A._scale||1;A._panX=A._panX||0;A._panY=A._panY||0;A._pans=[[0,0],[0,0],[0,0]];A._panidx=1}function b(A,h,s,x,w){A._rotation=h;A._scale=s;A._panX=x;A._panY=w}function c(A,h){A.fire("manipulate:update",Object.extend(h,{id:u}))}function d(){function A(g){for(var l=g.length;l--;)w[g[l].identifier]=g[l];g=[];for(k in w)g.push(k);g=g.sort();if((h=(B=g.length>0?g[0]:null)?w[B].target:null)&&h.nodeType==3)h=h.parentNode;
r=g.length>1?g[1]:null;if(e==0&&B&&r){n=(w[B].pageX-w[r].pageX).abs();q=(w[B].pageY-w[r].pageY).abs();h&&a(h);m=Math.sqrt(n*n+q*q);v=Math.atan2(w[r].pageY-w[B].pageY,w[r].pageX-w[B].pageX);e=1}else if(e==1&&!(B&&r)){h&&b(h,s,x);e=0}}var h,s,x,w={},B=null,r=null,e=0,i,o,n,q,m,v;p.observe("touchstart",function(g){var l=B;A(g.changedTouches);if(l==null&&B){l=h.viewportOffset();i=l.left+(w[B].pageX-l.left);o=l.top+(w[B].pageY-l.top)}g.stop()});p.observe("touchmove",function(g){A(g.changedTouches);if(B&&
!r){c(h,{panX:(h._panX||0)+w[B].pageX-i,panY:(h._panY||0)+w[B].pageY-o,scale:h._scale,rotation:h._rotation});g.stop()}else if(B&&r){var l=w[r].pageX-w[B].pageX,z=w[r].pageY-w[B].pageY,F=(h._panX||0)+w[r].pageX-l/2-i,G=(h._panY||0)+w[r].pageY-z/2-o,H=Math.sqrt(l*l+z*z);x=h._scale*H/m;s=h._rotation+Math.atan2(z,l)-v;c(h,{rotation:s,scale:x,panX:F,panY:G});g.stop()}});["touchcancel","touchend"].each(function(g){p.observe(g,function(l){for(var z=l.changedTouches.length;z--;)delete w[l.changedTouches[z].identifier];
A([]);h&&b(h,s,x)})})}function f(){var A,h,s,x,w,B=false;p.observe("manipulatestart",function(r){r.stop();A=r.element();a(A);B=true});p.observe("manipulatemove",function(r){A=r.element();h=A._rotation+r.rotation;s=A._scale*r.scale;x=A._panX+r.panX;w=A._panY+r.panY;c(A,{rotation:h,scale:s,panX:x,panY:w,clientX:r.clientX,clientY:r.clientY});r.stop()},false);p.observe("manipulateend",function(r){(A=r.element())&&b(A,h,s,x,w);B=false;var e=Math.sqrt(r.panSpeedX*r.panSpeedX+r.panSpeedY*r.panSpeedY);e>
25&&A.fire("manipulate:flick",{speed:e,direction:Math.atan2(r.panSpeedY,r.panSpeedX)})});p.observe("mousemove",function(r){r.stop()});p.observe("mousedown",function(r){r.stop()});p.observe("mouseup",function(r){r.stop()})}function j(){function A(g){var l=B.viewportOffset(),z=g.pageX-l.left-s;g=g.pageY-l.top-x;v=Math.sqrt(z*z+g*g);m=B._scale*v/e;q=B._rotation+Math.atan2(g,z)-i;return{rotation:q,scale:m,panX:B._panX,panY:B._panY}}function h(g){return{rotation:B._rotation,scale:B._scale,panX:B._panX+
g.pageX-o,panY:B._panY+g.pageY-n}}var s,x,w=false,B,r,e,i,o,n,q,m,v;p.observe("mousedown",function(g){r=g.shiftKey?"scale":"pan";if((B=g.element())&&B.fire){u++;w=true;a(B);var l=B.viewportOffset();s=B.offsetWidth/2;x=B.offsetHeight/2;var z=g.pageX-l.left-s,F=g.pageY-l.top-x;e=Math.sqrt(z*z+F*F);i=Math.atan2(F,z);o=l.left+(g.pageX-l.left);n=l.top+(g.pageY-l.top);g.stop()}});p.observe("mousemove",function(g){if(w)c(B,r=="scale"?A(g):h(g))});p.observe("mouseup",function(g){if(w){w=false;if(r=="scale"){g=
A(g);c(B,g);B._rotation=g.rotation;B._scale=g.scale}else{c(B,h(g));B._panX=B._panX+g.pageX-o;B._panY=B._panY+g.pageY-n}}});p.observe("dragstart",function(g){g.stop()})}if(S2.enableMultitouchSupport){var p=$(document.body),u=0;if(navigator.userAgent.match(/SLBrowser/))return f();if(navigator.userAgent.match(/QtLauncher/))return f();if(navigator.userAgent.match(/Starlight/))return f();try{document.createEvent("ManipulateEvent");return f()}catch(y){}try{document.createEvent("TouchEvent");return d()}catch(D){}return j()}});
Element.__scrollTo=Element.scrollTo;Element.addMethods({scrollTo:function(a,b,c){if(arguments.length==1)return Element.__scrollTo(a);(new S2.FX.Scroll(a,Object.extend(c||{},{to:b}))).play();return a}});
Element.addMethods({effect:function(a,b,c){if(Object.isFunction(b))b=new b(a,c);else if(Object.isString(b))b=new (S2.FX[b.capitalize()])(a,c);b.play(a,c);return a},morph:function(a,b,c){c=S2.FX.parseOptions(c);if(!c.queue){c.queue=a.retrieve("S2.FX.Queue");if(!c.queue)a.store("S2.FX.Queue",c.queue=new S2.FX.Queue)}if(!c.position)c.position="end";return a.effect("morph",Object.extend(c,{style:b}))}.optionize(),appear:function(a,b){return a.effect("morph",Object.extend({before:function(){a.show().setStyle({opacity:0})},
style:"opacity:1"},b))},fade:function(a,b){return a.effect("morph",Object.extend({style:"opacity:0",after:a.hide.bind(a)},b))},cloneWithoutIDs:function(a){a=$(a);a=a.cloneNode(true);a.id="";$(a).select("*[id]").each(function(b){b.id=""});return a}});
(function(){Element.addMethods({transform:window.CSSMatrix?function(a,b){a.style.transform="scale("+(b.scale||1)+") rotate("+(b.rotation||0)+"rad)";return a}:window.WebKitCSSMatrix?function(a,b){a.style.webkitTransform="scale("+(b.scale||1)+") rotate("+(b.rotation||0)+"rad)";return a}:Prototype.Browser.Gecko?function(a,b){a.style.MozTransform="scale("+(b.scale||1)+") rotate("+(b.rotation||0)+"rad)";return a}:Prototype.Browser.IE?function(a,b){if(!a._oDims)a._oDims=[a.offsetWidth,a.offsetHeight];var c=
Math.cos(b.rotation||0)*1;b=Math.sin(b.rotation||0)*1;a.style.filter="progid:DXImageTransform.Microsoft.Matrix(sizingMethod='auto expand',M11="+c+",M12="+-b+",M21="+b+",M22="+c+")";a.style.marginLeft=(a._oDims[0]-a.offsetWidth)/2+"px";a.style.marginTop=(a._oDims[1]-a.offsetHeight)/2+"px";return a}:function(a){return a}})})();
S2.viewportOverlay=function(){var a=document.viewport.getDimensions(),b=document.viewport.getScrollOffsets();return(new Element("div")).setStyle({position:"absolute",left:b.left+"px",top:b.top+"px",width:a.width+"px",height:a.height+"px"})};S2.FX.Helpers={fitIntoRectangle:function(a,b,c,d){return a/b<c/d?[(c-a*(d/b))/2,0,a*(d/b),d]:[0,(d-b*(c/a))/2,c,b*(c/a)]}};
S2.FX.Operators.Zoom=Class.create(S2.FX.Operators.Style,{initialize:function($super,b,c,d){var f=document.viewport.getDimensions(),j=document.viewport.getScrollOffsets(),p=c.getDimensions();f=S2.FX.Helpers.fitIntoRectangle(p.width,p.height,f.width-(d.borderWidth||0)*2,f.height-(d.borderWidth||0)*2);Object.extend(d,{style:{left:f[0]+(d.borderWidth||0)+j.left+"px",top:f[1]+(d.borderWidth||0)+j.top+"px",width:f[2]+"px",height:f[3]+"px"}});$super(b,c,d)}});
S2.FX.Zoom=Class.create(S2.FX.Element,{setup:function(){this.clone=this.element.cloneWithoutIDs();this.element.insert({before:this.clone});this.clone.absolutize().setStyle({zIndex:9999});this.overlay=S2.viewportOverlay();this.options.overlayClassName?this.overlay.addClassName(this.options.overlayClassName):this.overlay.setStyle({backgroundColor:"#000",opacity:"0.9"});$$("body")[0].insert(this.overlay);this.animate("zoom",this.clone,{borderWidth:this.options.borderWidth,propertyTransitions:this.options.propertyTransitions||
{}})},teardown:function(){this.clone.observe("click",function(){this.overlay.remove();this.clone.morph("opacity:0",{duration:0.2,after:function(){this.clone.remove()}.bind(this)})}.bind(this))}});
S2.UI.Behavior.WebkitTransformDrag=Class.create(S2.UI.Behavior,{initialize:function($super,b,c){this.__onmousemove=this._onmousemove.bind(this);$super(b,c);this.element.addClassName("ui-draggable");this.element.setStyle({WebkitTransform:"translate(0px,0px)"})},destroy:function($super){this.element.removeClassName("ui-draggable");$super()},"handle/onmousedown":function(a){if(a.element().hasClassName("ui-draggable")){var b=this.element,c=/.*translate\(\s*(-*[0-9]*)px\s*,*\s*(-*[0-9]*)px\s*\)/;this._startPointer=
a.pointer();this._startPosition={left:window.parseInt(b.getStyle("WebkitTransform").match(c)[1],10),top:window.parseInt(b.getStyle("WebkitTransform").match(c)[2],10)};document.observe("mousemove",this.__onmousemove)}},"handle/onmouseup":function(){this._startPosition=this._startPointer=null;document.stopObserving("mousemove",this.__onmousemove)},_onmousemove:function(a){a=a.pointer();if(this._startPointer){a={x:a.x-this._startPointer.x,y:a.y-this._startPointer.y};this.element.setStyle({WebkitTransform:"translate("+
(this._startPosition.left+a.x)+"px, "+(this._startPosition.top+a.y)+"px)"})}}});
